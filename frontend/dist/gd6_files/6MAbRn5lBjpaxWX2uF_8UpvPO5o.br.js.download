(function(){var t={L_microsoftcopyright_text:"© {year} Microsoft Corporation",L_DistanceUnitKm_Text:"km",L_DistanceUnitMeters_Text:"m",L_DistanceUnitMilesShortText_Text:"mi",L_DistanceUnitMilesLongText_Text:"miles",L_DistanceUnitFeetShort_Text:"ft",L_Distance_Format:"{0} {1}",L_LatLon_Format:"{0}, {1}",L_Duration:"{0} hr {1} min",L_Duration_NoMin:"{0} hr",L_Duration_Min:"{0} min",L_DistanceUnitFeetSquareShort_Text:"sq ft",L_DistanceUnitKmSquare_Text:"sq km",L_DistanceUnitMetersSquare_Text:"sq m",L_DistanceUnitMilesSquareShortText_Text:"sq mi",L_AreaFieldString:"Area",L_FormatFieldString:"{0}: {1}",L_IncorrectValue_text:"N/A",L_LengthFieldString:"Length",L_FocusDivDefaultLabel:"Bing Maps – Interact to see more",L_Compass_Left:"Rotate Left",L_Compass_Reset:"Reset to Default Rotation",L_Compass_Right:"Rotate Right",L_Pitch_Decrease:"Decrease Pitch",L_Pitch_Increase:"Increase Pitch",L_Pitch_Reset:"Reset to Default Pitch",L_Style_Select:"Select Style",L_ZoomIn:"Zoom In",L_ZoomOut:"Zoom Out",L_Style_Birdseye:"Bird's eye",L_Style_3D:"3D",L_Style_DarkCanvas:"Dark Canvas",L_Style_DarkRoad:"Dark Road",L_Style_Grayscale:"Greyscale",L_Style_Hybrid:"Hybrid",L_Style_LightCanvas:"Light Canvas",L_Style_Road:"Road",L_Style_Streetside:"Streetside",L_Style_OS:"Ordnance Survey",L_LocateMe_Text:"Locate me",L_LocateMe_Error_Text_Approximate_Location:"We could not retrieve your exact location, but think you may be in this area.",L_LocateMe_Error_Text_Setting:"We could not retrieve your exact location. This is your default location setting.",L_LocateMe_ChangeSettings_Text:"Manually change my location setting",L_GeochainTitle_Text:"Expand/Collapse Geochain",L_Landmark3D_Flyout_Text_Format:"View {name} in 3D",L_LandmarkDealsMore_Text:"+ {0} more",L_3DLandmark_Copy_Button_Text:"Copy",L_3DLandmark_Copy_Link_Success:"Successfully copied.",L_3DLandmark_Feedback_Button_Tooltip:"Feedback",L_3DLandmark_Share_Button_Tooltip:"Share",L_3DLandmark_Feedback_Button_Aria_Label:"Give feedback for 3D landmarks",L_3DLandmark_Share_Button_Aria_Label:"Share 3D landmark",L_3D_Copy_Url_Text_Box_Aria_Label:"Copy URL",L_3DLandmark_Share_Panel_Close:"Close",L_3DLandmark_Flyover_Render:"3D Flyover",L_3D_Canvas_Alt_Text:"Interactive 3D Map",L_3D_Search_Clear_Button_Aria_Label:"Clear search text",L_3D_Search_Clear_Button_Title:"Clear",L_3D_Search_Placeholder:"Find a location",L_3D_Search_Aria_Label:"Search for a location ",L_3D_WeatherPicker_Button_Text:"Weather",L_3D_WeatherPicker_Button_Aria_Label:"Show weather effects",L_3D_WeatherPicker_Clouds_Button_Text:"Clouds",L_3D_WeatherPicker_Clouds_Aria_Label:"Show clouds",L_3D_WeatherPicker_Rain_Button_Text:"Rain",L_3D_WeatherPicker_Rain_Button_Aria_label:"Show rain",L_3D_WeatherPicker_Snow_Button_Text:"Snow",L_3D_WeatherPicker_Snow_Button_Aria_Label:"Show snow",L_3D_WeatherPicker_Clear_Sky_Button_Text:"Clear Sky",L_3D_WeatherPicker_Clear_Sky_Button_Aria_Label:"Show a clear sky",L_3D_WeatherPicker_Collapse_Button_Title:"Collapse",L_3D_WeatherPicker_Collapse_Button_Aria_Label:"Collapse weather effects",L_3D_TimeSlider_Title:"Time of Day",L_3D_TimeSlider_Aria_Label:"Adjust time of day",L_3D_TimeSlider_Collapse_Button_Title:"Collapse",L_3D_TimeSlider_Collapse_Button_Aria_label:"Collapse time of day slider",L_3D_Hide_Button_Title:"Hide",L_3D_Show_Button_Title:"Show",L_3D_HideShow_Button_Aria_Label:"Toggle visibility of controls and labels",L_3D_Flyover_Exit_Button_Title:"Exit flyover",L_3D_Flyover_Play_Button_Title:"Play flyover",L_3D_Flyover_Pause_Button_Title:"Pause flyover",L_3D_Speed_Slider_Title:"Adjust playback speed",L_3D_Playback_Slider_Aria_Label:"Progress bar for flyover",L_3D_Immersive_View_Exit_Button_Title:"Exit view",L_3D_Outdoor_Button_Text:"Outdoor",L_3D_Outdoor_Button_Title:"Show outdoor features on the map",L_3D_Card_Reset_View_Aria_Label:"Set the map's view to this place",L_3D_Card_Close_Button_Title:"Close",L_3D_Card_Collapse_Button_Title:"Collapse",L_3D_Card_Expand_Button_Title:"Expand",L_3D_Card_See_More_Text:"See more",L_3D_Card_Phone_Aria_Label:"Phone {0}",L_3D_Card_Review_Count_Text:"{0} reviews",L_3D_Card_Data_From_Text:"Data from:",L_3D_NearbySights_Aria_Label:"Sights and places nearby the current view.",L_3D_Loading_Text:"Loading",L_WebGLError_Disabled:'WebGL has been disabled by your organisation. Please contact your IT team for support, and ensure your browser is not started with the command line parameter "-disable-webgl" when using Chrome.',L_WebGLError_Generic:"Failed to create map due to a WebGL error. Please try closing and reopening all browser windows. If the issue persists, please check WebGL support by following the link: {0}",L_Details:"Details",L_DetailsTooltip:"Toggle additional details on the map such as landmarks and business labels",L_Style_Satellite:"Satellite",L_No_BE_Images:"No Bird's eye images in this region",L_No_SS_Images:"No Streetside images in this region",L_MapOf:"Map of {0}",L_Incidents:"Incidents",L_TrafficStyleMenu:"Traffic",L_TrafficBoxId:"TrafficBox",L_IncidentsBoxId:"IncidentsBox"},n=window.$MicrosoftMaps8,i;n.ResourceManager?n.ResourceManager.init("MapCore",t):(i=n.ResourcesObject=n.ResourcesObject||{},i.MapCore=t)})(),function(){var dt,f,ht,gt,it,a,lt,ni,at,ai,k,et,w,vi,pt;try{var r=Microsoft.Maps,e=r.Internal,s=e.__assign,l=e.__extends,st=e.__spreadArray,n=r.globalConfig,u=e.coreConfig,o=n.features,cr=o.advertising,lr=o.autosuggest,ar=o.calendar,vr=o.collections,yr=o.directions,pr=o.feedback,wr=o.flyover,br=o.landmarks3D,nt=o.map3D,kr=o.richMapsInfobox,dr=o.labels,gr=o.layerManager,nu=o.localGuide,tu=o.localSearch,ut=o.mapDelay,iu=o.optIn,ru=o.print,uu=o.sharing,tt=o.streetside,fu=o.birdseye,eu=o.taskBar,ou=o.taskFramework,su=o.trafficControl,hu=o.traffic,cu=o.trafficExperiences,lu=o.transit,au=o.travel,vu=o.xsr,ki=e.dependencyResolver,bt=e.ExternalPromise,kt=e.LocalStorageCache,et=e.MapMath,y=e.TimeoutWrapper,yu=e.VectorMath,t=r.ResourcesObject.MapCore,h=r.DeviceInfo;e.originalXMLHttpRequest=typeof Sarissa!="undefined"&&Sarissa.originalXMLHttpRequest?Sarissa.originalXMLHttpRequest:window.XMLHttpRequest;dt=function(e){function o(t,r){var f=this,y=o._getDefaultServiceOptions(r||{}),c,v;r=r||{view:"Auto"};r.styleSet||(r.style=i.getAzureMapStyleFromMapType(i.getMapTypeFromMapStyle(r.style)));r.showFeedbackLink=!1;r.showBuildingModels=!0;r.minZoom=r.minZoom||u.basemapDataMinZoom;r.maxZoom=r.maxZoom||i.convertZoom(u.basemapDataMaxZoom,1);r.wheelZoomRate=r.wheelZoomRate||o.defaultWheelZoomRate;n.isMobile&&(r.touchRotate=!1);typeof r.dragRotateInteraction!="boolean"&&(r.dragRotateInteraction=!1);n.isMapsVertical&&(r.showLogo=!1);c=s(s({},r),y);try{f=e.call(this,t,c)||this}catch(l){o._processMapException(l,t);throw l;}return f._disposables=[],f._mbMap=f._getMap(),f._logControlError(),typeof MapLoadingDetector!="undefined"&&MapLoadingDetector.addMap&&MapLoadingDetector.addMap(f),f.id=f._mbMap._getMapId(),f._mbMap._maxTileCacheZoomLevels=u.maxTileCacheZoomLevels,f.getMapContainer().classList.add("MicrosoftMap"),f.mapReady=new Promise(function(n){f._isReady()?n(f):f.events.addOnce("ready",function(){n(f)})}),f.mapLoaded=new bt,f.mapLoaded.then(function(){f._isMapLoaded=!0;var n=r.fadeDuration;(typeof n!="number"||isNaN(n))&&(n=h.deviceClassification===0?u.fadeDuration||0:0);f._mbMap._fadeDuration=n}),f._disposables.push(f.mapClicked=new k),v=f.controls.getControls(),f.controls.remove(v),f.controls.add(new gt,{position:atlas.ControlPosition.NonFixed}),f.controls.add([new ui({units:"imperial"}),new ui({units:"metric"})],{position:atlas.ControlPosition.BottomRight}),ot.localize(f.controls),f.clientProperties={},a.addControlInstrumentation(f),f._attachDebuggingOptions(),f._disposables.push(new rr(f)),o._firstInstanceId!==-1||n.dynamicProperties.likelyBot||(o._firstInstanceId=f.id,f._disposables.push(new ft(f))),f.mapFirstIdle=new Promise(function(n){f.events.addOnce("idle",function(){n()})}),f}return l(o,e),o.prototype.dispose=function(){this._isDisposed||(o._firstInstanceId===this.id&&(o._firstInstanceId=-1),e.prototype._getMap.call(this).remove(),i._clearDisposables(this._disposables),i._nullifyClass(this),this._isDisposed=!0)},o.prototype.createDataSource=function(n){return this.mapReady.then(function(t){var i=t.sources.getById(n);return i||(i=new atlas.source.DataSource(n),t.sources.add(i)),i})},o.prototype.setLayoutProperty=function(n,t,i){var u=this._mbMap,r;u.getLayer(n)&&(r=u.getLayoutProperty(n,t),t!=="visibility"||r||(r="visible"),r!==i&&u.setLayoutProperty(n,t,i))},o.prototype.repaint=function(){this._mbMap.triggerRepaint()},o.prototype.setCamera=function(n,t){var l=h.renderingMode===2,r,f,o,c,v;n&&!n.type&&this._isMapLoaded&&!l&&h.deviceClassification===0&&(n=s(s({},n),i.computeAnimation(this.getCamera(),n)));n.zoom&&(n.zoom=l?Math.round(n.zoom):Math.round(n.zoom*100)/100);l&&(n.pitch=n.bearing=0);r=this.getCamera();u.logImprov&&t&&a.setUserAction(!0);e.prototype.setCamera.call(this,n);n&&t&&(f=void 0,n.zoom!==undefined&&n.zoom!==r.zoom&&(f=n.zoom>r.zoom?"ZoomIn":"ZoomOut",i.logMsnCfv(f)),l||(o=n.bearing,c=n.pitch,o!==undefined&&o!==r.bearing&&(o===0?f="RotateReset":(v=o-r.bearing,f=v>0&&v<180||v<-180?"RotateLeft":"RotateRight")),c!==undefined&&c!==r.pitch&&(f=c===0?"ResetPitch":c>r.pitch?"IncreasePitch":"DecreasePitch")),a.log(f,"NC",r,this.getStyle().style))},o.prototype.getMapSize=function(){var n=window.devicePixelRatio,t=this.getCanvas();return{width:t.width/n,height:t.height/n}},o.prototype.getIsMapLoaded=function(){return this._isMapLoaded},o.prototype._attachDebuggingOptions=function(){var t=this;this.mapReady.then(function(){t._mbMap.showCollisionBoxes=u.showCollisionBoxes;t._mbMap.showPadding=u.showPadding;t._mbMap.showTileBoundaries=!!u.tileBoundary;t._mbMap.collisionSymbolSpacing=u.collisionSymbolSpacing;n.testHooksEnabled&&(t._mbMap.ignorePreviousAnchors=!0)})},o.prototype._logControlError=function(){var i=r.logger,t;this._disposables.push(f.add(this,"error",function(n){if(n.type==="error"&&n.error&&n.error instanceof Error){var t=(n.error.message||"").toLowerCase();t.indexOf("failed to fetch")===-1&&t.indexOf("the user aborted a request")===-1&&t.indexOf("ajaxerror")===-1&&(n.error.message="maplibre-"+n.error.message,i.logCriticalError(n.error,null,!0,!0))}}));t=function(t){i.logObject({feature:"MC",action:"",T:"CI.MapsAction",data:{text:t}},n.dynamicProperties.mapsIG)};this._mbMap.on("webglcontextlost",function(){return t("Maplibre webgl context lost")});this._mbMap.on("webglcontextrestored",function(){return t("Maplibre webgl context restored")})},o._getDefaultServiceOptions=function(t){var r={},f;return t.styleSet||o._updateMapStyleDefinition(),r.styleSet=t.styleSet||u.mapStyleDefinition,(n.isMapsVertical||n.isMapsAnswer)&&(r.refreshExpiredTiles=typeof t.refreshExpiredTiles=="boolean"?t.refreshExpiredTiles:!1),r.validateStyle=!!u.forceMLStyleVal,r.fadeDuration=0,f=t.localIdeographFontFamily||u.localIdeographFontFamily,f&&(r.localIdeographFontFamily=f.toLowerCase()==="false"?!1:f),r.enableAccessibilityLocationFallback=!1,r.maxParallelImageRequests=t.maxParallelImageRequests||u.maxParallelImageRequests,ht.registerRasterProtocol(),r.transformRequest=function(r,f){var s,e={url:r},c,l,a,o;return f==="Style"?(e.url=r.replace("{renderingMode}",h.renderingMode+"").replace("{contrastMode}",h.contrastMode+""),t.styleSet||((s=u.mapStyleDefinition)===null||s===void 0?void 0:s.addCredentials)&&(e.credentials="include")):f==="SpriteImage"?e.url=e.url.replace("https://","raster://"):f==="Tile"?(n.isOnCorpnet&&r.includes("mvt?")&&(c=i._getUrlParam(window.location,"st"),c&&(r+="&st="+c)),e.url=r.replace("{credentials}",n.dynamicProperties.sessionKey)):f==="SpriteJSON"&&u.txtfit&&(e.url+="&txtfit=tf"),n.mockEnabled&&typeof FunctionalTestHooks!="undefined"&&(e.url=FunctionalTestHooks.TransformRequest(e.url,f)),l=t.transformRequest,l&&(a=l(e.url,f)),o=a||e,n.testHooksEnabled&&console.log("TransformRequest- resourceType: ".concat(f,", url - ").concat(o?o.url:"request url empty",", ")),o},r},o._updateMapStyleDefinition=function(){var n=u.mapStyleDefinition,i=h.contrastMode,t;ot.localizeStyleDisplayName(n);i!=="none"&&(n.styles=n.styles.map(function(n){var u,t=(u=n.contrast)===null||u===void 0?void 0:u.filter(function(n){return n.mode===i}),r;return(t===null||t===void 0?void 0:t.length)>0&&(r=t[0],n.mapStyleId=r.mapStyleId,n.theme=r.theme,n.thumbnail=r.thumbnail),n}));t=n.styles.find(function(n){return n.style});t&&(t.url=null)},o._processMapException=function(u,f){var o=typeof f=="string"?document.getElementById(f):f,a=u.message,e,h,b,y,p,l,w,k;if(a.indexOf("Failed to initialize WebGL")>-1){if(a.indexOf("Canvas has an existing context of a different type")>-1){e=null;try{e=JSON.parse(u.message)}catch(d){}if(e){(o===null||o===void 0?void 0:o.id)&&(h=document.querySelector("#".concat(o.id," .maplibregl-canvas")),h&&(b=["webgpu","webgl2","webgl","2d"],e.contextType=b.find(function(n){return h.getContext(n)})||"unknown",e.getContextFn=Function.prototype.toString.call(h.getContext).substring(0,200)));e.createElmFn=Function.prototype.toString.call(document.createElement).substring(0,200);var c={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,antialias:!1},v=document.createElement("canvas"),s=null;v.addEventListener("webglcontextcreationerror",function(n){s={};n&&(s.statusMessage=n.statusMessage,s.type=n.type)},{once:!0});e.ctxWebgl_1or2=(v.getContext("webgl2",c)||v.getContext("webgl",c)||"null").toString();s&&(e.ctxWebgl_1or2_errmsg=s);e.ctxWebgl2=(document.createElement("canvas").getContext("webgl2",c)||"null").toString();e.ctxWebgl=(document.createElement("canvas").getContext("webgl",c)||"null").toString();u.message=JSON.stringify(e)}}n.isMapsVertical?(y=r.logger,y.logCriticalError(u,null,!0,!0),y.flush(),p=new URL(location.href),p.searchParams.set("forcev8","1"),location.replace(p.toString())):i._isSmallMapShownOnSerp()||(l="",a.indexOf("disabled by")>-1?l=t.L_WebGLError_Disabled:(w="https://get.webgl.org",k="<a href='".concat(w,"' target='blank'>").concat(w,"<\/a>"),l=t.L_WebGLError_Generic.replace("{0}",k)),o.innerHTML="<div class='webglFailedMsg'>".concat(l,"<\/div>"))}},o.defaultWheelZoomRate=3/450,o._firstInstanceId=-1,o}(atlas.Map),function(n){function t(n,t,i,r){n.remove(t,i,r)}function i(n,i,r,u){var f=n.events;return f.add(i,r,u),{dispose:function(){t(f,i,r,u)}}}function r(n,i,r,u){var f=n.events;return f.addOnce(i,r,u),{dispose:function(){t(f,i,r,u)}}}function f(n,t,f){for(var o,s,l,a,h=[],e=0,c=["dragend","wheel","boxzoomend","dblclick","touchend"];e<c.length;e++)o=c[e],h.push(f?r(n,o,t):i(n,o,t));return s=n.getMapContainer(),l=function(n){var i=n.target,r;i&&i.tagName&&(r=i.tagName.toLowerCase(),(r==="button"||r==="div")&&t&&t(n))},s.addEventListener("click",l,{once:f}),a=function(n){u.indexOf(n.keyCode)>=0&&t(n)},s.addEventListener("keyup",a,{once:f}),h}n.add=i;n.addOnce=r;var u=[40,38,37,39,107,109,187,189];n.handleUserActions=f}(f||(f={})),function(t){function u(){i||(r("raster","https"),n.mockEnabled&&typeof FunctionalTestHooks!="undefined"&&r("rasterhttp","http"),i=!0)}function r(n,t){var i=function(i,r){return new Promise(function(u,f){var o=i.url.replace("".concat(n,"://"),"".concat(t,"://")),e=new Image,s="abort",h=function(n){e.onerror=e.onload=null;e.src="";var t={url:o,reason:n.type};f(t)},c=function(){r&&r.signal.removeEventListener(s,h)};r&&r.signal.addEventListener(s,h,{once:!0});e.crossOrigin=i.credentials==="include"?"use-credentials":"anonymous";e.fetchPriority="high";e.onload=function(){c();u({data:e})};e.onerror=function(){c();e.onerror=e.onload=null;f(new Error("Failed to fetch image. Url: ".concat(o)))};e.src=o})};maplibregl.addProtocol(n,i)}var i=!1;t.registerRasterProtocol=u}(ht||(ht={}));var ct=atlas.math,p=atlas.data,di=atlas.layer,b=atlas.Pixel,c=atlas.data.BoundingBox,gi=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return l(t,n),t.prototype.onAdd=function(n){var e=this,u,t,r;return this._map=n,this._container=this.buildContainer(this._map,atlas.ControlStyle.auto),u=document.createElement("div"),u.classList.add("bm_LogoContainer"),t=document.createElement("a"),t.href=this._updateHref(),t.title="Microsoft Bing",t.setAttribute("aria-label","Microsoft Bing"),r=document.createElement("div"),r.id="bingLogo",r.classList.add("bingLogoLight"),t.append(r),u.append(t),this._container.appendChild(u),f.add(this._map,"stylechanged",function(){i.getMapStyle(e._map).theme==="dark"?r.classList.replace("bingLogoLight","bingLogoDark"):r.classList.replace("bingLogoDark","bingLogoLight");t.href=e._updateHref()}),this._container},t.prototype.dispose=function(){this._container=this._map=null;n.prototype.onRemove.call(this)},t.prototype._updateHref=function(){var n=this._map.getCamera(),t=n.center[1],i=n.center[0],r=n.zoom,u=this._map.getStyle().style.charAt(0),f=location&&location.protocol?location.protocol:"https:";return f+"//www.bing.com/maps?cp=".concat(t,"~").concat(i,"&lvl=").concat(r,"&style=").concat(u,"&FORM=BMLOGO")},t}(atlas.control.ControlBase),ot;(function(n){function o(n){n.styles.forEach(function(n){var t;n.displayName=(t=f.get(n.name))!==null&&t!==void 0?t:n.name})}function s(n,t){n.setAttribute("aria-label",t);n.setAttribute("alt",t);var i=n.nextElementSibling;i&&i.className.toLowerCase().startsWith("tooltiptext")&&(i.innerHTML=t)}function h(n){if(!i){i=!0;var t=n.add.bind(n);n.add=function(n,i){var h,v,w,c,y,l,a,p,f,o;for(t(n,i),Array.isArray(n)||(n=[n]),h=0,v=n;h<v.length;h++)for(w=v[h],c=0,y=e;c<y.length;c++)if(l=y[c],l.type&&w instanceof l.type){for(a=0,p=l.overrides;a<p.length;a++)f=p[a],f.class&&(o=document.getElementsByClassName("".concat(r," ").concat(f.class)),o.length===0&&(o=document.getElementsByClassName("".concat(u," ").concat(f.class))),o.length>0&&s(o[0],f.str));break}}}}var r="azure-maps-control-button",u="azure-maps-control-list-button",i=!1,f=new Map([["road",t.L_Style_Road],["roaddark",t.L_Style_DarkRoad],["hybrid",t.L_Style_Hybrid],["aerial",t.L_Style_Satellite],["birdseye",t.L_Style_Birdseye],["streetside",t.L_Style_Streetside],["grayscale",t.L_Style_Grayscale],["canvas_light",t.L_Style_LightCanvas],["canvas_dark",t.L_Style_DarkCanvas],["ordnancesurvey",t.L_Style_OS],["3d",t.L_Style_3D],]),e=[{type:atlas.control.ZoomControl,overrides:[{"class":"zoom-in",str:t.L_ZoomIn},{"class":"zoom-out",str:t.L_ZoomOut}]},{type:atlas.control.PitchControl,overrides:[{"class":"pitch",str:t.L_Pitch_Reset},{"class":"pitch-down",str:t.L_Pitch_Decrease},{"class":"pitch-up",str:t.L_Pitch_Increase}]},{type:atlas.control.CompassControl,overrides:[{"class":"rotation",str:t.L_Compass_Reset},{"class":"rotation-right",str:t.L_Compass_Right},{"class":"rotation-left",str:t.L_Compass_Left}]},{type:atlas.control.StyleControl,overrides:[{"class":"curr-style",str:t.L_Style_Select},]}];n.localizeStyleDisplayName=o;n.localize=h})(ot||(ot={}));gt=function(r){function f(){var t=r.call(this)||this;return t._providerId="base",t._beProviderId="birdseye",t._onStyleChangeReset=function(){t._copyrights={};t._previousUrl=t._previousBeUrl=null;t._updateCopyrightContainer()},t._downloadCopyright=function(){var r,o=function(n,i){t._previousRequestKeys.push(w.downloadJsonp(n,"copyright",function(n){t.appendCopyright(i,t._getCopyrights(n))}))},f=t._getCopyrightUrl(u.imageryCopyrightUrlFormat),s,e,n;t._previousUrl!==f&&(t._previousRequestKeys.forEach(function(n){return w.abortRequest(n)}),t._previousRequestKeys=[],t._previousUrl=f,o(f,t._providerId));s=i.getMapStyle(t._azureMap);((r=t._birdseyeControl)===null||r===void 0?void 0:r.isActive)&&s.name==="birdseye"&&(e=t._birdseyeControl.getCurrentSceneProductId(),n=t._getCopyrightUrl(u.beV2ImageryCopyrightUrlFormat,e),e?t._previousBeUrl!==n&&(t._previousBeUrl=n,o(n,t._beProviderId)):t.clearCopyright(t._beProviderId))},t._getCopyrights=function(i){var r;return i&&(r=i.resourceSets&&i.resourceSets.length>0&&i.resourceSets[0]&&i.resourceSets[0].resources[0]?i.resourceSets[0].resources[0].imageryProviders:[]),r&&n.isSDK&&r.push(t._getDefaultCopyright()),r},t._getHMTLCopyrightMarkup=function(n){var t=n.toLowerCase().indexOf(" http"),i,r;return t>-1&&(n.indexOf("href")===-1?(i=n.substr(t).trim(),r=n.substr(0,t).trim(),n='<a target="_blank" href="'.concat(i,'">').concat(r,"<\/a>")):n.indexOf("target=")===-1&&(n=n.replace("<a ",'<a target="_blank" '))),n},t._copyrights={},t._previousRequestKeys=[],t}return l(f,r),f.prototype.onAdd=function(n){var t=this;return this._azureMap=n,this._container=this.buildContainer(n,atlas.ControlStyle.auto),this._container.className="map-copyright",this._copyrightDiv=document.createElement("div"),this._copyrightDiv.className="azure-map-copyright",n.mapLoaded.then(function(){t._container.appendChild(t._copyrightDiv);t._downloadCopyright();n.events.add("idle",t._downloadCopyright);n.events.add("stylechanged",t._onStyleChangeReset)}),this._container},f.prototype.onRemove=function(){this._container=this._copyrightDiv=this._azureMap=null;this._azureMap.events.remove("idle",this._downloadCopyright);this._azureMap.events.remove("stylechanged",this._onStyleChangeReset);r.prototype.onRemove.call(this)},f.prototype.dispose=function(){this.onRemove()},f.prototype.appendCopyright=function(n,t){t&&(this._copyrights[n]=t,this._updateCopyrightContainer())},f.prototype._setBirdseyeControl=function(n){this._birdseyeControl||(this._birdseyeControl=n)},f.prototype.clearCopyright=function(n){delete this._copyrights[n];this._updateCopyrightContainer()},f.prototype._updateCopyrightContainer=function(){for(var t,r,e=Object.keys(this._copyrights),n=[],u=[],i=0,f=e;i<f.length;i++)t=f[i],t!==this._providerId?n.push.apply(n,this._copyrights[t]):u=this._copyrights[t];n.push.apply(n,u);n=Array.from(new Set(n));n=n.map(this._getHMTLCopyrightMarkup);r=n.join(", ");r!==this._previousCopyright&&(this._copyrightDiv.innerHTML=this._previousCopyright=r)},f.prototype._getDefaultCopyright=function(){var i=n.testHooksEnabled?"YYYY":(new Date).getFullYear().toString();return t.L_microsoftcopyright_text.replace("{year}",i)},f.prototype._getCopyrightUrl=function(t,r){var o=this._azureMap.getCamera(),f=o.bounds,e=p.BoundingBox.fromPositions([[f[0],f[1]],[f[2],f[3]]]),s=n.dynamicProperties,h=i.getMapStyle(this._azureMap);return t.replace(/{imagerySet}/,h.copyrightImageryId).replace(/{zoom}/,Math.floor(i.convertZoom(o.zoom,0)).toString()).replace(/{minLat}/,e[1].toString()).replace(/{minLon}/,e[0].toString()).replace(/{maxLat}/,e[3].toString()).replace(/{maxLon}/,e[2].toString()).replace(/{heading}/,o.bearing.toString()).replace(/{credentials}/,s.sessionKey).replace(/{mkt}/,s.market).replace(/{ml}/,u.copyrightMapLayers).replace(/{productId}/,r)},f}(atlas.control.ControlBase),function(n){function t(n){return new Promise(function(t,i){if(atlas.animations)t(atlas.animations.getEasingFn(n));else{var u=function(){t(atlas.animations.getEasingFn(n))};r.globalContainer.instanceAsync("AzureMapAnimation",u,null,!0,function(n,t){i(n+","+t)})}})}function i(n,t,i,r,u){var f="translate3d",e="scale3d";return new Promise(function(o){function s(){var b=performance.now()-l,k,a,d,g;if(b<r){k=b/r;a=t(k);u&&(a=1-a);var p=h*(1-a)/2,w=c*(1-a)/2,v=0,y=0;switch(i){case"top":y=-p;break;case"bottom":y=p;break;case"left":v=-w;break;case"right":v=w;break;case"bottom-left":v=-w;y=p;break;case"top-left":v=-w;y=-p;break;case"bottom-right":v=w;y=p;break;case"top-right":v=w;y=-p}d="".concat(f,"(").concat(v,"px, ").concat(y,"px, 0) ").concat(e,"(").concat(a,", ").concat(a,", 1)");n.style.transform=d;requestAnimationFrame(s)}else g="".concat(f,"(0,0,0) ").concat(e)+(u?"(0,0,0)":"(1,1,1)"),n.style.transform=g,o()}var h=n.clientHeight,c=n.clientWidth,l=performance.now();requestAnimationFrame(s)})}function u(n,r,u,f,e){return atlas.animations?i(n,atlas.animations.getEasingFn(r),u,f,e):t(r).then(function(t){return i(n,t,u,f,e)})}n.prepareFunction=t;n.run=u}(it||(it={})),function(t){function s(t,i,u,f,o,s,h,c){var a,l,y;n.enableInstrumentation&&(l={H:u&&u.bearing,MM:"Mercator",MS:v(f)},u&&(l.CP={latitude:u.center[1],longitude:u.center[0]},l.H=u.bearing),o&&(l.S=o),s&&(l.LOD=s),h&&h.length===4&&(l.BBOX=h),c&&(l.USR=c),i==="MapZoom"&&(e===null||e===void 0?void 0:e.zoom)&&(u===null||u===void 0?void 0:u.zoom)&&(l.ZD=(u===null||u===void 0?void 0:u.zoom)>(e===null||e===void 0?void 0:e.zoom)?"ZoomIn":"ZoomOut"),y={feature:"MC",action:i,data:l},t&&(y.data.EL=t),(a=r.logger)===null||a===void 0?void 0:a.logObject(y))}function c(i){var e=r.logger,o;e&&(a(i),f.add(i,"stylechanged",function(n){t.log("MapMode","MapTypeChanged",i.getCamera(),n.style);n.style==="ordnancesurvey"&&e.logSnrPageNameForMapControl("os",!1)}),h||(u.enableClientInstrumentationIG&&(o=void 0,o=n.isSDK?"sdk":n.isMsftPartner?"msft":"omo",e.logSnrPageNameForMapControl(o,!0)),typeof _G!="undefined"&&i.events.addOnce("idle",function(){e.logObject({feature:"BS",action:"BS_FIN",TS:Math.round(performance.now()),data:{}},_G.IG,!0);e.flush()})));h=!0}function l(n){o=n}function a(n){if(u.logImprov){var t=n._getMap(),r=function(n){var t;if((t=n.originalEvent)!==null&&t!==void 0)return t.isTrusted};t.on("movestart",function(n){var u=t.getCenter(),f=i.roundToInterval(t.getZoom(),.1);e={center:new p.Position(u.lng,u.lat),zoom:f};o=o||r(n)});t.on("moveend",function(u){if(e){var l=i.roundToInterval(t.getZoom(),.1),f=t.getCenter(),h=void 0;if(l!==e.zoom?h="MapZoom":p.Position.areEqual(e.center,new p.Position(f.lng,f.lat))||(h="MapPan"),o=o||r(u),h){var c=t.getBounds(),v=[c.getWest(),c.getSouth(),c.getEast(),c.getNorth()],a=1e-6;s(null,h,{center:new p.Position(i.roundToInterval(f.lng,a),i.roundToInterval(f.lat,a)),zoom:l},n.getStyle().style,undefined,l,v,o?1:0)}e=undefined;o=!1}})}else f.add(n,"movestart",function(){e=n.getCamera()}),f.add(n,"idle",function(){if(e){var i=n.getCamera(),t=void 0;i.zoom!==e.zoom?t="MapZoom":p.Position.areEqual(i.center,e.center)||(t="MapPan");t&&s(null,t,i,n.getStyle().style);e=null}})}function v(n){var t=n;switch(n){case"road":t="r";break;case"roaddark":t="d";break;case"aerial":t="a";break;case"hybrid":t="h";break;case"ordnancesurvey":t="os";break;case"streetside":t="x";break;case"3d":t="3d"}return t}var h=!1,e,o;t.log=s;t.addControlInstrumentation=c;t.setUserAction=l}(a||(a={}));lt=function(){function n(){this.id=i._nextId().toString()}return n}();ni=function(n){function t(i,r){var u=n.call(this)||this,e;return u._map=i,u._infoboxOptions=r||{},(r===null||r===void 0?void 0:r.containerClassName)&&(t._containerClass=r.containerClassName),u._updateHtmlContent(r),e=u._marker=new atlas.HtmlMarker(s(s({},r),{visible:!1})),i.markers.add(e),u._disposables=[f.add(i,"mouseenter",e,function(){return u._onMouseenter()}),f.add(i,"mouseleave",e,function(){return u._onMouseleave()}),f.add(i,"click",e,function(){return u.infoboxClicked.invoke()}),u.infoboxClicked=new k,u.infoboxEnter=new k,u.infoboxLeave=new k],u._setMarkerOptions(r,!0),u}return l(t,n),t.prototype.dispose=function(){this.isDisposed||(this._map&&this._map.markers.remove(this._marker),i._clearDisposables(this._disposables),i._nullifyClass(this),this.isDisposed=!0)},t.prototype.getOptions=function(){return s(s({},this._marker&&this._marker.getOptions()),this._infoboxOptions)},t.prototype.setOptions=function(n){var i=this;this.isDisposed||(n.containerClassName&&(t._containerClass=n.containerClassName),this._updateHtmlContent(n),this._timerId&&(window.clearTimeout(this._timerId),this._timerId=null),n&&n.delayTime>0?this._timerId=y.setTimeout(function(){return i._setMarkerOptions(n)},n.delayTime):this._setMarkerOptions(n))},t.prototype.getImpl=function(){return this._marker},t.prototype.getRootNode=function(){var n,t=(n=this._marker)===null||n===void 0?void 0:n.getOptions().htmlContent;return t!=="string"?t:null},t.getAdjustedAnchor=function(n,t){var i=t.position,r=t.pixelOffset,u="bottom",f="left",s;if(i){var e=300,h=n.getMapContainer(),c=h.clientWidth,o=n.positionsToPixels([i])[0];e>atlas.Pixel.getY(o)&&(u="top");c-e<atlas.Pixel.getX(o)&&(f="right",r[0]*=-1)}return s="".concat(u,"-").concat(f),{anchor:s,pixelOffset:r}},t.prototype._updateHtmlContent=function(n){var i=n&&(n.infoboxContent||n.htmlContent),r,f,e,u;i&&(r=document.createElement("div"),r.className="InfoboxCustom",f=t._containerClass,typeof i=="string"?(e=n.hideContainer?"".concat(i):'<div class="'.concat(f,'">').concat(i,"<\/div>"),r.innerHTML=e):n.hideContainer?r.append(i):(u=document.createElement("div"),u.className=f,r.append(u),u.append(i)),n.htmlContent=r)},t.prototype._onMouseenter=function(){this.preventAutoClose=!0},t.prototype._onMouseleave=function(){var n=this.getOptions();this.preventAutoClose=!1;n.keepOpenOnMouseleave||this.setOptions({visible:!1,delayTime:n.delayTime||500})},t.prototype._setMarkerOptions=function(n,i){var a=this,u=this._marker,e=function(){a._infoboxOptions=s(s({},a._infoboxOptions),n)},c,r,l;if(u){var o=this.getOptions(),w=o.visible?1:0,h=(n===null||n===void 0?void 0:n.visible)?1:0,f=void 0;if(f=n&&(typeof n.animationDuration=="number"||n.animationDuration===null)?n.animationDuration:o.animationDuration,typeof f=="undefined"&&(f=t._defaultAnimation),c=this.getRootNode(),r=c.querySelector&&c.querySelector("."+t._containerClass),r&&f>0&&(i||w^h)){var v="translate3d(0,0,0) scale3d"+(h?"(0,0,0)":"(1,1,1)"),y=(n===null||n===void 0?void 0:n.anchor)||o.anchor,p="easeInOutQuart";h?(u.setOptions(n),r=this.getRootNode().querySelector("."+t._containerClass),r.style.transform=v,it.run(r,p,y,f).then(e)):(r.style.transform=v,it.run(r,p,y,f,!0).then(function(){u.setOptions(n);e()}))}else u.setOptions(n),e();l=function(n){n.stopPropagation()};u.getElement().addEventListener("click",l);u.getElement().addEventListener("mousemove",l)}},t._containerClass="MapsInfoboxContainer",t._defaultAnimation=250,t}(lt),function(n){function u(n,i,u){var f,e;return t||(f=n.getMapContainer(),t=document.createElement("div"),t.setAttribute("id",r),t.style.position="absolute",t.style.transform="scale3d(0, 0, 1)",f.append(t)),e=function(r){var f=r.metadata.pixelRatio,c=r.icon.width/f,l=r.icon.height/f,e=c+"px",o=l+"px",s=i.geometry,h=n.positionsToPixels([new p.Position(s.x,s.y)])[0],a=h[0]+r.offset[0],v=h[1]+r.offset[1],u=r.canvas;return u.style.width=e,u.style.height=o,t.innerHTML="",t.style.width=e,t.style.height=o,t.appendChild(u),t.style.left=a+"px",t.style.top=v+"px",t},u.getPrimitiveIcon(i).then(function(n){return e(n)})}function f(n,r,f){var o=u(n,r,f),e="easeOutBounce",s=it.prepareFunction(e);return Promise.all([o,s]).then(function(){return it.run(t,e,"bottom",i)})}function e(){t&&(t.style.transform="translate3d(0,0,0) scale3d(0,0,1)")}var i=500,r="poiPopUp",t;n.popupAnimation=f;n.reset=e}(at||(at={}));function ti(n,t,i){i===void 0&&(i="");return'\n        <div class="switchSlot '.concat("labelToggleSlot"," ").concat(i,'" tabindex="-1">\n            <input id="navbarLabelToggleInput" type="checkbox" class="').concat("labelToggleInput",'" checked="checked" aria-label="').concat(n,'" />\n            <label for="navbarLabelToggleInput" title="').concat(t,'" class="').concat("labelStyle",'">').concat(n,"<\/label>\n        <\/div>")}var rt=function(){function n(t,i,r,u,f){var e,s,h,o;u===void 0&&(u=!1);e=this;this._toggleClass=function(n,t){var i,r=(i=e._element)===null||i===void 0?void 0:i.classList;r&&(t?r.add(n):r.remove(n))};this._addInuse=function(){clearTimeout(e._timer);e._deactivateOthers();e._toggleClass("in-use",!1);e._toggleClass("user-interacted",!0)};this._removeInuse=function(){e._control.isDefault||(clearTimeout(e._timer),e._timer=y.setTimeout(e._timeoutHandler,2e3))};this.deactivate=function(){var n;e._toggleClass("in-use",!1);e._toggleClass("user-interacted",!1);clearTimeout(e._timer);(n=e._element.querySelector(".sub-container"))===null||n===void 0?void 0:n.classList.add("hidden-accessible-element")};this._focusOut=function(n){e._element.contains(n.relatedTarget)||e._control.isDefault||e.deactivate()};this._clickHandler=function(n){e._element.contains(n.target)?(e._addInuse(n),e._clickCallback&&e._clickCallback(n)):e._control.isDefault||(e._overlapDefault?e._timeoutHandler():e.deactivate())};this._timeoutHandler=function(){var t,r,u,i;for(e.deactivate(),t=0,r=Object.keys(n._allControls);t<r.length;t++)if(u=r[t],i=n._allControls[u],i.isDefault&&i.activate){i.activate();break}};this._deactivateOthers=function(){var i,o=(i=e._element)===null||i===void 0?void 0:i.getAttribute("id"),t,r,u,f;if(o)for(t=0,r=Object.keys(n._allControls);t<r.length;t++)u=r[t],o!==u&&(f=n._allControls[u],(!f.isDefault||e._overlapDefault)&&f.deactivate())};this._keyboardHandler=function(n){n.code==="Escape"?e._timeoutHandler():(n.code==="Enter"||n.code==="Space")&&(e._addInuse(n),n.target instanceof HTMLInputElement||e._clickCallback&&e._clickCallback(n))};s=this._addInuse;h=this._removeInuse;this._overlapDefault=u;r&&(this._element=r,o=function(n,t,i){r.addEventListener(n,t,i)},window.addEventListener("click",this._clickHandler),o("mouseover",s),o("focusin",s),o("mouseleave",h),o("focusout",this._focusOut),o("keydown",this._keyboardHandler),this._clickCallback=f);n._allControls[t]=i;this._control=i}return n.prototype.dispose=function(){var i=this;if(this._element){var t=this._addInuse,r=this._removeInuse,n=function(n,t,r){i._element.removeEventListener(n,t,r)};window.removeEventListener("click",this._clickHandler);n("mouseover",t);n("focusin",t);n("mouseleave",r);n("focusout",this._focusOut);n("keydown",this._keyboardHandler)}},n._allControls={},n}(),nr=function(r){function e(u){var f=r.call(this)||this;return f._lastReq=0,f._updateDriver=function(){f._lastReq&&clearTimeout(f._lastReq);var t=function(){(!n.isMapsAnswer||i._isMapsOverlay())&&(f.updateGeoChain(),f._updateAriaLabel())};f._lastReq=y.setTimeout(t,e._throttlingMS)},f.setGeochainCollapseState=function(n,t){n&&(f.isCollapsed=!f.isCollapsed,t&&kt.setItem("geoChainCollapsed",f.isCollapsed?"1":"0"),t?f.updateGeoChain():f._updateDriver());var i=f.isCollapsed?"geochainCollapse":"geochainUncollapse",r=f.isCollapsed?"geochainUncollapse":"geochainCollapse";f.geochainExpander.classList.replace(i,r);f.geochainSegmentContainer.style.display=f.isCollapsed?"none":"inline"},f._updateAriaLabel=function(){var n=function(n){if(n&&n.length>0){var i=t.L_MapOf.replace("{0}",n.reverse().map(function(n){return n.displayName}).join(", ")),r=f.map.getMapContainer(),u="aria-label";r.getAttribute(u)!==i&&r.setAttribute(u,i)}};f.geoChainManager.getGeochain(f.map,n,null,null,!0)},f._disposables=[],f.options=u,f.allowToggleOnResize=!0,f.isCollapsed=u.geochain==="collapsed"||kt.getItem("geoChainCollapsed")==="1",f}return l(e,r),e.prototype.onAdd=function(n,t){var i=this,r;return this.isCollapsed=this.isCollapsed||n.getMapSize().width<this.options.minMapWidthforGeochain,this.geoChainManager=new yi(new wi),this.map=n,r=this.constructGeochain(t),this._disposables.push(f.add(n,"resize",function(){if(i.allowToggleOnResize){var t=n.getMapSize().width;(i.isCollapsed&&t>=i.options.minMapWidthforGeochain||!i.isCollapsed&&t<i.options.minMapWidthforGeochain)&&i.setGeochainCollapseState(!0)}})),n.mapLoaded.then(this._updateDriver),this._disposables.push(f.add(n,"moveend",this._updateDriver)),r},e.prototype.onRemove=function(){i._clearDisposables(this._disposables);i._nullifyClass(this)},e.prototype.dispose=function(){this.onRemove()},e.prototype.constructGeochain=function(n){var e=this,r=document.createElement("div"),i,f;return r.classList.add("geochainContainer"),i=this.geochainExpander=u.bingStylePicker?document.createElement("button"):document.createElement("a"),i.classList.add("geochainActionButton"),i.classList.add("geochainCollapse"),i.setAttribute("title",t.L_GeochainTitle_Text),f=this.geochainSegmentContainer=document.createElement("span"),n&&(n.position===atlas.ControlPosition.TopRight||n.position===atlas.ControlPosition.BottomRight)?(r.appendChild(i),r.appendChild(f)):(r.appendChild(f),r.appendChild(i)),this.setGeochainCollapseState(!1),i.addEventListener("click",function(){e.allowToggleOnResize=!1;e.setGeochainCollapseState(!0,!0)}),r},e.prototype.updateGeoChain=function(){var n=this;this.isCollapsed||this.geoChainManager.getGeochain(this.map,function(t){var r,e,i,u,o,f;if(t){for(r="",e=0,i=0,u=t;i<u.length;i++)o=u[i],r+='<a class="geochainSegment" data-index="'.concat(e++,'" data-tag="geochainSegment">').concat(o.displayName,"<\/a>");f="<span>".concat(r,"<\/span>");f!==n.geochainSegmentContainer.innerHTML&&(n.geochainSegmentContainer.innerHTML=f)}})},e._throttlingMS=1e3,e}(atlas.control.ControlBase),ii=function(r){function e(n){var t=r.call(this)||this,i,u;return t.isDefault=!0,t.deactivate=function(){var n;(n=t._commonHandler)===null||n===void 0?void 0:n.deactivate()},t.activate=function(){t._container.classList.add("user-interacted")},t._closeToolTip=function(){t._toolTip&&(t._toolTip.close(),t._toolTip.remove(),t._toolTip=null)},i=e.defaultOptions,u=n?s(s({},i),n):s({},i),t._options=u,t.locateMeEvent=new k,t}return l(e,r),e.prototype.onAdd=function(n,i){var r=this,e,f,o;return this._map=n,e=t.L_LocateMe_Text,f=this._container=this.buildContainer(n,this._options.style,e),n.locateMeEvent=this.locateMeEvent,o=function(){var t=r._options.geochain!=="disabled";t&&(r._geochainControl=new nr(r._options));i&&(i.position===atlas.ControlPosition.TopRight||i.position===atlas.ControlPosition.BottomRight)?(t&&r._container.append(r._geochainControl.onAdd(n,i)),f.append(r._constructLocateMeButton(e))):(f.append(r._constructLocateMeButton(e)),t&&r._container.append(r._geochainControl.onAdd(n,i)))},u.bingStylePicker?n.mapLoaded.then(function(){var n,t;o();n="locateMe";f.setAttribute("id",n);r._commonHandler=new rt(n,r,f);t=document.createElement("div");t.classList.add("locateMeBtnBg");f.append(t);r.activate()}):o(),f},e.prototype.onRemove=function(){var n;r.prototype.onRemove.call(this);this._container&&(this._geochainControl&&this._geochainControl.dispose(),(n=this._commonHandler)===null||n===void 0?void 0:n.dispose(),this._container.remove(),this._mePoi.dispose(),i._nullifyClass(this))},e.prototype.dispose=function(){this.onRemove()},e.prototype._constructLocateMeButton=function(n){var i=this,t=document.createElement("button");return t.classList.add("azure-maps-control-button"),t.classList.add("locateMeBtn"),t.setAttribute("aria-label",n),t.setAttribute("alt",n),t.setAttribute("title",n),t.setAttribute("type","button"),t.addEventListener("click",function(){return i.locateMe()}),t},e.prototype.locateMe=function(){var t=this,r=function(r){var c,l=!1,a=!1,s=0,o,e=n.dynamicProperties,f,v;if(r.success&&r.location&&r.position&&r.position.coords&&r.position.coords.accuracy>=0&&(s=r.position.coords.accuracy,l=s<=u.locateMeHighAccuracyMeters,a=l||!e.locationIsPreferenceBased,a&&(f=r.location,o="w3cLocation")),f||(e.locationIsPreferenceBased&&e.preferenceBasedLocation?(f=i.parseLatLong(e.preferenceBasedLocation),o="preferenceBasedLocation"):e.location?(f=i.parseLatLong(e.location),o="FDLocation"):e.reverseIPLocation?(f=i.parseLatLong(e.reverseIPLocation),o="reverseIPLocation"):e.marketLocation&&(f=i.parseLatLong(e.marketLocation),o="marketLocation")),f){var y=t._map.getMapSize(),p=Math.max(y.width,y.height),h=t._map.getCamera().zoom;s>0&&p>0&&(h=et.fromScale(f,6*s/p,!0));h=Math.max(Math.min(h,16),11);v={location:f,accuracy:s,locationType:o};l?t._options.displayUserLocationPoi&&(t._mePoi||(t._mePoi=new ri(t._map)),t._mePoi.showMePoi(f,t._options.enablePoiAnimation)):(t._displayError(f,a),((c=r.error)===null||c===void 0?void 0:c.code)>0&&(v.error=r.error.code));t.locateMeEvent.invoke(v);t._map.setCamera({center:f,zoom:h})}};this._geoLocationProvider||(this._geoLocationProvider=new pi(window,null));this._geoLocationProvider.GetCurrentPosition({callback:r});a.log("MyLocation","NC",this._map.getCamera(),this._map.getStyle().style)},e.prototype._displayError=function(i,r){var e=this;f.addOnce(this._map,"moveend",function(){var o="",s,h,c;if((n.isMapsAnswer||n.isMapsVertical)&&(s=u.bingSettingsUrl.replace("{returnUrl}",encodeURIComponent(window.location.href)).replace("{formCode}",u.locateMeFormCode),o="<div><a role='link' href='".concat(s,"'>").concat(t.L_LocateMe_ChangeSettings_Text,"<\/a><\/div>")),h=r?t.L_LocateMe_Error_Text_Approximate_Location:t.L_LocateMe_Error_Text_Setting,c="<div class='bm_LocateMeErrorDialog'>"+"<div data-role='message'>".concat(h,"<\/div>")+"".concat(o,"<\/div>"),e._toolTip){if(e._toolTip.isOpen)return}else e._toolTip=new atlas.Popup({closeButton:!1,draggable:!1,showPointer:!1,position:i,content:c,pixelOffset:[0,e._map.getMapSize().height/2]});e._toolTip.open(e._map);f.addOnce(e._map,"idle",function(){f.addOnce(e._map,"movestart",e._closeToolTip)})})},e.defaultOptions={style:atlas.ControlStyle.light,geochain:"disabled",displayUserLocationPoi:!0,enablePoiAnimation:!0,minMapWidthforGeochain:900},e}(atlas.control.ControlBase),ri=function(){function n(n){var t=this;this._mePoiId="MePoi";this._addAnimationLayer=function(n,i){t._animationLayer=new di.BubbleLayer(i,null,{color:"rgb(0, 204, 255)",strokeWidth:0,pitchAlignment:"map",visible:!1});n.layers.unshift(t._animationLayer)};this._toggleAnimation=function(){var n=p.BoundingBox.containsPosition(t._map.getCamera().bounds,t._poiLocation);isNaN(t._animationRequestId)&&n&&t._isVisible?t._pulseAnimation(0):n&&t._isVisible||(cancelAnimationFrame(t._animationRequestId),t._animationRequestId=NaN)};this._pulseAnimation=function(n){var r,i=n%4e3/4e3;r=i<.1?{radius:0,visible:!1}:{radius:50*i,opacity:Math.max(.9-i,0),visible:!0};t._animationLayer.setOptions(r);t._animationRequestId=requestAnimationFrame(t._pulseAnimation)};this._map=n;this._disposables=[]}return n.prototype.showMePoi=function(n,t){var i=this,r;this._isVisible||(this._mePoi?(p.Position.areEqual(this._poiLocation,n)||(this._mePoi.geometry={geometryType:1,x:n[0],y:n[1]},this._primitiveManager.update([this._mePoi])),this._setVisibility(!0)):(this._poiLocation=n,r=function(){i._mePoi={geometry:{geometryType:1,x:n[0],y:n[1]},bucket:"354",primitiveType:11,id:i._mePoiId,state:2,isHoverEnabled:!1};i._primitiveManager.modifyLayerGroupCallback=i._addAnimationLayer;i._primitiveManager.add([i._mePoi]).then(function(){t&&i._animatePoi()});i._setVisibility(!0)},this._primitiveManager?r():ki.resolveBySourceKey("BingMapStyle",function(){var n=Microsoft.Maps.BingMapStyle;n.init(i._map);i._primitiveManager=new Microsoft.Maps.BingMapStyle.PrimitiveManager(i._map);i._disposables.push(i._primitiveManager);r()})))},n.prototype.hideMePoi=function(){this._isVisible&&(this._setVisibility(!1),this._toggleAnimation())},n.prototype.dispose=function(){cancelAnimationFrame(this._animationRequestId);this._map.layers.remove(this._animationLayer);i._clearDisposables(this._disposables);i._nullifyClass(this)},n.prototype._animatePoi=function(){var n=this;y.setTimeout(function(){n._disposables.push(f.add(n._map,"moveend",n._toggleAnimation));n._toggleAnimation()},1e3)},n.prototype._setVisibility=function(n){this._primitiveManager.setLayerOptions({visible:n});this._isVisible=n},n}(),ui=function(n){function t(i){var r=n.call(this)||this;return r._options={units:"imperial",maxBarLength:100},r._updateScaleBar=function(){var h="imperial",c="metric",y=r._map.getCamera(),f=r._options,l=r._map.positionsToPixels([y.center]),a=r._map.pixelsToPositions([[0,l[0][1]],[f.maxBarLength,l[0][1]]]),n=f.units.toLowerCase(),v,s;n===h?n="miles":n===c&&(n="kilometers");var i=atlas.math.getDistanceTo(a[0],a[1],n),e=t._getRoundNumber,u=e(i),o=!1;u<2&&(n=f.units.toLowerCase(),n===h?(i*=5280,u=e(i),o=!0):n===c&&(i*=1e3,u=e(i),o=!0));v=u/i;s=r._scaleBar;s.style.width=f.maxBarLength*v+"px";s.innerHTML=r._createDistanceString(u,o)},r._options=Object.assign(r._options,i||{}),r}return l(t,n),t.prototype.onAdd=function(n){var t,i;return this._map=n,t=this.buildContainer(n,atlas.ControlStyle.auto),t.className="scalebar",i=this._scaleBar=document.createElement("div"),i.className="azure-scaleBar",t.appendChild(i),this._map.events.add("moveend",this._updateScaleBar),this._updateScaleBar(),t},t.prototype.onRemove=function(){this._map&&this._map.events.remove("moveend",this._updateScaleBar);this._map=null;this._scaleBar.remove();this._scaleBar=null},t._getRoundNumber=function(n){if(n>=2){var i=Math.pow(10,(Math.floor(n)+"").length-1),t=n/i;return t=t>=10?10:t>=5?5:t>=3?3:t>=2?2:1,i*t}return Math.round(100*n)/100},t.prototype._createDistanceString=function(n,t){return this._options.units?this._options.units.toLowerCase()==="metric"?t?n+" m":n+" km":t?n+" ft":n+" mi":null},t}(atlas.control.ControlBase),fi=function(n){function t(){var t=n!==null&&n.apply(this,arguments)||this;return t.deactivate=function(){var n;(n=t._commonHandler)===null||n===void 0?void 0:n.deactivate()},t}return l(t,n),t.prototype.onAdd=function(t,i){var u=this,r=n.prototype.onAdd.call(this,t,i);return t.mapReady.then(function(){var n="bingCompass";r.setAttribute("id",n);u._commonHandler=new rt(n,u,r)}),r},t.prototype.dispose=function(){this.onRemove()},t}(atlas.control.CompassControl),ei=function(n){function i(){var t=n!==null&&n.apply(this,arguments)||this;return t.deactivate=function(){var n;(n=t._commonHandler)===null||n===void 0?void 0:n.deactivate()},t}return l(i,n),i.prototype.onAdd=function(t,i){var u=this,r;return this.updatePitchButtonsState=function(){},r=n.prototype.onAdd.call(this,t,i),t.mapReady.then(function(){var n="bingPitch";r.setAttribute("id",n);u._commonHandler=new rt(n,u,r)}),t.events.remove("pitch",this.pitchChanged),r},i.prototype.dispose=function(){this.onRemove()},i.prototype.constructPitchGrid=function(n){var i=document.createElement("div"),r,u;return i.classList.add("sub-container"),i.classList.add("hidden-accessible-element"),i.setAttribute("aria-hidden","true"),r=this.pitchIncrementButton=this.constructPitchIncrementButton(n),u=this.pitchDecrementButton=this.constructPitchDecrementButton(n),r.setAttribute("title",t.L_Pitch_Increase),u.setAttribute("title",t.L_Pitch_Decrease),i.appendChild(r),i.appendChild(u),i},i}(atlas.control.PitchControl),oi=function(n){function t(){var t=n!==null&&n.apply(this,arguments)||this;return t.deactivate=function(){var n;(n=t._commonHandler)===null||n===void 0?void 0:n.deactivate()},t}return l(t,n),t.prototype.onAdd=function(t){var r=this,i=n.prototype.onAdd.call(this,t);return t.mapReady.then(function(){var n="bingZoom";i.setAttribute("id",n);r._commonHandler=new rt(n,r,i)}),i},t.prototype.dispose=function(){this.onRemove()},t}(atlas.control.ZoomControl),si="";n.trafficStyleMenu&&(si="checkboxContainer");var tr='\n<div id="'.concat("bingStylePicker",'" class="NavBar_DropDown menu"\n     role="listbox" aria-multiselectable="true">\n     <div class="').concat("topRow",'">\n        <div class="').concat("slot"," ").concat("road",'" tabindex="0" role="option" ').concat("data-mapStyle",'="').concat("road",'">\n            <div class="').concat("mapTypeIcon",'"><\/div>\n            <div class="').concat("mapTypeLabel",'"><\/div>\n        <\/div>\n        <div class="').concat("slot"," ").concat("aerial",'" tabindex="0" role="option" ').concat("data-mapStyle",'="').concat("aerial",'">\n            <div class="').concat("mapTypeIcon",'"><\/div>\n            <div class="').concat("mapTypeLabel",'"><\/div>\n        <\/div>\n        <div class="').concat("slot"," ").concat("ordnancesurvey",'" tabindex="0" role="option" ').concat("data-mapStyle",'="').concat("ordnancesurvey",'">\n            <div class="').concat("mapTypeIcon",'"><\/div>\n            <div class="').concat("mapTypeLabel",'"><\/div>\n        <\/div>\n        <div class="').concat("slot"," ").concat("birdseye",'" tabindex="0" role="option" ').concat("data-mapStyle",'="').concat("birdseye",'">\n            <div class="').concat("mapTypeIcon",'"><\/div>\n            <div class="').concat("mapTypeLabel",'"><\/div>\n        <\/div>\n        <div class="').concat("slot"," ").concat("streetside",'" tabindex="0" role="option" ').concat("data-mapStyle",'="').concat("streetside",'">\n            <div class="').concat("mapTypeIcon",'"><\/div>\n            <div class="').concat("mapTypeLabel",'"><\/div>\n        <\/div>\n        <div class="').concat("slot"," ").concat("3d",'" tabindex="0" role="option" ').concat("data-mapStyle",'="').concat("3d",'">\n            <div class="').concat("mapTypeIcon",'"><\/div>\n            <div class="').concat("mapTypeLabel",'"><\/div>\n        <\/div>\n    <\/div>\n    <div class="').concat("mapTypeLabel"," ").concat(si,'">\n        ').concat(ti(t.L_Details,t.L_DetailsTooltip),'\n    <\/div>\n<\/div>\n<button id="').concat("bingStylePickerIcon",'"\n        class="azure-maps-control-button"\n        tabindex="0"\n        aria-label="').concat(t.L_Style_Select,'"\n        title="').concat(t.L_Style_Select,'"\n        type="button"><\/button>\n'),hi=function(r){function e(t,i){var u=r.call(this)||this;return u.targetStyleIncrements=0,u.isDefault=!1,u.deactivate=function(){var n;(n=u._commonHandler)===null||n===void 0?void 0:n.deactivate()},u._clickHandler=function(t){var f=t.target,s,h;if(f){var e=f.classList,r=u._container.querySelector("#navbarLabelToggleInput").checked,i=u.map.getStyle().style,o=r?"1":"0";n.trafficStyleMenu&&f===u._trafficCheckbox?(s=function(){var n={action:"toggleBoth",callBack:function(n){return u.setBoxes(n)}};Microsoft.Maps.GlobalDataEventHandler.invokeHandler("data-traffic",n)},Microsoft.Maps.GlobalDataEventHandler?s():u._shell.getContainer().instanceAsync("GlobalDataEventHandler",function(){return s()})):e.contains("labelToggleInput")?(i==="road"||i==="roaddark"?(u._toggleRoadLabels(r),a.log("Details","NC",null,i,o)):i==="birdseye"?(u._toggleBElabels(r),a.log("Details","NC",null,i,o)):(i==="hybrid"||i==="aerial")&&u._switchStyle(null,r,i),u._setSSCoverage(r)):e.contains("slot")?u._switchStyle(f,r):e.contains("mapTypeIcon")||e.contains("mapTypeLabel")?(u._switchStyle(f.parentElement,r),a.log("MapMode","NC",null,i,o)):e.contains("azure-maps-control-button")&&(h="hybrid",(i==="aerial"||i==="hybrid"||i==="birdseye")&&(h="road"),u._switchStyle(null,r,h))}},u._disposables=[],u._options=i,u._shell=t,u}return l(e,r),e.prototype.onAdd=function(t){var i=this,r;return this.map=t,r=this._container=this.buildContainer(t,this._options.style,""),t.mapReady.then(function(){var a,c,v;r.setAttribute("id","bingStyleControl");r.innerHTML=tr;var y=!!u.mapStyleDefinition.styles.find(function(n){return n.name==="3d"}),p=(nt===null||nt===void 0?void 0:nt.isEnabled)&&(nt===null||nt===void 0?void 0:nt.isStylePickerEntryPointEnabled),w=y&&p&&h.is3DSupported;for(n.trafficStyleMenu&&i.addTrafficPickerElement(),a=r.querySelectorAll("div.".concat("slot")),c=0;c<a.length;++c){var o=a[c],s=o.getAttribute("data-mapStyle"),l=e.getStyleNode(s),b=(s!=="3d"||w)&&(s!=="streetside"||(tt===null||tt===void 0?void 0:tt.isEnabled));l&&b?(s==="roaddark"?(v=e.getStyleNode("road"),o.setAttribute("aria-label",v.displayName),o.querySelector("div.".concat("mapTypeLabel")).innerHTML=v.displayName):(o.setAttribute("aria-label",l.displayName),o.querySelector("div.".concat("mapTypeLabel")).innerHTML=l.displayName,i._shell&&s==="3d"&&i._shell.getMap3DSharedDelegate()),o.querySelector("div.".concat("mapTypeIcon")).style.backgroundImage="url(".concat(l.thumbnail,")")):o.remove()}i._adjustIcons();i._adjustDetails();i._commonHandler=new rt("bingStyleControl",i,r,!0,i._clickHandler);i._disposables.push(f.add(t,"idle",function(){return i._bessAvailable()}),f.add(t,"stylechanged",function(){return i._adjustIcons()}))}),r},e.prototype.addTrafficPickerElement=function(){var u=this,i=document.querySelector("div.".concat("labelToggleSlot")),e=ti(t.L_TrafficStyleMenu,t.L_TrafficStyleMenu),n,r,f;i===null||i===void 0?void 0:i.insertAdjacentHTML("afterend",e);this._trafficCheckbox=this._container.querySelector('[aria-label="'.concat(t.L_TrafficStyleMenu,'"]'));this._trafficCheckbox.id="navbarLabelToggleInput trafficBox";n=document.querySelector('label[title="'.concat(t.L_TrafficStyleMenu,'"]'));n===null||n===void 0?void 0:n.setAttribute("for",this._trafficCheckbox.id);this._trafficCheckbox.checked=!1;r=function(){u._trafficCheckbox.checked=!0;sj_evt.unbind("OnLoadTrafficLayerStatus",r)};sj_evt.bind("OnLoadTrafficLayerStatus",r);f=function(){u._trafficCheckbox.checked=!1};sj_evt.bind("ClosedTrafficCard",f);sj_evt.fire("TrafficPickerAdded")},e.prototype.onRemove=function(){var n;this._container&&((n=this._commonHandler)===null||n===void 0?void 0:n.dispose());i._clearDisposables(this._disposables);i._nullifyClass(this);r.prototype.onRemove.call(this)},e.prototype.dispose=function(){this.onRemove()},e.prototype._toggleRoadLabels=function(n){for(var t,r,u=this.map._mbMap,e=n?"visible":"none",o=u.getStyle().layers,i=0,f=o;i<f.length;i++)t=f[i],r=t.id.toLowerCase(),(t.source==="bing-mvt"&&r.indexOf("landmark")>-1||r.indexOf("lmk_3d")===0)&&u.setLayoutProperty(t.id,"visibility",e)},e.prototype.setBoxes=function(n){this._trafficCheckbox.checked=n;sj_evt.fire("TrafficPickerSelected");var t=this.map.getStyle().style,i=n?"1":"0";a.log("TrafficCheckbox","NC",null,t,i)},e.prototype._toggleBElabels=function(n){for(var r,u=this.map._mbMap,f=n?"visible":"none",e=this.map.layers.getLayerById("labels").layers,o=this.map.layers.getLayerById("roads").layers,s=st(st([],o,!0),e,!0),t=0,i=s;t<i.length;t++)r=i[t],u.setLayoutProperty(r.id,"visibility",f)},e.prototype._switchStyle=function(n,t,i){var r=this,e,o,u,s;(this.targetStyleIncrements++,e=this.map.getCamera(),o={bounds:e.bounds},(n===null||n===void 0?void 0:n.classList.contains("disabled"))&&!i)||(u=n&&n.getAttribute("data-mapStyle")||i,u!=="streetside"&&this._ssAvailable(o).then(function(){r._ssControl.toggleCoverage(!1)}),u==="birdseye"?this._beAvailable(e).then(function(n){if(n){var i=function(){t||r._toggleBElabels(!1)};r._beControl.activate();f.addOnce(r.map,"stylechanged",function(){i()})}}):u==="3d"?(s=this.targetStyleIncrements,this._shell.getMap3DSharedDelegate().then(function(n){var i=!r._shell,t;i||s!==r.targetStyleIncrements||(a.log("MapMode","MapTypeChanged",r.map.getCamera(),"3d"),t=r._shell.getSelectedPrimitive(),n.open(t))})):u==="streetside"?(this._ssAvailable(o).then(function(){r._ssControl.toggleCoverage();r._ssControl.getCoverage().autoCoverage(!0)}),this._container.querySelector("#navbarLabelToggleInput").checked=!0):(u==="road"||u==="roaddark"?t||f.addOnce(this.map,"stylechanged",function(){r._toggleRoadLabels(!1)}):(u==="hybrid"||u==="aerial")&&(u=t?"hybrid":"aerial"),this.map.setStyle({style:u})))},e.prototype._adjustDetails=function(n){var t=this._container.querySelector("#navbarLabelToggleInput"),i=this._container.querySelector(".".concat("labelToggleSlot"));n||(n=this.map.getStyle().style,t.checked=n!=="aerial");n==="ordnancesurvey"||n==="road"&&h.renderingMode===2?(t.disabled=!0,i.classList.add("disabled")):(t.disabled=!1,i.classList.remove("disabled"))},e.prototype._adjustIcons=function(){var t=this.map.getStyle().style,r,i,u,n;for(t==="hybrid"&&(t="aerial"),this._container.querySelector("#".concat("bingStylePickerIcon")).style.backgroundImage="url(".concat(e.getStyleNode(t).thumbnail,")"),r=this._container.querySelectorAll("#".concat("bingStylePicker"," .slot")),i=0;i<r.length;i++)u=r[i],n=u.classList,n.contains("hidden")||(n.contains(t)?n.add("selected"):n.remove("selected"))},e.prototype._bessAvailable=function(){var n=this,r=this.map.getCamera(),u=function(t,i,r){var f="div[id='".concat("bingStylePicker","'] .slot.").concat(t),u=n._container.querySelector(f);u&&(i?(u.classList.remove("disabled"),u.removeAttribute("title")):(u.classList.add("disabled"),u.setAttribute("title",r)))},f;i._isFeatureEnabled("birdseye")&&this._beAvailable(r).then(function(n){u("birdseye",n,t.L_No_BE_Images)});i._isFeatureEnabled("streetside")&&(f={bounds:r.bounds},this._ssAvailable(f).then(function(i){var r;u("streetside",i,t.L_No_SS_Images);i||((r=n._ssControl)===null||r===void 0?void 0:r.toggleCoverage(!1))}))},e.prototype._beAvailable=function(n){var i=this,t,r,u;return this._beControl?t=this._beControl.isBirdseyeAvailable(n.center,n.bearing):this._shell?(r=function(){return i._shell.getBirdseyeControl().then(function(t){return i._beControl=t,t.isBirdseyeAvailable(n.center,n.bearing)})},u=this._shell.getAzureMap(),t=u.mapFirstIdle.then(function(){return r()})):t=Promise.resolve(!1),t},e.prototype._ssAvailable=function(n){var i=this,t,r,u;return this._ssControl?t=this._ssControl.isStreetsideAvailable(n):this._shell&&(tt===null||tt===void 0?void 0:tt.isEnabled)?(r=function(){return i._shell.getStreetsideControl().then(function(t){return i._ssControl=t,t.isStreetsideAvailable(n)})},u=this._shell.getAzureMap(),t=u.mapFirstIdle.then(function(){return r()})):t=Promise.resolve(!1),t},e.prototype._setSSCoverage=function(n){var t=this;this._ssControl?this._ssControl.getCoverage().autoCoverage(n):this._shell&&this._shell.getStreetsideControl().then(function(i){t._ssControl=i;i.getCoverage().autoCoverage(n)})},e.getStyleNode=function(n){return u.mapStyleDefinition.styles.find(function(t){return t.name===n})},e}(atlas.control.ControlBase),ci="";n.trafficStyleMenu2&&(ci='\n    <div id="'.concat("bingStylePicker",'" class="NavBar_DropDown menu">\n        <div class="').concat("mapTypeLabel"," ").concat("TrafficPicker",'">\n            <div class="switchSlot ').concat("labelToggleSlot",' checkbox trafficItem" tabindex="-1">\n                <input id="navbarLabelToggleInput trafficBox" type="checkbox" class="').concat("labelToggleInput",'" checked="checked" aria-label="').concat(t.L_TrafficStyleMenu,'" />\n                <label for="navbarLabelToggleInput trafficBox" title="').concat(t.L_TrafficStyleMenu,'" class="').concat("labelStyle",'">').concat(t.L_TrafficStyleMenu,'<\/label>\n            <\/div>\n            <div class="switchSlot ').concat("labelToggleSlot",' checkbox incidentsItem" tabindex="-1">\n                <input id="navbarLabelToggleInput incidentsBox" type="checkbox" class="').concat("labelToggleInput",'" checked="checked" aria-label="').concat(t.L_Incidents,'" />\n                <label for="navbarLabelToggleInput incidentsBox" title="').concat(t.L_Incidents,'" class="').concat("labelStyle",'">').concat(t.L_Incidents,'<\/label>\n            <\/div>\n        <\/div>\n    <\/div>\n    <button id="TrafficStyleMenuButton"\n            class="azure-maps-control-button trafficBtn"\n            tabindex="0"\n            title="').concat(t.L_TrafficStyleMenu,'"\n            type="button"><\/button>\n    '));var ir=function(n){function r(t,i){var r=n.call(this)||this;return r.isDefault=!1,r.deactivate=function(){var n;(n=r._commonHandler)===null||n===void 0?void 0:n.deactivate()},r._clickHandler=function(n){var t=n.target,i,u;t&&(i=t.classList,u=function(){i.contains("labelToggleInput")&&(t===r.trafficTarget?r.callHandler("TrafficPickerBox","toggleTrafficFlow",r.trafficTarget,null):t===r.incidentsTarget&&r.callHandler("IncidentsPickerBox","toggleIncidentFlow",null,r.incidentsTarget));i.contains("azure-maps-control-button")&&t===r.trafficIcon&&r.callHandler("Traffic","toggleBoth",r.trafficTarget,r.incidentsTarget)},Microsoft.Maps.GlobalDataEventHandler?u():r._shell.getContainer().instanceAsync("GlobalDataEventHandler",function(){return u()}))},r._disposables=[],r._options=i,r._shell=t,r}return l(r,n),r.prototype.onAdd=function(n){var i=this,r;return this.map=n,r=this._container=this.buildContainer(n,this._options.style,""),n.mapReady.then(function(){var u="trafficMenu",n,f;r.setAttribute("id",u);r.innerHTML=ci;i.trafficIcon=r.querySelector("#TrafficStyleMenuButton");i.trafficTarget=r.querySelector(".".concat("labelToggleInput",'[aria-label="').concat(t.L_TrafficStyleMenu,'"]'));i.incidentsTarget=r.querySelector(".".concat("labelToggleInput",'[aria-label="').concat(t.L_Incidents,'"]'));i.trafficTarget.checked=!1;i.incidentsTarget.checked=!1;i._commonHandler=new rt(u,i,r,!0,i._clickHandler);n=function(){i.trafficTarget.checked=!0;i.incidentsTarget.checked=!0;sj_evt.unbind("OnLoadTrafficLayerStatus",n)};sj_evt.bind("OnLoadTrafficLayerStatus",n);f=function(){i.trafficTarget.checked=!1;i.incidentsTarget.checked=!1};sj_evt.bind("ClosedTrafficCard",f);sj_evt.fire("TrafficPickerAdded")}),r},r.prototype.onRemove=function(){var t;this._container&&((t=this._commonHandler)===null||t===void 0?void 0:t.dispose());i._clearDisposables(this._disposables);i._nullifyClass(this);n.prototype.onRemove.call(this)},r.prototype.dispose=function(){this.onRemove()},r.prototype.logTraffic=function(n,t){var i=this.map.getStyle().style,r=n?"1":"0";a.log(t,"NC",null,i,r)},r.prototype.callHandler=function(n,t,i,r){var u=this,f={action:t,callBack:function(t){return u.setBoxes(n,t,i,r)}};Microsoft.Maps.GlobalDataEventHandler.invokeHandler("data-traffic",f)},r.prototype.setBoxes=function(n,t,i,r){[i,r].forEach(function(n){n&&(n.checked=t)});sj_evt.fire("TrafficPickerSelected");this.logTraffic(t,n)},r}(atlas.control.ControlBase),li=function(){function n(n,t){this._map=n;this._options=t;this._disposables=[];this._isDisposed=!1}return n.prototype.getOptions=function(){return this._options},n.prototype.dispose=function(){i._clearDisposables(this._disposables);this._map=null;this._options=null;this._isDisposed=!0},n}(),rr=function(t){function i(i){var r=t.call(this,i)||this;return r._startObservingStyleChange=function(){r._disposables.push(f.add(r._map,"stylechanged",function(){r._displayDelayedLayers()}))},r._mapLoaded=function(){if(!n.mockEnabled){var t=window.mapsTilePrimerObj;t===null||t===void 0?void 0:t.unWrap()}r._displayDelayedLayers();r._map.mapLoaded.resolve();ft.log("Maps_VDTTG")},r._updateRasterLayerFadeProperty=function(){var n=r._mapbox.getStyle().layers,t=n.filter(function(n){return n.type==="raster"&&n.id.startsWith("microsoft.bing.maps.")});t.forEach(function(n){r._mapbox.setPaintProperty(n.id,"raster-fade-duration",75)})},r._mapbox=i._getMap(),r._setOptionsForRasterMode(),r._map.mapReady.then(function(){ft.setStartTime("Maps_VDTTG");r._init()}),r._map.mapLoaded.then(function(){r._updateRasterLayerFadeProperty();r._disposables.push(f.add(i,"stylechanged",function(){r._updateSource();f.addOnce(i,"idle",r._updateRasterLayerFadeProperty)}))}),r}return l(i,t),i.prototype._setOptionsForRasterMode=function(){if(h.renderingMode===2){var n=this._mapbox;n.keyboard.disableRotation();n.dragRotate.disable();n.touchZoomRotate.disable();n.setMaxPitch(0);n.scrollZoom.setWheelZoomRate(1);this._disposables.push(f.add(this._map,"moveend",function(){var t=n.getZoom(),i=Math.round(t);t.toFixed(2)!==i.toFixed(2)&&n.setZoom(i)}))}},i.prototype.dispose=function(){t.prototype.dispose.call(this);this._mapbox=null},i.prototype._init=function(){var n=this,t=this._map;f.addOnce(t,"idle",this._mapLoaded);this._map.mapLoaded.then(function(){n._startObservingStyleChange()});this._updateSource()},i.prototype._displayDelayedLayers=function(){var n,i,t;for(this._map.setLayoutProperty("microsoft.bing.maps.base.land","visibility","visible"),n=0,i=this._mapbox.getStyle().layers;n<i.length;n++)t=i[n],t.metadata&&t.metadata.delayLoad&&this._map.setLayoutProperty(t.id,"visibility","visible")},i.prototype._updateSource=function(){var n=this._mapbox.getStyle(),u=(n===null||n===void 0?void 0:n.sources)||{},t,i,r;for(t in u)i=u[t],i.type==="raster"&&i.roundZoom===!1&&(r=this._mapbox.getSource(t),r&&(r.roundZoom=!1))},i}(li),ur=function(){function n(){}return n.prototype.enqueue=function(n){var t={action:n,enqueuePromise:new bt,next:null};return this._head?(this._tail.next=t,this._tail=t):this._head=this._tail=t,this._isExecuting||this._execute(),t.enqueuePromise},n.prototype._execute=function(){var t=this,n=this._head,i;n?(this._isExecuting=!0,i=function(){n.enqueuePromise.resolve();t._head=n.next;t._execute()},n.action().then(i)):this._isExecuting=!1},n}(),vt;(function(n){function t(n){var t;return n&&(t=n.id,typeof t!="number"||isNaN(t)||(t=t+""),t||(t=n.properties.id)),t}var i=function(){function n(n,t){this._id=t;this._mbSource=n&&n.getSource(t);this._internals=new Map}return n.prototype.getId=function(){return this._id},n.prototype.clear=function(){this._internals.clear();this._updateMBSource()},n.prototype.removeByIds=function(n){var i,t,r,u,f;if(n&&(i=Array.isArray(n)?n:[n],i.length>0)){for(t=0,r=i;t<r.length;t++)u=r[t],f=u.trim(),f&&this._internals.delete(u);this._updateMBSource()}},n.prototype.getFeatureById=function(n){var t=null,i=n===null||n===void 0?void 0:n.trim();return i&&(t=this._internals.get(i)),t},n.prototype.getFeatureCollection=function(){var n=Array.from(this._internals.values());return{type:"FeatureCollection",features:n}},n.prototype.addOrUpdate=function(n,i){var f,e,r,o,u,s;if(n&&(i||(i=t),f=Array.isArray(n)?n:[n],f.length>0)){for(e=!1,r=0,o=f;r<o.length;r++)u=o[r],s=u&&i(u),s&&(this._internals.set(s,u),e=!0);e&&this._updateMBSource()}},n.prototype.setFeatures=function(n,t){this._internals.clear();this.addOrUpdate(n,t)},n.prototype.dispose=function(){this._mbSource&&this.clear();this._mbSource=null},n.prototype._updateMBSource=function(){if(this._mbSource){var n=this.getFeatureCollection();this._mbSource.setData(n)}},n}();n.GeoJSONSourceManager=i})(vt||(vt={}));ai=function(){function n(n,t,i){this.handler=n;this._interval=t;this._eventFilter=i;this._nextScheduledEventId=null}return n.prototype.invoke=function(n){var i=this,t;this._isScheduled()?(this._eventFilter&&(n=this._eventFilter(this._nextScheduledEventArgs,n)),this._nextScheduledEventArgs=n):(t=Date.now(),this._lastRaisedTime&&this._lastRaisedTime<t+this._interval?(this._nextScheduledEventArgs=n,this._nextScheduledEventId=y.setTimeout(function(){i._raiseScheduledEvent()},this._lastRaisedTime+this._interval-t)):(this.handler(n),this._lastRaisedTime=t))},n.prototype.dispose=function(){this._clearScheduledEvent()},n.prototype._raiseScheduledEvent=function(){this.handler(this._nextScheduledEventArgs);this._lastRaisedTime=Date.now();this._clearScheduledEvent()},n.prototype._isScheduled=function(){return this._nextScheduledEventId!==null},n.prototype._clearScheduledEvent=function(){this._isScheduled()&&(clearTimeout(this._nextScheduledEventId),this._nextScheduledEventId=null)},n}();k=function(){function n(){this.reset()}return n.prototype.add=function(n,t){var i=this;return t===void 0&&(t=!1),t?this._handlers.splice(0,0,n):this._handlers.push(n),{dispose:function(){return i.remove(n)}}},n.prototype.addOne=function(n,t,i){if(t===void 0&&(t=!1),i===void 0&&(i=!1),i&&this.isPreviouslyInvoked)return n(this.lastInvokedArgs),null;var r=this.add(function(t){r.dispose();n(t)},t);return r},n.prototype.addThrottled=function(n,t,i){var r=this;return this._throttledEventInvokers.push(new ai(n,t,i)),{dispose:function(){return r._removeThrottledEventHandler(n)}}},n.prototype.remove=function(n){for(var t=this._handlers.length;t--;)if(this._handlers[t]===n){this._handlers.splice(t,1);return}},n.prototype.invoke=function(n){var f,t,r,e,o,i,u,s;for(this.lastInvokedArgs=n,this.isPreviouslyInvoked=!0,f=this._handlers.slice(0),t=0,r=f;t<r.length;t++)e=r[t],e(n);for(o=this._throttledEventInvokers.slice(0),i=0,u=o;i<u.length;i++)s=u[i],s.invoke(n)},n.prototype.hasHandlersRegistered=function(){return this._handlers.length+this._throttledEventInvokers.length>0},n.prototype.isHandlerRegistered=function(n){return this._handlers.some(function(t){return n===t})||this._throttledEventInvokers.some(function(t){return n===t.handler})},n.prototype.dispose=function(){this._handlers=[];i._clearDisposables(this._throttledEventInvokers);this.lastInvokedArgs=null},n.prototype.reset=function(){this._throttledEventInvokers?i._clearDisposables(this._throttledEventInvokers):this._throttledEventInvokers=[];this._handlers=[];this.isPreviouslyInvoked=!1;this.lastInvokedArgs=null},n.prototype._removeThrottledEventHandler=function(n){for(var t=this._throttledEventInvokers.length;t--;)if(this._throttledEventInvokers[t].handler===n){this._throttledEventInvokers[t].dispose();this._throttledEventInvokers.splice(t,1);return}},n}(),function(n){function u(t,i,r,u){return typeof u!="number"&&(u=512),n.getZoomFromMetersPerPixel(r?0:t[1],i,u)}function f(i,r,u,f){var e;return f===void 0&&(f=256),e=n.latlongToPixelXY(i[1],i[0],r,f),u&&(e.x+=u.x,e.y+=u.y),t(e)}function t(n,t){t===void 0&&(t=256);var i=Math.floor(n.x/t),r=Math.floor(n.y/t);return{x:i,y:r}}function e(n,t){t===void 0&&(t=256);var i=n.x*t,r=n.y*t;return{x:i,y:r}}function o(n,t,u){u===void 0&&(u=256);var f=r(t,u),e=i._clamp(n.x,0,f-1)/f-.5,o=.5-i._clamp(n.y,0,f-1)/f,s=90-360*Math.atan(Math.exp(-o*2*Math.PI))/Math.PI,h=360*e;return[h,s]}function s(n,t,i){for(var f="",r,u=i;u>0;u--)r=1<<u-1,f+=(n&r?1:0)+(t&r?2:0);return f}function r(n,t){return t===void 0&&(t=256),t<<n}n.fromScale=u;n.tileXYFromLocation=f;n.pixelXYToTileXY=t;n.tileXYToPixelXY=e;n.pixelXYToLatLong=o;n.quadkeyFromTileXY=s;n.mapSizeFromLOD=r}(et||(et={})),function(t){function g(n){v===-1&&(v=y.setTimeout(function(){var t,r,o,n,f;v=-1;var h=Date.now(),e=!1,i=s,c=Object.keys(u);for(t=0,r=c;t<r.length;t++)o=r[t],n=u[o],(n===null||n===void 0?void 0:n.status)===1&&(f=n.timeoutDuration-(h-n.startTime),f<=0?n.abortCallback(null,5):(i=Math.min(i,f),e=!0));e&&g(i)},Math.max(ut,n)))}function ot(n){var i=n.toLowerCase(),t=n;return r.ClientApi&&r.ClientApi.length>0&&(i.indexOf("dev.virtualearth.net/rest")>-1||i.indexOf("dev.ditu.live.com/rest")>-1)&&(t+=n.indexOf("?")>-1?"&":"?",t+="clientApi="+encodeURIComponent(r.ClientApi)),t}function l(n,t){return n+b+t}function st(n){var i,r,t;return n&&(t=n.toString().split(b),t.length===1?i=t[0]:(r=t[0],i=t[1])),{requestId:i,callbackId:r}}function h(t){var i=n.dynamicProperties;return t.replace("{srcparam}",n.tileSourceParam?"&src=".concat(n.tileSourceParam):"").replace("{credentials}",i.sessionKey).replace("{cmnPltParam}",n.platformCommonParam)}function nt(n,t,i){var u=r.logger,f;n=n||{};u&&(i||n.status===3||n.status===5)&&(f={feature:"NW",action:"ERR",data:{httpStatus:""+(t||""),status:""+n.status,cid:n.callerId||"",url:n.url||"",msg:i||""}},u.logCriticalError(null,f))}function f(n,t,i,r){var f=u[t],v,e,y,tt,c,p,w,h,a,b,s;if(!f||f.status===4&&f.isJsonpRequest){o[t]===t&&(v="XsrPrefetchCallback",o[v]?o[v](n,t):o[t]=n);delete u[t];return}f.abortCallback=null;f.status=r||2;f.scriptElement&&f.scriptElement.parentNode&&f.scriptElement.parentNode.removeChild(f.scriptElement);f.scriptElement=null;t!==f.url&&(f.status===4&&f.isJsonpRequest||delete u[t]);delete u[f.url];e=f.status===2;e&&typeof i!="undefined"&&(e=i>=200&&i<300,e||(f.status=3));e&&f.parseResponseCallback&&i!==204&&(y=f.parseResponseCallback(n),e=y.succeeded,e||(f.status=3),n=y.response);var k=f.successCallbacks,d=f.callbackStates,g=f.errorCallbacks;if(f.successCallbacks={},f.callbackStates={},f.errorCallbacks={},e)try{for(f.logKey&&(tt=Date.now()-f.startTime,ft.record(f.logKey,tt)),h=Object.keys(k),c=0,p=h;c<p.length;c++)s=p[c],w=k[s],w&&w(n,d[s])}catch(l){if(Microsoft.Maps.logger)Microsoft.Maps.logger.logCriticalError(l);else throw l;}else try{for(nt(f,i),h=Object.keys(g),a=0,b=h;a<b.length;a++)s=b[a],g[s](d[s],f.status)}catch(l){if(Microsoft.Maps.logger)Microsoft.Maps.logger.logCriticalError(l);else throw l;}}function ht(n,t){f(t,n)}function tt(n,t,i,r,u){var e=d(),h=null,s,o,c;if(n.abortCallback=function(n,t){h=t;e.abort()},e.onreadystatechange=function(){if(u&&u(e),e.readyState===4&&e.status!==0){var t=e.response||e.responseText;f(t,n.sourceUrl,e.status,2)}},e.onabort=function(){return f(null,n.sourceUrl,null,h)},e.open("GET",n.url),r&&(e.withCredentials=!0),i)for(s=Object.keys(i),o=0,c=s.length;o<c;o++)e.setRequestHeader(s[o],i[s[o]]);return t&&(e.responseType=t),e}function ct(n,t,i){var r=new AbortController,u={method:"GET",headers:t,credentials:i?"include":"same-origin",signal:r.signal};return n.abortCallback=function(n,t){r.abort(t)},new Request(n.url,u)}function lt(n){for(var t=parseInt(i._getHash(n),16),r=u[t.toString(16)];r&&r.sourceUrl!==n;)t++,r=u[t.toString(16)];return t.toString(16)}function a(t,i,r,f,e,o,h,c,l,a,v,y,p){i=ot(i);var w=u[i];return g(s),w||(w={sourceUrl:t,url:i,status:0,successCallbacks:{},errorCallbacks:{},parseResponseCallback:o,callbackStates:{},jsonso:v,callerId:c,startTime:Date.now(),timeoutDuration:a,logKey:y,referrerPolicy:p,isJsonpRequest:!!v},v&&(u[v]=w),u[i]=w),w.successCallbacks[l]=r,f&&(w.errorCallbacks[l]=f),h&&(w.callbackStates[l]=h),w.status===0&&(w.status=1,e(w),n.testHooksEnabled&&console.log("Network request: ".concat(w.url))),w}function at(n,t,i,r,e,o,v,y){n=h(n);var p=(c++).toString(),w=l(p,n),b=function(n){var t=tt(n,r?r:"text",null,null,v);t.send()};return a(n,n,i,e,b,null,o,t,p,s,null,y),u[n].abortCallback=function(t,i){f(null,n,null,i)},w}function vt(n,t,i,r,u,e){n=h(n);var o=(c++).toString(),v=l(o,n),y=function(n){var t=ct(n);fetch(t).then(function(t){f(t,n.sourceUrl,t.status,2)}).catch(function(){var i=t.signal,r=i.aborted?i.reason:3;f(null,n.sourceUrl,null,r)})};return a(n,n,i,r,y,null,u,t,o,s,null,e),v}function yt(n,t,i,r,e,o,v,y,p,w){var b,k,d,g;return y===void 0&&(y=!0),n=h(n),b=(c++).toString(),k=l(b,n),p=p||{},y&&!p["Content-Type"]&&(p["Content-Type"]="application/json; charset=utf-8"),d=function(n){var t=tt(n,null,p,o);t.send()},g=function(n){var t={succeeded:!1};try{t.response=JSON.parse(n);t.succeeded=!0}catch(i){}return t},a(n,n,i,r,d,g,e,t,b,s,null,w),u[n].abortCallback=function(t,i){f(null,n,null,i)},k}function pt(n,i,r,v,y,b,d,g,tt,ut){var kt,ft,at,vt,yt,ot,st,dt,gt,ht,pt;n=h(n);var ct=!0,wt=(c++).toString(),bt=n;return y=y||lt(bt),kt=l(wt,y),n.indexOf(w)<0&&(ct=!1),at=!1,/\{jsonso}/ig.test(n)?(ft=b?rt:k,n=n.replace(/\{jsonso}/ig,y)):n.indexOf(p)>=0?(vt=n.indexOf(p),vt>=0&&(ot=n.indexOf("&",vt),ot<0&&(ot=n.length),st=vt+p.length,y=n.substr(st,ot-st))):(ct||(yt=n.indexOf("jsonp="),yt>=0&&(ot=n.indexOf("&",yt),ot<0&&(ot=n.length),st=yt+6,ft=n.substr(st,ot-st))),ft||(ft="f"+y),at=!0),ct&&(dt=it+ft,n=n.replace(w,dt)),gt=function(n){et(n)},ht=a(bt,n,r,v,gt,null,d,i,wt,s,y,tt,ut),at&&(e[y]?e[y]++:e[y]=1,pt=u[y],ct?t.callbacks[ft]=function(n,i,r,u){u!==4&&u!==3&&(e[y]-=Object.keys(pt.successCallbacks).length);f(n,y,r,u);e[y]===0&&(delete t.callbacks[ft],delete e[y])}:o[ft]=function(n,t,i,r){r!==4&&r!==3&&(e[y]-=Object.keys(pt.successCallbacks).length);f(n,y,i,r);e[y]===0&&(delete o[ft],delete e[y])}),ht&&ht===u[y]?ht.abortCallback=function(n,i){var r=o[ft]?o[ft]:t.callbacks[at?ft:k];r&&r(null,y,i===3?500:504,i)}:nt(ht,0,"downloadJsonp mismatch"),kt}function wt(n){var r,t,f,i;n&&(r=st(n),t=u[r.requestId],t&&(f=Object.keys(t.successCallbacks).length,i=r.callbackId,t.successCallbacks[i]&&(f>1?(t.errorCallbacks[i]&&t.errorCallbacks[i](t.callbackStates[i],4),delete t.errorCallbacks[i],delete t.callbackStates[i],delete t.successCallbacks[i]):t.abortCallback&&t.abortCallback(null,4))))}function bt(n,t,i){var f,o,c,e,l,a;n=h(n);var r=d(),v=i.headers||{},u=i.onError||function(){},y=i.onSuccess||function(){},p=n;if(i.queryParameters)for(n.indexOf("?")<0&&(n+="?"),f=0,o=Object.keys(i.queryParameters);f<o.length;f++)c=o[f],n+="&"+encodeURIComponent(c)+"="+encodeURIComponent(i.queryParameters[c]);for(r.open("POST",n,!0),r.timeout=s,r.ontimeout=u,e=0,l=Object.keys(v);e<l.length;e++)a=l[e],r.setRequestHeader(a,v[a]);r.onabort=u;r.onerror=u;r.onreadystatechange=function(){r.readyState===4&&(r.status===200?y(r.responseText):u(r.responseText,r.status,r.statusText))};r.send(t)}var u={},e={},c=0,v=-1,o=window,it=o.$MicrosoftMaps8.toString()+".NetworkCallbacks.",w="{callback}",b="~DispatchKey~",p="jsonso=",k="normal",rt="reverse",s=25e3,ut=1e3,d=function(){var n=null,t=r.Internal.originalXMLHttpRequest;return typeof t!="undefined"?n=new t:typeof ActiveXObject!="undefined"&&(n=new ActiveXObject("Microsoft.XMLHTTP")),n},et=function(n){var t=document.createElement("script");t.type="text/javascript";t.src=n.url;t.async=!0;t.onerror=function(){y.setTimeout(function(){n.abortCallback&&n.abortCallback(null,3)},0)};n.scriptElement=t;n.referrerPolicy&&(t.referrerPolicy=n.referrerPolicy);document.getElementsByTagName("head")[0].appendChild(t)};t.callbacks={normal:f,reverse:ht};t.downloadGeneric=at;t.fetchGeneric=vt;t.downloadJson=yt;t.downloadJsonp=pt;t.abortRequest=wt;t.doPost=bt}(w||(w={}));var fr=function(){function n(){}return n.prototype.toString=function(n,t){var i="",e,o,r,s,u,f;if(this.protocol&&(i+=this.protocol+":",(this.protocol==="http"||this.protocol==="https"||this.protocol==="ftp")&&(i+="//")),this.host&&(i+=this.host),this.port&&(i+=":"+this.port),this.path&&(i+="/"+this.path),this.queryStringParameters)for(e=!0,o=Object.keys(this.queryStringParameters),r=0,s=o.length;r<s;r++)(u=o[r],f=this.queryStringParameters[u],!t||f)&&(e?(i+="?",e=!1):i+="&",i+=n?u+"="+f:encodeURIComponent(u)+"="+encodeURIComponent(f));return this.fragment&&(i+="#"+encodeURI(this.fragment)),i},n.fromString=function(t){var h,f,e,o,c,l,s;if(!t)throw new Error("Input should be a well-formed url");var u=new n,r=t,i=r.split("#");if(i.length>2)throw new Error("More than one fragment is found in the input");if(i.length===2&&(r=i[0],u.fragment=decodeURIComponent(i[1])),i=r.split("?"),i.length>2)throw new Error("More than one query param identifier ('?') is found in the input");if(i.length===2)for(r=i[0],u.queryStringParameters={},h=i[1],i=h.split("&"),f=0;f<i.length;f++)e=i[f],o=e.indexOf("="),o>0&&(c=decodeURIComponent(e.substring(0,o)),l=decodeURIComponent(e.substring(o+1)),u.queryStringParameters[c]=l);if(i=r.split("://"),i.length>2)throw new Error("More than one protocol identifier ('://') is found in the input");if(i.length===2&&(r=i[1],u.protocol=i[0]),i=r.split("/"),i.length>1&&(r=i[0],u.path=i.slice(1).join("/")),r.indexOf("@")>=0)throw new Error("Unsupported url");if(i=r.split(":"),i.length>2)throw new Error("More than one port identifier (':') is found in the input");if(u.host=i[0],i.length===2){if(s=parseInt(i[1]),isNaN(s))throw new Error("port number should be an integer");u.port=s}return u},n.prototype.protocolAndDomain=function(){return(this.protocol+"://"+this.host+(typeof this.port=="undefined"?"":":"+this.port)).toLowerCase()},n}(),yt=function(){function n(n,t){this._capacity=n;this._count=0;this._dictionary={};this._removeCallback=t}return n.prototype.addItem=function(n,t,r){if(t){var u=this._dictionary[n];u?i.areValuesEqual(u.item,t)||(this._dictionary[n].item=t,this._moveNodeToHead(u)):this._addNewItem(n,t,r)}},n.prototype.convertToArray=function(){for(var t=[],n=this._headNode;n;)t.push(n.item),n=n.next;return t},n.prototype.getItem=function(n){var t,i=this._dictionary[n];return i?(t=i.item,this._moveNodeToHead(i)):t=null,t},n.prototype.clear=function(){while(this._count>0)this._deleteTailNode()},n.prototype.getCount=function(){return this._count},n.prototype.getInternalDictionary=function(){return this._dictionary},n.prototype.removeItem=function(n,t){var i=this._dictionary[n];i&&(this._removeNode(i),delete this._dictionary[n],this._count--,t&&this._disposeNode(i))},n.prototype.setCapacity=function(n){var i,t;if(n>0){if(this._capacity>n&&this._count>n)for(i=this._count-n,t=0;t<i;t++)this._deleteTailNode();this._capacity=n}},n.prototype.getCapacity=function(){return this._capacity},n.prototype._addNewItem=function(n,t,i){this._count===this._capacity&&(i?this._capacity++:this._deleteTailNode());var r={key:n,item:t};this._count===0?this._headNode=this._tailNode=r:(r.next=this._headNode,this._headNode.previous=r,this._headNode=r);this._dictionary[n]=r;this._count++},n.prototype._removeNode=function(n){if(this._count===1){this._headNode=null;this._tailNode=null;return}var t=n.previous,i=n.next;t?t.next=i:this._headNode=i;i?i.previous=t:this._tailNode=t},n.prototype._moveNodeToHead=function(n){n!==this._headNode&&(this._removeNode(n),this._headNode&&(this._headNode.previous=n),n.previous=null,n.next=this._headNode,this._headNode=n)},n.prototype._deleteTailNode=function(){if(this._tailNode){var n=this._tailNode;this._removeNode(n);delete this._dictionary[n.key];this._count--;this._disposeNode(n)}},n.prototype._disposeNode=function(n){var t=n.item;this._removeCallback&&this._removeCallback(n.key,n.item);t&&t.dispose&&t.dispose();Array.isArray(t)&&i._clearDisposables(t)},n}(),v=function(){function n(n,t,i){this.x=n;this.y=t;this.z=i}return n.prototype.add=function(t){return this.z&&t.z?new n(this.x+t.x,this.y+t.y,this.z+t.z):new n(this.x+t.x,this.y+t.y)},n.prototype.subtract=function(t){return this.z&&t.z?new n(this.x-t.x,this.y-t.y,this.z-t.z):new n(this.x-t.x,this.y-t.y)},n.prototype.clone=function(){return new n(this.x,this.y,this.z)},n.prototype.equals=function(t,i){return n.pointsEqual(this,t,i)},n.pointsEqual=function(n,t,i){return n&&t?i>0?Math.abs(n.x-t.x)<=i&&Math.abs(n.y-t.y)<=i:n.x===t.x&&n.y===t.y&&n.z===t.z:!1},n.prototype.toString=function(){return typeof this.z=="undefined"?"[Point ("+this.x+", "+this.y+")]":"[Point ("+this.x+", "+this.y+", "+this.z+")]"},n.prototype.scalarMultiply=function(t){return new n(this.x*t,this.y*t,this.z?this.z*t:null)},n.prototype.invert=function(){return new n(-this.x,-this.y,this.z?-this.z:null)},n}(),er=function(n){function t(t,i,r){r===void 0&&(r=1);var u=n.call(this,t,i)||this;return u.units=r,u}return l(t,n),t}(v),i;(function(i){function ut(){return rt++}function ft(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var t=Math.random()*16|0,i=n==="x"?t:t&3|8;return i.toString(16)})}function et(n){var u,i,f,s,r,e,o,t;if(n)if(Array.isArray(n)){for(u=n,i=0,f=u;i<f.length;i++)t=f[i],t&&t.dispose&&t.dispose();u.length=0}else for(s=Object.keys(n),r=0,e=s;r<e.length;r++)o=e[r],t=n[o],t&&t.dispose&&t.dispose(),delete n[o]}function ot(n){var u,i,r,t;if(n)for(u=Object.keys(n),i=0,r=u;i<r.length;i++)t=r[i],n[t]instanceof k&&(n[t].dispose&&n[t].dispose(),delete n[t])}function y(n){return typeof Array.isArray=="function"?Array.isArray(n):Object.prototype.toString.call(n)==="[object Array]"}function ht(n){var e,t,u,i,r,f;if(n)for(e=Object.keys(n),t=0,u=e;t<u.length;t++)i=u[t],r=n[i],r&&(f=typeof r,f!=="function"&&(y(r)?n[i]=[]:f==="object"&&(n[i]=null)))}function lt(n,t){return typeof n=="number"&&isFinite(n)||(n=t),n}function at(n,t,i){return Math.min(Math.max(n,t),i)}function l(t,i){return t.toFixed(i).replace(".",n.dynamicProperties.cultureData.numberDecimalSeparator)}function w(n,t,i){i===void 0&&(i=!0);var u=typeof n=="string"?new URL(n):new URL(n.href),r=u.searchParams.get(t)||"";return i?decodeURIComponent(r):r}function vt(){var n=parseFloat(w(window.location,"dpr"));return n||window.devicePixelRatio||1}function yt(n){for(var r=0,t=0,i=0;i<n.length;i++)r+=n.charCodeAt(i)<<t,t++,t>6&&(t=0);return r.toString(16)}function pt(n,t){if(n===t)return!0;if(!n||!t||n.length!==t.length)return!1;for(var i=n.length-1;i>=0;){if(n[i]!==t[i])return!1;--i}return!0}function o(n,t,i){var u,a,f,e,s,c,h,l,r;if(n===t)return!0;if(typeof n!=typeof t)return!1;if(Array.isArray(n)&&Array.isArray(t)){if(n.length||t.length){if(n.length!==t.length)return!1}else return!0;for(u=0,a=n.length;u<a;u++)if(!o(n[u],t[u],i))return!1;return!0}if(typeof n=="object"&&n&&t&&n.constructor===Object&&t.constructor===Object){for(f=n,e=t,s=0,c=Object.keys(f);s<c.length;s++)if((r=c[s],!i||!(i.indexOf(r)>=0))&&!o(f[r],e[r],i))return!1;for(h=0,l=Object.keys(e);h<l.length;h++)if((r=l[h],!i||!(i.indexOf(r)>=0))&&!o(f[r],e[r],i))return!1;return!0}return n===t}function wt(n,t,i,r){return r=r||0,n&&t&&Math.abs(n.latitude-t.latitude)<=r&&Math.abs(n.longitude-t.longitude)<=r&&(i||n.altitudeReference===-1&&t.altitudeReference===-1||n.altitudeReference===t.altitudeReference&&Math.abs(n.altitude-t.altitude)<=r)}function bt(n,t){return n&&n.length===4?t===1?[n[1],n[2],n[3],n[0]]:[n[3],n[0],n[1],n[2]]:n}function kt(n){var i=n,t;return n&&(t=document.createElement("textarea"),t.innerHTML=n,i=t.value),i}function dt(n){return n.replace("{tfeDomainDynamic}",u.tfeDomainDynamic).replace("{tfeDomainStatic}",u.tfeDomainStatic)}function gt(){function n(){return((1+Math.random())*65536|0).toString(16).substr(1)}return n()+n()+"-"+n()+"-"+n()+"-"+n()+"-"+n()+n()+n()}function ni(t){return n&&n.features[t]&&n.features[t].isEnabled}function ti(n){var t=n.charAt(n.length-1),i=parseInt(t)%2;return isNaN(i)||(t=i.toString()),t}function ri(n){for(var i,r={},u=n,e=r,t=0,f=Object.keys(u);t<f.length;t++)i=f[t],e[i]=u[i];return r}function ui(n,t){if(t){var i=1/t;n=Math.round(n*i)/i}return n}function si(n){var r,t=u.mapStyleDefinition,i;return t&&(n==="v"?n="a":n==="x"&&(n="r"),i=t.styles.find(function(t){return t.styleKey===n}),r=i?i.name:t.defaultStyle),r}function d(n){var r,t=u.mapStyleDefinition,i;return t&&(i=t.styles.find(function(t){return t.name===n}),r=i?i.styleKey:d(t.defaultStyle)),r}function g(n,t){return n[t]}function nt(n,t,i,r){var f,o;r===void 0&&(r=g);for(var s=r(t,i),u=0,e=n.length;e>u;)f=(u+e)/2|0,o=r(n[f],i),o<=s?u=f+1:e=f;return u}function ci(n,t,i,r){r===void 0&&(r=g);var u=nt(n,t,i,r);return n.splice(u,0,t),u}function f(n){for(var t,i,f=[],r=1;r<arguments.length;r++)f[r-1]=arguments[r];if(n&&f){var e=/\d+/g,u=n.match(/{\d+}/g);if(u)for(t=0;t<u.length;t++)i=f[Number(u[t].match(e)[0])],(i===null||typeof i=="undefined")&&(i=""),n=n.replace(u[t],i)}return n}function c(n,t,i){var r=t+t;return n.indexOf(r)<0?n.replace(t,i):n.replace(r,(i<10?"0":"")+i)}function li(t,i,r,u,f){var o=n.dynamicProperties.cultureData,e,c,s,h;switch(t){case"d":i>3?e=o.dayNames[u?r.getUTCDay():r.getDay()]:i===3?e=o.abbreviatedDayNames[u?r.getUTCDay():r.getDay()]:(c=u?r.getUTCDate():r.getDate(),e=(c<10&&i>1?"0":"")+c);break;case"M":s=u?r.getUTCMonth():r.getMonth();i>3?(o.monthGenitiveNames&&!f&&(e=o.monthGenitiveNames[s]),e&&e.length||(e=o.monthNames[s])):i===3?(o.abbreviatedMonthGenitiveNames&&!f&&(e=o.abbreviatedMonthGenitiveNames[s]),e&&e.length||(e=o.abbreviatedMonthNames[s])):(++s,e=(s<10&&i>1?"0":"")+s);break;case"y":h=u?r.getUTCFullYear():r.getFullYear();i>2?e=h.toString():(h%=100,e=(h<10&&i>1?"0":"")+h);break;default:e=""}return e}function e(t,i,r,u){for(var e,v=n.dynamicProperties.cultureData,o=[],s=-1,h=i.length,f=0;f<h;f++){var l=i.charAt(f),c="'/dMyg".indexOf(l),a=c>=0;if(s<0&&!a&&(s=f),s>=0&&(a||f===h-1)&&(o.push(i.substring(s,a?f:f+1)),s=-1),c===0){for(e=f+1;e<h&&i.charAt(e)!=="'";e++);o.push(i.substring(f+1,e));f=e}else if(c===1)o.push(v.dateSeparator);else if(c>1){for(e=f+1;e<h&&i.charAt(e)===l;e++);o.push(li(l,e-f,t,r,u));f=e-1}}return o.join("")}function ai(t,i){return e(t,n.dynamicProperties.cultureData.shortDatePattern,i)}function vi(t){return e(t,n.dynamicProperties.cultureData.longDatePattern)}function yi(t){var i=n.dynamicProperties.cultureData.longDatePattern;return i=i.replace("dddd","ddd"),i=i.replace("MMMM","MMM"),e(t,i)}function pi(t){return e(t,n.dynamicProperties.cultureData.yearMonthPattern,!1,!0)}function wi(t){return e(t,n.dynamicProperties.cultureData.weekMonthDayPattern)}function bi(n,i){i===void 0&&(i=!1);var e=i?Math.ceil(n/60):Math.round(n/60),r=e%60,u=Math.floor(e/60);return u===0?f(t.L_Duration_Min,r):r===0?f(t.L_Duration_NoMin,u):f(t.L_Duration,u,r)}function ki(n){return n>12?n-=12:n||(n=12),n}function a(t,i,r){var f=n.dynamicProperties.cultureData,e,o,u=f.shortTimePattern,s=u.indexOf("H")<0;return s?(o=t>=12,t=ki(t),e="h"):e="H",u=c(u,e,t),u=c(u,"m",i),u=c(u,"s",r),s&&(u=u.replace("tt",o?f.pmDesignator:f.amDesignator)),u.replace(/:/g,f.timeSeparator)}function di(n){return a(n.getHours(),n.getMinutes(),n.getSeconds())}function tt(n){return a(n.getUTCHours(),n.getUTCMinutes(),n.getUTCSeconds())}function it(n){var t=n&&n.match(/\((\d+)([-,+]?)(\d{2})?(\d{2})?\)/),i;if(t&&t[1]&&(i=parseInt(t[1],10),t[2]&&t[3]&&t[4])){var f=t[2]==="-"?-1:1,r=parseInt(t[3],10),u=parseInt(t[4],10);isNaN(r)||isNaN(u)||(i+=f*(r*60+u)*6e4)}return i}function gi(n){return tt(new Date(it(n)))}function nr(){return typeof _G!="undefined"}function tr(){return typeof _G=="object"&&_G&&_G.RTL}function ir(n){for(var t=n&&n.lastChild;t;)n.removeChild(t),t=n.lastChild}function rr(n,t){if(n&&n!==16777215&&n!==4294967295){for(var i=n.toString(16);i.length<6;)i="0"+i;return i.length===8&&(i=i.substr(2)),"#"+i}return t||""}function ur(n){var t=(n&16711680)>>16,i=(n&65280)>>8,r=n&255;return(t*.299+i*.587+r*.114)/256}function fr(r,u,e,o){var s,h=1,c=r>=50&&e;return r=r&&c?Math.round(r):r,u?r<.1?(r*=1e3,s=t.L_DistanceUnitMeters_Text,h=0):s=t.L_DistanceUnitKm_Text:r<.1?(r*=5280,s=t.L_DistanceUnitFeetShort_Text,h=0):s=n.features.directions.bestModeEnabled&&o?t.L_DistanceUnitMilesLongText_Text:t.L_DistanceUnitMilesShortText_Text,f(t.L_Distance_Format,i._toFixed(r,c?0:h),s)}function er(n,i){return f(t.L_LatLon_Format,l(n,6),l(i,6))}function or(n,t,r,u){var h,e,o;r===void 0&&(r=2e3);u===void 0&&(u=1200);var c=225,l=parseInt(i._getUrlParam(window.location,"v9maxDuration"));u=l?l:u;h=parseInt(i._getUrlParam(window.location,"v9velocity"));r=h?h:r;e=Math.abs(n.bearing-t.bearing);e=isNaN(e)?0:e;o=Math.abs(n.zoom-t.zoom);o=isNaN(o)?0:o;var a=Math.min(n.zoom,t.zoom),v=s(s({},n),{zoom:a}),y=s(s({},t),{zoom:a}),p=v.center&&y.center?i.pixelDistance(v,y):0,w=p+o*500+e*4,f=w/r*1e3;return f?f>u?{type:"fly",duration:u}:(f<c&&(f=Math.min(f*10,c)),{type:"ease",duration:f}):{type:"jump"}}function sr(n,t){var i=ct.mercatorPositionsToPixels([n.center],n.zoom)[0],r=ct.mercatorPositionsToPixels([t.center],t.zoom)[0],u=Math.pow(b.getX(i)-b.getX(r),2)+Math.pow(b.getY(i)-b.getY(r),2);return Math.sqrt(u)}function hr(n,t,i){var r=n.positionsToPixels([t.center,i.center]),u=r[0],f=r[1],e=Math.pow(b.getX(u)-b.getX(f),2)+Math.pow(b.getY(u)-b.getY(f),2);return Math.sqrt(e)}function cr(n,t){var i,r,u;if(typeof n!="string"||typeof t!="string")return NaN;var o=n.split("."),s=t.split("."),f=o.length,e=s.length;if(!f||!e)return NaN;for(i=0;i<f;i++){if(e===i)return 1;if(r=parseInt(o[i],10),u=parseInt(s[i],10),isNaN(r)||isNaN(u))return NaN;if(r!==u)return r>u?1:-1}return f!==e?-1:0}function lr(n){var t,i,r;return n&&(t=n.split(","),t.length===2&&(i=parseFloat(t[0]),r=parseFloat(t[1]),isFinite(i)&&isFinite(r)))?p.Position.fromLatLng(r,i):null}function ar(n,t){return t===1?n-1:n+1}function v(n){function u(n){return n&&typeof n=="object"&&!Array.isArray(n)}for(var f,h,e,s,t,o,i=[],r=1;r<arguments.length;r++)i[r-1]=arguments[r];if(!i.length||!u(n))return n;if(f=i.shift(),u(f))for(h=Object.keys(f),e=0,s=h;e<s.length;e++)t=s[e],o=f[t],u(o)?(u(n[t])||(n[t]={}),v(n[t],o)):n[t]=o;return v.apply(void 0,st([n],i,!1))}function vr(n){var t=u.mapStyleDefinition||n.getServiceOptions().styleSet,i=n.getStyle().style.toLowerCase();return t.styles.find(function(n){return n.name.toLowerCase()===i})||t.styles.find(function(n){var t;return n.name.toLowerCase()===((t=u.mapStyleDefinition)===null||t===void 0?void 0:t.defaultStyle.toLowerCase())})}function yr(n,t){var r=document.createElement("canvas"),i=r.getContext("2d");return i.font=t,i.measureText(n).width}function pr(n){var t=r.TrafficExperiences;t&&t.logMsnCfv(n)}function wr(n,t,i){var r;return function(){for(var e,o,f=[],u=0;u<arguments.length;u++)f[u]=arguments[u];e=function(){r=undefined;i||n.apply(void 0,f)};o=i&&!r;clearTimeout(r);r=setTimeout(e,t);o&&n.apply(void 0,f)}}function br(){var t;return n.isMapsAnswer&&!((t=n.dynamicProperties)===null||t===void 0?void 0:t.isMapsOverlay)}function kr(){var t;return n.isMapsAnswer&&((t=n.dynamicProperties)===null||t===void 0?void 0:t.isMapsOverlay)||!1}function dr(t,i,r,f,e){var a,v;t===void 0&&(t=!0);i===void 0&&(i=!0);r===void 0&&(r="all");f===void 0&&(f="list");e===void 0&&(e=null);var o=n.enableDarkMode?atlas.ControlStyle.dark:atlas.ControlStyle.light,c=atlas.control,l={mapStyles:r,layout:f,autoSelectionMode:n.isSDK,style:o},s=[];i&&(a=u.bingStylePicker?new hi(e,l):new c.StyleControl(l),s.push(a));t&&(v=new ii({style:o,geochain:"expanded"}),s.push(v));var y=u.bingStylePicker?fi:c.CompassControl,p=u.bingStylePicker?ei:c.PitchControl,w=u.bingStylePicker?oi:c.ZoomControl;return s.push(new w({style:o,zoomDelta:1})),h.renderingMode!==2&&s.push(new y({style:o,rotationDegreesDelta:15}),new p({style:o,pitchDegreesDelta:10})),s}function gr(){return window.location.pathname.startsWith("/maps/commute")}var rt=0;i._nextId=ut;i._createUUID=ft;i._clearDisposables=et;i._disposeEvents=ot;i._isArray=y;i._nullifyClass=ht;i._getFinite=lt;i._clamp=at;i._toFixed=l;i._getUrlParam=w;i._getDpr=vt;i._getHash=yt;i.areArraysEqual=pt;i.areValuesEqual=o;i.areLocationsEqual=wt;i.convertMapBoundsOrder=bt;i._decodeHTML=kt;i._updateTfeUrlDomain=dt;i._generateRandomKey=gt;i._isFeatureEnabled=ni;i._getTileSubDomain=ti;i._copyObject=ri;i.roundToInterval=ui;i.getAzureMapStyleFromMapType=si;i.getMapTypeFromMapStyle=d;i._getInsertionIndex=nt;i._orderedInsert=ci;i._formatString=f;i._format2Digit=c;i._formatShortDateString=ai;i._formatLongDateString=vi;i._formatAbbrevLongDateString=yi;i._formatYearMonthString=pi;i._formatWeekMonthDayString=wi;i._formatDurationString=bi;i._formatShortTimeString=a;i._formatTimeString=di;i._formatUTCTimeString=tt;i._getTime=it;i._getTimeString=gi;i._hasBingHeaders=nr;i._isRtl=tr;i.clearElement=ir;i._formatHexColorString=rr;i._calcLuminance=ur;i._formatDistanceString=fr;i._formatLatLonString=er;i.computeAnimation=or;i.pixelDistance=sr;i.screenPixelDistance=hr;i.compareVersions=cr;i.parseLatLong=lr;i.convertZoom=ar;i.mergeDeep=v;i.getMapStyle=vr;i.getTextWidth=yr;i.logMsnCfv=pr;i.debounce=wr;i._isSmallMapShownOnSerp=br;i._isMapsOverlay=kr;i.constructCommonControls=dr;i._isCommuteDashboardPage=gr;i._commuteDashboardTabStartClassName="commuteDashboardTabStart"})(i||(i={}));vi=function(){function n(n,t){this.minPoint=n;this.maxPoint=t}return n.empty=function(){return new n(null,null)},n.fromPoints=function(){for(var e,c,r,l=[],u=0;u<arguments.length;u++)l[u]=arguments[u];var h=(i._isArray(arguments[0])?arguments[0]:arguments)||[],t=Number.MAX_VALUE,f=t,o=-t,s=-f;for(e=0,c=h.length;e<c;e++)(r=h[e],r)&&(t=Math.min(t,r.x),f=Math.min(f,r.y),o=Math.max(o,r.x),s=Math.max(s,r.y));return t===Number.MAX_VALUE?n.empty():new n(new v(t,f),new v(o,s))},n.fromSides=function(t,i,r,u){var f=Math.min(t,i),e=Math.max(t,i),o=Math.min(r,u),s=Math.max(r,u),h=new v(f,o),c=new v(e,s);return new n(h,c)},n.prototype.clone=function(){var t=this.minPoint&&this.minPoint.clone(),i=this.maxPoint&&this.maxPoint.clone();return new n(t,i)},n.prototype.equals=function(n,t){if(n){var i=this.isEmpty(),r=n.isEmpty();return i&&r?!0:i||r?!1:t>0?this.minPoint.equals(n.minPoint,t)&&this.maxPoint.equals(n.maxPoint,t):this.minPoint.equals(n.minPoint)&&this.maxPoint.equals(n.maxPoint)}return!1},n.prototype.getCorners=function(){var n=this.minPoint.x,t=this.maxPoint.x,i=this.minPoint.y,r=this.maxPoint.y;return[new v(n,i),new v(t,i),new v(t,r),new v(n,r)]},n.prototype.getSize=function(){return this.isEmpty()?new wt(0,0):new wt(this.maxPoint.x-this.minPoint.x,this.maxPoint.y-this.minPoint.y)},n.prototype.getCenter=function(){return this.isEmpty()?null:{x:(this.minPoint.x+this.maxPoint.x)/2,y:(this.minPoint.y+this.maxPoint.y)/2}},n.prototype.buffer=function(n,t){this.minPoint.x=this.minPoint.x-n;this.minPoint.y=this.minPoint.y-t;this.maxPoint.x=this.maxPoint.x+n;this.maxPoint.y=this.maxPoint.y+t;var i;this.minPoint.x>this.maxPoint.x&&(i=this.minPoint.x,this.minPoint.x=this.maxPoint.x,this.maxPoint.x=i);this.minPoint.y>this.maxPoint.y&&(i=this.minPoint.y,this.minPoint.y=this.maxPoint.y,this.maxPoint.y=i)},n.prototype.intersect=function(n){return this.intersects(n)?(this.minPoint=new v(Math.max(this.minPoint.x,n.minPoint.x),Math.max(this.minPoint.y,n.minPoint.y)),this.maxPoint=new v(Math.min(this.maxPoint.x,n.maxPoint.x),Math.min(this.maxPoint.y,n.maxPoint.y))):this.minPoint=this.maxPoint=null,this},n.prototype.intersects=function(n){return!this.isEmpty()&&!n.isEmpty()&&this.minPoint.x<=n.maxPoint.x&&this.minPoint.y<=n.maxPoint.y&&this.maxPoint.x>=n.minPoint.x&&this.maxPoint.y>=n.minPoint.y},n.prototype.isEmpty=function(){return!this.minPoint||!this.maxPoint},n.prototype.isInside=function(n){return!this.isEmpty()&&!n.isEmpty()&&this.minPoint.x>=n.minPoint.x&&this.minPoint.y>=n.minPoint.y&&this.maxPoint.x<=n.maxPoint.x&&this.maxPoint.y<=n.maxPoint.y},n.prototype.pointInRect=function(n){return!this.isEmpty()&&n.x>=this.minPoint.x&&n.x<=this.maxPoint.x&&n.y>=this.minPoint.y&&n.y<=this.maxPoint.y},n.prototype.union=function(n){return n.isEmpty()||(this.isEmpty()?(this.minPoint=n.minPoint.clone(),this.maxPoint=n.maxPoint.clone()):(this.minPoint.x=Math.min(this.minPoint.x,n.minPoint.x),this.minPoint.y=Math.min(this.minPoint.y,n.minPoint.y),this.maxPoint.x=Math.max(this.maxPoint.x,n.maxPoint.x),this.maxPoint.y=Math.max(this.maxPoint.y,n.maxPoint.y))),this},n.prototype.unionPoint=function(n){return this.isEmpty()?(this.minPoint=n.clone(),this.maxPoint=n.clone()):(this.minPoint.x=Math.min(this.minPoint.x,n.x),this.minPoint.y=Math.min(this.minPoint.y,n.y),this.maxPoint.x=Math.max(this.maxPoint.x,n.x),this.maxPoint.y=Math.max(this.maxPoint.y,n.y)),this},n}(),function(n){function t(t,i){var u=n,o,r,f,e;for(u[t]||(u[t]={}),o=u[t],r=0,f=Object.keys(i);r<f.length;r++)e=f[r],o[e]=i[e]}n.init=t,function(){var i=r.ResourcesObject,n,u,f;if(i){for(n=0,u=Object.keys(i);n<u.length;n++)f=u[n],t(f,i[f]);delete r.ResourcesObject}}()}(pt||(pt={}));var or=pt,wt=function(){function n(n,t){this.width=n;this.height=t}return n.Auto=new n(-1,-1),n}(),d,yi=function(){function t(n){this._reverseGeocoder=n}return t.prototype.getGeochain=function(i,r,u,f,e){var a=this,o;if(i&&!n.disableReverseGeocode){u||(u=i.getCamera().center);f||(o=i.getCamera().bounds,f=c.fromEdges(o[0],o[3],o[2],o[1]));var s="".concat(u[0],",").concat(u[1]),h=function(n){a._reverseGeocoderCallback(s,i,n,f,r,e)},l=t._revGeocoderCache.getItem(s);l?h(l):this._reverseGeocoder.reverseGeocode(u,h,t._geochainEntityTypes,!0,1)}},t._getBoundingBox=function(t,i,r){var u=ut.boundingBoxRequestUrlFormat.replace("{session_key}",n.dynamicProperties.sessionKey).replace("{culture}",n.dynamicProperties.market).replace("{query}",t);w.downloadJsonp(u,"geochain",r,null,null,null,i,3)},t.prototype._reverseGeocoderCallback=function(n,i,r,u,f,e){var p=this,o,s,l,a,h;if(r.success){if(t._revGeocoderCache.addItem(n,r),o=t._parseReverseGeocoderResponse(r,e),!o){console.warn("reverseGeoCoder returned no path",r);f([]);return}var w=e?o.neighborhood:null,b=e?t._geochainLevelZoomLimits.city:null,v=t._generateBoundsQueries(o),y=v.length,c=function(n){if(n===void 0&&(n=!0),n&&y--,y===0){var t=p._constructGeochainFromBounds(i,u,o,b);f(t,w)}},k="ValidCredentials",d=200,g=function(n,i){if(n&&n.authenticationResultCode===k&&n.statusCode===d&&n.resourceSets&&n.resourceSets.length>0&&n.resourceSets[0].resources&&n.resourceSets[0].resources.length>0){var r=n.resourceSets[0].resources[0];i&&r.bbox&&t._boundsResultCache.addItem(i,r.bbox);c()}};for(c(!1),s=0,l=v;s<l.length;s++){if(a=l[s],h=a.id,!h||t._boundsResultCache.getItem(h)){c();continue}t._getBoundingBox(a.query,h,g)}}else throw new Error("".concat(t.geocodingErrorPrefix," code:").concat(r.statusCode,", msg:").concat(r.errorMessage));},t._parseReverseGeocoderResponse=function(n,t){var o=n.results?n.results.length:0,i,u,f,r,e;if(o===0)return null;for(i={},u=0;u<o;u++)if(r=n.results[u].address,e=n.results[u].entityType,e!=="Neighborhood"){i.country=r.countryRegion;i.countryEntityId=r.countryRegionEntityId;i.state=r.adminDistrict;i.stateEntityId=r.adminDistrictEntityId;i.county=r.adminDistrict2;i.countyEntityId=r.adminDistrict2EntityId;i.city=r.locality;i.cityEntityId=r.localityEntityId;i.street=r.addressLine;i.streetEntityId=r.addressLineEntityId;break}for(f=0;f<o;f++)if(r=n.results[f].address,e=n.results[f].entityType,e==="Neighborhood"){i.country=r.countryRegion;i.countryEntityId=r.countryRegionEntityId;i.state=r.adminDistrict;i.stateEntityId=r.adminDistrictEntityId;t?(i.city=r.locality,i.cityEntityId=r.localityEntityId):(i.county=r.adminDistrict2,i.countyEntityId=r.adminDistrict2EntityId);i.neighborhood=r.neighborhood;i.neighborhoodEntityId=r.neighborhoodEntityId;break}return i},t._generateBoundsQueries=function(n){var i=[],t="",r,u,f;return n.country&&(t+="&countryRegion="+n.country,r=t,i.push({query:r,id:n.countryEntityId}),n.state&&(t+="&adminDistrict="+n.state,u=t,i.push({query:u,id:n.stateEntityId}),n.county&&n.city&&(t+="&adminDistrict2="+n.county+"&locality="+n.city,f=t,i.push({query:f,id:n.cityEntityId})))),i},t.prototype._constructGeochainFromBounds=function(n,i,r,u){var e=u||n.getCamera().zoom,l=[],o,f,a,h,s;if(typeof e!="number"||isNaN(e))return l;for(e=Math.ceil(e),o=-1,f=0;f<t._geochainLevels.length;f++){var s=t._geochainLevels[f],c=null,v=r[s+"EntityId"];if(v&&(c=t._boundsResultCache.getItem(v)),c)if(t._canFitViewport(c,i)){t._comparableToViewport(c,i)&&(o=f);break}else o=f;else if(a=t._geochainLevelZoomLimits[s],a>=e){if(a<e+2){o=f;break}}else o=f}for(h=0;h<=o;h++)s=t._geochainLevels[h],r[s]&&l.push(new sr(r[s],r[s+"EntityId"],h));return l},t._comparableToViewport=function(n,t){if(!n||!t)return!1;var i=c.fromEdges(n[1],n[0],n[3],n[2]),r=Math.min(c.getWidth(t)/4,c.getHeight(t)/4);return c.getWidth(i)>=r||c.getHeight(i)>=r},t._canFitViewport=function(n,t){if(!n||!t)return!1;var i=c.fromEdges(n[1],n[0],n[3],n[2]);return!(c.getWidth(i)>c.getWidth(t)||c.getHeight(i)>c.getHeight(t))},t.geocodingErrorPrefix="reverseGeoCoder failed.",t._geochainEntityTypes=["Neighborhood","PopulatedPlace","AdminDivision1","AdminDivision2","CountryRegion"],t._geochainLevels=["country","state","county","city","neighborhood"],t._geochainLevelZoomLimits=(d={},d.country=4,d.state=7,d.county=10,d.city=13,d.neighborhood=15,d),t._revGeocoderCache=new yt(100),t._boundsResultCache=new yt(100),t}(),sr=function(){function n(n,t,i){this.displayName=n;this.entityId=t;this.index=i}return n}(),hr=function(){function t(){}return t.prototype.geocode=function(t,i,r,u,f,e){function y(n){return n?c.getSouth(n)+","+c.getWest(n)+","+c.getNorth(n)+","+c.getEast(n):""}var s="ValidCredentials",h=200,l="OK",o={success:!1,statusCode:null,authenticationResultCode:null,statusDescription:null,name:t,results:null},a,v;location||i(o);a=u&&u<=20?u:5;v=ut.geocodeRequestUrlFormat.replace("{session_key}",n.dynamicProperties.sessionKey);var p=v.replace("{query}",encodeURIComponent(t)).replace("{culture}",n.dynamicProperties.market).replace("{userMapView}",y(r)).replace("{maxResults}",a).replace("{neighborhood}",f?"1":"0").replace("{incl}",e?"ciso2":""),b=function(n){var t,u,r;if(n&&n.authenticationResultCode===s&&n.statusCode===h&&n.statusDescription===l&&n.resourceSets&&n.resourceSets.length!==0){for(o.success=!0,o.statusCode=h,o.authenticationResultCode=s,o.statusDescription=l,t=0,u=n.resourceSets.length;t<u;t++)if(r=n.resourceSets[t].resources,r&&r.length!==0){o.results=r;break}o.traceId=n.traceId}else n?(o.statusCode=n.statusCode,o.authenticationResultCode=n.authenticationResultCode,o.statusDescription=n.statusDescription,o.errorMessage=n.errorDetails&&n.errorDetails.length>0&&n.errorDetails[0],o.traceId=n.traceId):(o.statusCode=400,o.authenticationResultCode="Unknown",o.statusDescription="Unknown");i(o)},k=function(){o.authenticationResultCode="Unknown";o.statusCode=404;o.statusDescription="Http Error";i(o)};w.downloadJsonp(p,"geocode",b,k,null,null)},t}(),pi=function(){function t(n,t){this._window=n;this._reverseGeocoder=t;this._fetchingPosition=!1}return t.prototype.GetCurrentPosition=function(n){var i=this,t,r,u;n&&n.callback&&(t={success:!1,statusCode:200,authenticationResultCode:"ValidCredentials",statusDescription:"OK",location:null,addressList:null,results:null,position:null,error:{code:4,message:"Unknown Error"}},this._window.navigator&&this._window.navigator.geolocation?this._fetchingPosition?(t.error.code=5,t.error.message="Try again later",n.callback(t)):(n.timeout=n.timeout?n.timeout:ut.geolocationTimeout,n.maximumAge=n.maximumAge?n.maximumAge:ut.geolocationMaxAge,n.enableHighAccuracy=!0,this._fetchingPosition=!0,r=function(r){t.success=!0;t.position=r;t.location=p.Position.fromLatLng(r.coords.longitude,r.coords.latitude,r.coords.altitude);t.error=null;i._fetchingPosition=!1;n.performReverseGeocoding&&i._reverseGeocoder?i._reverseGeocoder.reverseGeocode(t.location,function(i){t.addressList=i.success&&i.addressList?[i.addressList[0]]:[];n.callback(t)}):n.callback(t);i._logData(t)},u=function(r){t.error.code=r.code;t.error.message=r.message;i._fetchingPosition=!1;n.callback(t);i._logData(t)},this._window.navigator.geolocation.getCurrentPosition(r,u,n)):(t.error.code=6,t.error.message="Geolocation not supported by browser",n.callback(t)))},t.prototype._logData=function(n){var i,u;!this._hasLogged&&n&&(u={feature:"LM",action:"IN",data:t._createLogData(n)},(i=r.logger)===null||i===void 0?void 0:i.logObject(u),this._hasLogged=!0)},t._createLogData=function(t){var r=t.success,u="NaN,NaN",f=NaN,e=-1,i;return r&&t.position&&t.position.coords?(i=t.position.coords,u=i.latitude+","+i.longitude,f=i.accuracy):e=t.error.code,{success:r,errorCode:e,clientIP:n.dynamicProperties.clientIP,reverseIPLocation:n.dynamicProperties.reverseIPLocation,geolocation:u,geolocationAccuracy:f}},t}(),wi=function(){function t(){this.unknown="Unknown"}return t.prototype.reverseGeocode=function(n,t,i,r,u){var f=this,e,o;return n||t(this._getEmptyResponse()),n[0]=ct.normalizeLongitude(n[0]),e=this.getReverseGeocoderUrl(n,!0,i,r,u),o=function(){var i=f._getEmptyResponse(n);i.authenticationResultCode=f.unknown;i.statusCode=404;i.statusDescription="Http Error";t(i)},w.downloadJsonp(e,"revgeocode",function(i){t(f.parseReverseGeocodeResponse(i,n))},o,null,null)},t.prototype.getReverseGeocoderUrl=function(t,i,r,u,f){i===void 0&&(i=!0);var e=ut.reverseGeocodeRequestUrlFormat.replace("{session_key}",n.dynamicProperties.sessionKey).replace("{culture}",n.dynamicProperties.uiLanguage).replace("{includeEntityTypes}",r?r.join(","):"").replace("{neighborhood}",u?"1":"0").replace("{incl}",this._getIncludeOptionString(f)).replace("{cmnPltParam}",n.platformCommonParam);return i||(e=e.replace("{callback}","")),t&&(e=e.replace("{latitude}",t[1].toString()).replace("{longitude}",t[0].toString())),e},t.prototype.getFirstFormattedAddress=function(n){var t,i=this.parseReverseGeocodeResponse(n);return((t=i.addressList)===null||t===void 0?void 0:t.length)>0?i.addressList[0].formattedAddress:""},t.prototype.parseReverseGeocodeResponse=function(n,t){var i=this._getEmptyResponse(t),f="ValidCredentials",e=200,o="OK",r,s,u;if(n&&n.authenticationResultCode===f&&n.statusCode===e&&n.statusDescription===o&&n.resourceSets&&n.resourceSets.length!==0){for(i.success=!0,i.statusCode=e,i.authenticationResultCode=f,i.statusDescription=o,r=0,s=n.resourceSets.length;r<s;r++)if(u=n.resourceSets[r].resources,u&&u.length!==0){i.addressList=[];i.results=[];u.forEach(function(n){var t=n.address;t&&t.formattedAddress&&(i.addressList.push(t),i.results.push(n))});break}i.traceId=n.traceId}else n?(i.statusCode=n.statusCode,i.authenticationResultCode=n.authenticationResultCode,i.statusDescription=n.statusDescription,i.errorMessage=n.errorDetails&&n.errorDetails.length>0&&n.errorDetails[0],i.traceId=n.traceId):(i.statusCode=400,i.authenticationResultCode=this.unknown,i.statusDescription=this.unknown);return i},t.prototype._getIncludeOptionString=function(n){switch(n){case 0:return"ciso2";case 1:return"entityId";default:return""}},t.prototype._getEmptyResponse=function(n){return{success:!1,statusCode:null,location:n,authenticationResultCode:null,statusDescription:null,addressList:null,results:null}},t}(),ft=function(){function t(i){var r=this;this.bingControlIds=["bingStylePicker","bingStylePickerIcon","bingZoom","bingCompass","bingPitch","locateMe"];this._maxTimeoutForPLTexv2=15e3;this._minTimeoutForPLTexv2=7e3;this._lastLayerChangeTime=-1;this._logStatus={};this._totalMapResizeEvents=0;this._disposables=[];this._dwellTimeMarkerIds=[];this._onMapIdle=function(){var e,i,u,n,f;for(r._isViewChanging&&(e=r._map.getCamera(),i=performance.now()-r._moveEndTime,r._isUserInteraction&&(e.zoom!==r._cameraAtMoveStart.zoom?t.record("Maps_ZTTG",i):t.record("Maps_PTTG",i)),t.record("Maps_VCTTG",i)),r._isViewChanging=r._isUserInteraction=!1,u=Object.keys(t._logStartKey),n=0;n<u.length;n++)f=t._logStartKey[u[n]],f.logOnRenderComplete&&t.log(u[n],f.startTime);t.tryFlush()};this._onMapRender=function(){var n,t;r._totalTicks++;n=performance.now();r._totalTicks>0&&(t=n-r._previousTickTimestamp,r._maxTimeBetweenTicks=Math.round(Math.max(r._maxTimeBetweenTicks,t)),r._droppedFrameCount+=t>40?1:0);r._previousTickTimestamp=n};this._onMapMoveEnd=function(){var n;if(r._moveEndTime=performance.now(),n=r._previousTickTimestamp-r._moveStartTime,r._totalTicks>0&&n>100){var e=r._map.getCamera(),i=Math.round(r._totalTicks/(n/1e3)),u=100*r._droppedFrameCount/r._totalTicks,f={FPS:i,longestFrame:r._maxTimeBetweenTicks,droppedPercent:u.toFixed(2)+"%"};e.zoom!==r._cameraAtMoveStart.zoom?(t.record("Maps_ZDFP",u),t.record("Maps_ZFPS",i),t.record("Maps_ZLF",r._maxTimeBetweenTicks),f.type="zoom"):(t.record("Maps_PDFP",u),t.record("Maps_PFPS",i),t.record("Maps_PLF",r._maxTimeBetweenTicks),f.type="pan");g.setLastMoveStat(f)}t.setStartTime("MoveEnd")};this._onMapMoveStart=function(n){r._isUserInteraction=!!n.originalEvent;r._cameraAtMoveStart=r._map.getCamera();r._moveStartTime=r._previousTickTimestamp=performance.now();r._droppedFrameCount=0;r._maxTimeBetweenTicks=0;r._totalTicks=-1;r._isViewChanging=!0;r._isUserInteraction&&r._onUserInteraction()};t._instance=this;this._map=i;this._totalTicks=0;this._logBST();n.isMapsVertical&&(this._setupPltexV2Observer(),this._setupUserInteractionListener(),this._logDwellTimeMarker());i.mapReady.then(function(){r._onMapReady();r._disposables.push(f.add(i,"idle",r._onMapIdle))});this._disposables.push(f.addOnce(i,"idle",function(){return r._onFirstMapIdleOrUserInteraction()}),f.add(i,"movestart",this._onMapMoveStart),f.add(i,"render",this._onMapRender),f.add(i,"moveend",this._onMapMoveEnd),f.add(i,"resize",function(){r._totalMapResizeEvents++}));document.addEventListener("visibilitychange",function(){return r._onUserInteraction()})}return t.tryFlush=function(){n.enableInstrumentation&&((n.isMapsVertical||n.isMapsAnswer)&&typeof perf!="undefined"&&!!perf.flush?perf.flush():g.tryFlush())},t.record=function(i,r,u){u===void 0&&(u=!0);var f=typeof r=="number";if(u&&f&&r&&n.isOnCorpnet)try{performance.measure(i,{start:performance.now()-r})}catch(e){}r=f?Math.round(r):r;n.testHooksEnabled&&console.log("".concat(Date.now()-performance.timeOrigin," - PerfV2 key:").concat(i," Value:").concat(r));n.enableInstrumentation&&(f&&t._logPASMetrics(i,r),(n.isMapsVertical||n.isMapsAnswer)&&typeof perf!="undefined"&&!!perf.record?perf.record(i,r):g.record(i,r))},t.mark=function(i,r){if(performance.measure&&performance.measure(i),n.testHooksEnabled&&console.log("PerfV2 key:".concat(i," Value:").concat(r?r:performance.now())),n.enableInstrumentation){r=(r||performance.now())-t._mapPausedDuration;var u=void 0;window.performance&&(u=Math.round(performance.timeOrigin+r));(n.isMapsVertical||n.isMapsAnswer)&&typeof perf!="undefined"&&!!perf.mark?perf.mark(i,u):g.mark(i,u);t._logPASMetrics(i,r)}},t.removeKey=function(n){var i=t._instance;delete t._logStartKey[n]},t.setStartTime=function(n,i){t._startWatchForActiveKeys();t._logStartKey[n]={startTime:Math.round(i||Date.now())}},t.getStartTime=function(n,i){var r=t._logStartKey[n]&&typeof t._logStartKey[n].startTime=="number"?t._logStartKey[n].startTime:0;return i&&t.removeKey(n),r},t.log=function(n,i){if(i=i||t.getStartTime(n,!0),t.removeKey(n),i>0){var r=Math.round(Date.now()-i);t.record(n,r)}},t.logAfterRenderComplete=function(n,i){var r=t._logStartKey[n];r?i&&(r.startTime=i):t.setStartTime(n,i);t._logStartKey[n].logOnRenderComplete=!0;t._startWatchForActiveKeys()},t.getLogKeyFromUrl=function(n){var t=null;return n&&(n.indexOf("localoverlaybfpr?")>-1?t="Maps_lobfpr":n.indexOf("localpoioverlaybfpr?")>-1?t="Maps_lpobfpr":n.indexOf("overlaybfpr?")>-1?t="Maps_obfpr":n.indexOf("landmarkdeals?")>-1&&(t="Maps_lmd")),t},t.prototype.dispose=function(){var n,r,u;if(this._map){for(this._map=null,t.tryFlush(),i._clearDisposables(this._disposables),clearTimeout(this._timerId),clearTimeout(t._keyExpiredTimerId),t._keyExpiredTimerId=-1,n=0,r=this._dwellTimeMarkerIds;n<r.length;n++)u=r[n],clearTimeout(u);t._instance=null;t._logStartKey={};this._logStatus={}}},t._logPASMetrics=function(n,i){if(t._PASLoggingKeys.indexOf(n)>-1){var r=i||performance.now();t._pasPageTimingsLog[n]=Math.round(r)}},t.prototype._onMapReady=function(){this._logStatus.Maps_READY||(t.mark("Maps_READY"),this._logStatus.Maps_READY=!0)},t.prototype._onFirstMapIdleOrUserInteraction=function(){this._isPLTLogged||(this._isPLTLogged=!0,t.mark("Maps_PLT"),t.mark("Maps_PLT_V9"),t.record("Maps_resizePLT",this._totalMapResizeEvents),this._logPPLT(),this._logDiagnosticsInfo(),this._logResourceData(),this._logNavigationData(),this._tryLogLandingLOD(),n.isMapsVertical&&this._logTransferSize())},t.prototype._logBST=function(){this._logStatus.Maps_BST||(t.mark("Maps_BST"),this._logStatus.Maps_BST=!0)},t.prototype._logPPLT=function(){var i=window.mapsTilePrimerObj,n;i&&(n=i.tilePrimerLoadTime,n&&!this._logStatus.Maps_PPLT&&(t.record("Maps_PPLT",Math.round(n)),this._logStatus.Maps_PPLT=!0))},t.prototype._logDiagnosticsInfo=function(){var i=h.cpuCores;typeof i=="number"&&t.record("Maps_CPUCORE",i,!1);t.record("Maps_GPU",h.deviceClassification,!1);t.record("Maps_RM",h.renderingMode,!1);t.record("Maps_DPR",window.devicePixelRatio||1,!1);t.record("Maps_SlowP",u.isSlowPartner?1:0);t.record("Maps_Bot",n.dynamicProperties.likelyBot?1:0);h.gpuRendererHash&&t.record("Maps_GPURH",h.gpuRendererHash);t.record("Maps_GPUR",h.gpuRenderer);t.record("Maps_GL2",h.webgl2Supported?1:0,!1)},t.prototype._logResourceData=function(){var ht=this,d;if(!this._logStatus.resourceData&&typeof performance!="undefined"){if(this._logStatus.resourceData=!0,performance.getEntriesByType){var rt=performance.getEntriesByType("resource"),g=0,ut=0,r=0,ft=0,u=0,f=0,e=0,o=0,s=0,h=0,c=0,l=0,a=0,v=0,p=0,w=0,b=0,k=0,ct=n.isOnChina?"tiles.ditu.":"tiles.virtualearth.net";for(d=0;d<rt.length;d++){var i=rt[d],nt=i.name?i.name.toLowerCase():"",et=Math.floor(i.domainLookupEnd-i.domainLookupStart),ot=Math.floor(i.connectEnd-i.connectStart),st=Math.floor(i.secureConnectionStart>0?i.connectEnd-i.secureConnectionStart:0),tt=Math.floor(i.responseStart-i.requestStart),it=i.responseStart>0?Math.floor(i.responseEnd-i.responseStart):0;nt.indexOf(ct)>-1?(c=Math.max(et,c),l=Math.max(ot,l),a=Math.max(st,a),v=Math.max(tt,v),w=Math.max(it,w),i.transferSize&&(ut+=i.transferSize,r=i.responseEnd-i.responseStart)):t.rmsUrlIdentifier.test(nt)?(e=Math.max(et,e),o=Math.max(ot,o),s=Math.max(st,s),h=Math.max(tt,h),k=Math.max(it,k),i.encodedBodySize&&(u++,ft+=i.encodedBodySize),i.transferSize&&(f++,g+=i.transferSize,r=i.responseEnd-i.responseStart)):nt.indexOf("/stl?")>-1&&(p=Math.max(tt,p),b=Math.max(it,b))}u>0&&(t.record("Maps_CM",Math.round(f/u*100)),t.record("Maps_ERS",ft),t.record("Maps_TRS",g),r>0&&t.record("Maps_Nspeed",Math.round((ut+g)/r)),f===0&&t.mark("Maps_PLT2"),f===u&&t.mark("Maps_PLT1"));e&&t.record("Maps_BDNST",e);o&&t.record("Maps_BCT",o);s&&t.record("Maps_BSSLT",s);h&&t.record("Maps_BTTFB",h);k&&t.record("Maps_BDT",k);c&&t.record("Maps_TSDNST",c);l&&t.record("Maps_TSCT",l);a&&t.record("Maps_TSSSLT",a);v&&t.record("Maps_TSTTFB",v);p&&t.record("Maps_XSRTTFB",p);b&&t.record("Maps_XSRDT",b);w&&t.record("Maps_TSDT",w)}this._logMemory("Maps_MEM");this._timerId=y.setTimeout(function(){ht._logMemory("Maps_LMEM")},126e4)}},t.prototype._logNavigationData=function(){var r,i;n.isMapsVertical&&!this._logStatus.navigationData&&typeof performance!="undefined"&&(this._logStatus.navigationData=!0,performance.getEntriesByType&&(r=performance.getEntriesByType("navigation"),r&&r.length>0&&(i=r[0],i&&(t.record("Maps_NTS",i.transferSize/1024,!1),t.record("Maps_NDCLT",i.domContentLoadedEventStart),t.record("Maps_NTTFB",i.responseStart-i.requestStart),t.record("Maps_NRET",i.responseEnd)))))},t.prototype._logMemory=function(n){if(typeof performance!="undefined"){var i=performance.memory;i&&i.usedJSHeapSize&&t.record(n,Math.round(i.usedJSHeapSize/1e3))}},t.prototype._setupUserInteractionListener=function(){var n=this;this._map.mapLoaded.then(function(){n.bingControlIds.forEach(function(t){var i=document.getElementById(t);i===null||i===void 0?void 0:i.addEventListener("click",function(){return n._onUserInteraction()})})})},t.prototype._onUserInteraction=function(){document.hidden?this._isPLTLogged?this._logPLTexV2():(this._isPLTexV2Logged=!0,this._isPLTLogged=!0):(this._onFirstMapIdleOrUserInteraction(),this._logPLTexV2())},t.prototype._logDwellTimeMarker=function(){for(var r,u=this,i=performance.now(),f=function(n){var r=function(){t.record("".concat("Maps_Dwell","_").concat(n),1);t.tryFlush()};n>i?u._dwellTimeMarkerIds.push(y.setTimeout(r,n-i)):r()},n=1;n<=3;n++)r=1e4*n,f(r)},t.prototype._setupPltexV2Observer=function(){var n=this,i;this._map.mapReady.then(function(){var t=function(t){var i,r=(i=t.id)===null||i===void 0?void 0:i.toLowerCase();(r===null||r===void 0?void 0:r.startsWith("lmk_"))||f.addOnce(n._map,"idle",function(){return n._lastLayerChangeTime=performance.now()})};n._disposables.push(f.add(n._map,"layeradded",t),f.add(n._map,"layerremoved",function(){n._logPLTexV2()}))});window.sj_evt&&(i=function(t){(t===null||t===void 0?void 0:t.length)>1&&t[1]!=="Permalink"&&(n._logPLTexV2(),sj_evt.unbind("NewTaskActivate",i))},sj_evt.bind("NewTaskActivate",i),sj_evt.bind("OverlayTaskComplete",function(){return n._logPLTexV2(!0)}));f.addOnce(this._map,"idle",function(){var i=Math.max(n._minTimeoutForPLTexv2,Math.min(Math.round(performance.now()*2),n._maxTimeoutForPLTexv2));t._pltexV2ExpiredTimerId=setTimeout(function(){n._logPLTexV2()},i)})},t.prototype._logPLTexV2=function(i){if(n.isMapsVertical&&!this._isPLTexV2Logged){this._isPLTexV2Logged=!0;var u=t._pasPageTimingsLog.Maps_PLT||performance.now(),r=i?performance.now():Math.max(this._lastLayerChangeTime,u);t.mark("Maps_PLTEX",r);t.mark("Maps_PLTEX_V9",r);clearTimeout(t._pltexV2ExpiredTimerId)}},t.prototype._logTransferSize=function(){for(var o,i,f,n,r=0,s=performance.getEntriesByType("navigation"),u=0,e=s;u<e.length;u++)n=e[u],r+=n.transferSize;for(o=performance.getEntriesByType("resource"),i=0,f=o;i<f.length;i++)n=f[i],r+=n.transferSize;t.record("Maps_tts",Math.round(r/1024),!1)},t.prototype._tryLogLandingLOD=function(){var n=i.convertZoom(this._map.getCamera().zoom,0);t.record("Maps_LLOD",Math.round(n),!1)},t._startWatchForActiveKeys=function(){t._keyExpiredTimerId===-1&&(t._keyExpiredTimerId=y.setTimeout(function(){var r,i,u,n;for(t._keyExpiredTimerId=-1,r=Date.now(),i=Object.keys(t._logStartKey),n=0;n<i.length;n++)r-t._logStartKey[i[n]].startTime>t._timeoutForPerfLogging&&(delete t._logStartKey[i[n]],u=!0);Object.keys(t._logStartKey).length>0&&t._startWatchForActiveKeys()},1e4))},t._timeoutForPerfLogging=2e4,t.rmsUrlIdentifier=/bing.com\/(\w|\/|,|\.)+\.(css|js)/ig,t._logStartKey={},t._keyExpiredTimerId=-1,t._pltexV2ExpiredTimerId=-1,t._PASLoggingKeys=["Maps_BST","Maps_PPLT","Maps_PLT","Maps_PLTEX","Maps_READY"],t._pasPageTimingsLog=window._pageTimings||(window._pageTimings={}),t._mapPausedDuration=0,t}(),g;(function(t){function e(){r.logger.igUpdatedPromise.then(function(){if(i.length>0||u.length>0){var t=Date.now(),e="id:".concat(Math.round(Math.random()*1e4),",")+(i.length>0?'P:"'.concat(i.join(","),'",'):"")+(u.length>0?'S:"'.concat(u.join(","),'",'):"")+'v:1.1,T:"CI.Perf",FID:"CI",Name:"PerfV2"',r=n.dynamicProperties,s=r.impressionGuid,h=r.origin+"/fd/ls/lsp.aspx",c="<E><T>Event.ClientInst<\/T><IG>".concat(s,"<\/IG><TS>").concat(t,"<\/TS><D><![CDATA[{").concat(e,"}]\]><\/D><\/E>"),l="<ClientInstRequest><Events>".concat(c,"<\/Events><STS>").concat(t,"<\/STS><\/ClientInstRequest>");navigator.sendBeacon(h,l);i=[];u=[];o=!0;clearTimeout(f);f=-1}})}function h(){o&&f===-1&&(f=y.setTimeout(e,c))}function l(n,t){u.push(n+":"+(typeof t=="number"?Math.round(t):t));h()}function a(n,t){t||(t=performance.now());i.push(n+":"+Math.round(t).toString(36));h()}function v(){e();clearTimeout(f)}function p(){return s}function w(n){s=n}var c=1e3,i=[],u=[],f=-1,o=!1,s;t.tryFlush=e;t.record=l;t.mark=a;t.dispose=v;t.getLastMoveStat=p;t.setLastMoveStat=w})(g||(g={}));atlas.Map=dt;r.Anchor=er;r.GeoJSON=vt;r.NetworkCallbacks=w.callbacks;r.Point=v;r.Rectangle=vi;r.ResourceManager=or;r.Size=wt;r.BingLogoControl=gi;r.LocateMeControl=ii;r.MePoi=ri;r.PerfV2SDKLogger=g;r.StylePicker=hi;r.BingCompassControl=fi;r.BingPitchControl=ei;r.BingZoomControl=oi;r.TrafficPicker=ir;r.MapControlInstrumentationHelper=a;e.AtlasHelper=i;e.AzureMapEvents=f;e.CommandQueue=ur;e.Geocoder=hr;e.GeochainManager=yi;e.GeolocationProvider=pi;e.JSEvent=k;e.LruCache=yt;e.MapDelegate=li;e.MapsInfobox=ni;e.MapMath=et;e.Network=w;e.ObjectWithId=lt;e.PoiAnimation=at;e.PerfV2Logger=ft;e.ReverseGeocoder=wi;e._Url=fr}catch(bi){if(r&&r.logger)r.logger.logCriticalError(bi);else throw bi;}}.call(window)