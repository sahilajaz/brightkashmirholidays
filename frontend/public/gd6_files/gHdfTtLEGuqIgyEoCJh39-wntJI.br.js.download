(function(){var r,y,l,p,w,b,k,d,g,nt,tt,f;try{var i=Microsoft.Maps,n=i.Internal,ht=n.__assign,ct=n.__extends,lt=n.__spreadArray,e=i.globalConfig,at=n.coreConfig,t=e.features,vt=t.advertising,yt=t.autosuggest,pt=t.calendar,wt=t.collections,bt=t.directions,kt=t.feedback,dt=t.flyover,gt=t.landmarks3D,ni=t.map3D,ti=t.richMapsInfobox,ii=t.labels,rt=t.layerManager,ri=t.localGuide,ui=t.localSearch,fi=t.mapDelay,ei=t.optIn,ut=t.print,a=t.sharing,o=t.streetside,oi=t.birdseye,si=t.taskBar,v=t.taskFramework,hi=t.trafficControl,ci=t.traffic,li=t.trafficExperiences,ai=t.transit,vi=t.travel,yi=t.xsr,pi=atlas.math,wi=atlas.data,bi=atlas.layer,ki=atlas.Pixel,di=atlas.data.BoundingBox,gi=n.AzureMapEvents,nr=n.AzureMapInteractions,tr=n.Binding,ir=n.BoundsAccumulator,rr=n.Debug,u=n.Gimme,ft=n.AtlasHelper,ur=n.EntityHelper,s=n.Helper,fr=n.LocationRectHelper,er=n.LocalStorageCache,or=n.LruCache,et=n.MapMath,sr=n.Network,hr=n.JSEvent,cr=n.ObjectWithId,lr=n.Observable,ar=n.ObservableCollection,vr=n.ObservableObject,yr=n.Overlay,pr=n.PyramidTileSpatialIndex,wr=n.TaskDataHandlerHelper,br=n.TileSystemHelper,kr=n.PerfV2Logger,dr=n.VectorMath,gr=n.TimeoutWrapper,nu=i.Anchor,tu=i.BingMapStyle,iu=i.Color,ru=i.globalContainer,ot=n.InstrumentationBase,uu=i.LatLonCrs,c=i.Location,fu=i.LatLonEncoder,eu=n.ObservableObjectChangedArgs,ou=i.Point,su=i.Rectangle,hu=i.ResourceManager,cu=i.SimpleAreaPrimitive,lu=i.SimpleLinePrimitive,au=i.SimplePointPrimitive,vu=i.Size,yu=n.Control,st=n.ControlTemplate,h=i.GlobalDataEventHandler,pu=i.TaskManager;(function(n){function i(n,i,r){if(n)try{if(!n.isEnabled||t[r])return}catch(u){return}h.registerDataHandler(i,r);h.registerEventForDataAttribute("click",i,{preventDefault:!0});t[r]=!0}var t={};n.register=i})(r||(r={}));y=function(){function n(){}return n.prototype.processData=function(n,t,r){var o,f,u;if(e.enableInstrumentation)if(o=i.logger,n==="data-instrumentation"){if(!(t&&(t.logData||t.flush)))throw new Error("Invalid options passed");if(f=null,u=r,t.logData){if(!t.impressionGuid)while(u&&u.length&&u.get_attr){if(f=u.get_attr("data-ig"),f)break;u=u.getParent()}o.logObject(t.logData,f||t.impressionGuid,t.isMapsAction)}t.flush&&o.flush()}else n==="data-serverInstrumentation"&&ot.SendInstrumentationToServer(t.logData.data,t.logData.feature)},n}();l="InstrumentationDataHandler";r.register(null,"data-instrumentation",l);r.register(null,"data-serverInstrumentation",l);p=function(){function n(n){this._container=n}return n.prototype.processData=function(n,t){t&&this._activateLayerManager(t)},n.prototype._activateLayerManager=function(t){this._container.instanceAsync("LayerManagerModule",function(i){if(n._isCategoryEnabled(t)||t.action==="activateNearbyLayer"||t.action==="removeNearbyLayer")switch(t.action){default:case"activateLayer":i.activate(t);break;case"removeLayer":i.remove(t.category,t.taskId);break;case"activateNearbyLayer":i.activateNearbyLayer(t.category,t.url);break;case"removeNearbyLayer":i.removeNearbyLayer(t.category);break;case"updateDisplayState":i.updateDisplayState(t.category,t.taskId,t.displayState);break;case"updateFilters":i.updateFilters(t.category,t.taskId,t.filters);break;case"updateQuery":i.updateQuery(t.category,t.taskId,t.queryText);break;case"updateRoutePoints":i.updateRoutePoints(t.category,t.taskId,t.routePoints);break;case"updateTaskEntities":i.updateTaskEntities(t.category,t.taskId,t.taskEntities);break;case"refreshData":i.refreshData(t.category,t.taskId);break;case"removeAllLayers":i.removeAll()}})},n._isCategoryEnabled=function(n){for(var u,i=n.category,f=e.features.layerManager,r=f.enabledCategories,t=0,o=r.length;t<o;t++)if(u=r[t],i===u)return!0;return s._isHotelsCategory(i)?(n.category="hotel",!0):!1},n}();r.register(rt,"data-managelayer","LayerManagerDataHandler");w=function(){function n(n,t){this._taskManager=n;this._layoutManager=t}return n.prototype.processData=function(n,t){if(t)switch(t.action){default:case"changeLayout":t.name&&this._layoutManager.activateLayout(t.name);break;case"updateLayout":t.state&&this._layoutManager.updateLayout(t.state)}else throw new Error("Options is not passed");},n}();r.register(null,"data-layout","LayoutDataHandler");b=function(){function n(n){this._printManager=n}return n.prototype.processData=function(n,t){n==="data-print"&&t&&t.source&&this._printManager.showPrintDialog(t)},n}();r.register(ut,"data-print","PrintDataHandler");k=function(){function n(n,t){this._map=n;this._taskBar=t}return n.prototype.processData=function(n,t){var i=t||{action:"share"};i.entryPoint=i.entryPoint||"";this.currentSharingOptions={entryPoint:i.entryPoint};switch(i.action){case"shareTasks":this.currentSharingOptions.taskIds=i.taskIds||[];default:case"share":this._showSharingUX(i);break;case"closeShare":this._closeSharingUX(i)}},n.prototype._showSharingUX=function(){var n=this._map,e=n.getContainer(),t,r;if(a.enableMultipleCardSharing)if(this._taskBar&&this._taskBar.setActionsState(8,2),u(".taskBar").set_style({"z-index":"998"}),t=s._createElement("div"),t.set_attr("class","bm_allButTaskFrameworkLane"),u("#container").append(t),u(".".concat("taskLayoutContainer")).add_class("select"),r=n.getStyle(),r==="streetside"){this.currentSharingOptions.taskIds=null;this._pseudoShareDialog=st.createControl("SharePanel");this._pseudoShareDialog.setInitialData({container:e});var i=s._createElement("div"),o=n.getRootElement(),f="bm_l2NavLeft bm_pseudoShareDialog bm_tcfDesign_A";v.newCardSizingForTCF&&(f+=" bm_phase2");i.set_attr("class",f);o.append(i);i.append(this._pseudoShareDialog.getRootElement());this._pseudoShareDialog.refresh(!0)}else h.invokeHandler("data-layout",{action:"changeLayout",name:"MultiCardLeftSelectionLayout"}),u("#sb_feedback").set_style({display:"none"})},n.prototype._closeSharingUX=function(){this._pseudoShareDialog?(this._pseudoShareDialog.dispose(),this._pseudoShareDialog=null,u("#mapContainer").set_style({"min-height":""})):h.invokeHandler("data-layout",{action:"changeLayout",name:"MultiCardLeftLayout"});u("#sb_feedback").set_style({display:"inline"});u(".".concat("taskLayoutContainer")).remove_class("select");this._taskBar&&this._taskBar.setActionsState(8,1);u(".taskBar").set_style({"z-index":""});u(".NavBar_Container").set_style({"z-index":"1005"});u(".bm_allButTaskFrameworkLane").removeFromParent();u(".bm_pseudoShareDialog").removeFromParent()},n}();r.register(a,"data-share","ShareDataHandler");d=function(){function n(n){this._map=n;this._disposables={}}return n.prototype.processData=function(n,t){if(t&&t.action){!t.location||t.location instanceof c||(t.location=new c(t.location.latitude,t.location.longitude,t.location.altitude,t.location.altitudeReference));switch(t.action){case"toggleCoverageMap":this._toggleCoverageMap(t.map);break;case"showDirectionsBubbleOverlay":this._showDirectionsBubbleOverlay(t);break;case"showBubbleImage":this._showStreetsideBubbleImage(t);break;case"showBubble":this._showStreetsideBubble(t);break;case"dispose":this._disposeResources(t);break;default:console.error("Invalid action")}}else console.error("Invalid options passed")},n.prototype._toggleCoverageMap=function(){console.error("to be impelmented: _toggleCoverageMap")},n.prototype._showDirectionsBubbleOverlay=function(){console.error("to be impelmented: _showDirectionsBubbleOverlay")},n.prototype._showStreetsideBubble=function(n){var t,i=function(){var t;(t=n.errorCallback)===null||t===void 0?void 0:t.call(n)};n.location?this._activateStreetsideMode(n.location,(t=n.localDetailsStartupOptions)===null||t===void 0?void 0:t.heading):i()},n.prototype._showStreetsideBubbleImage=function(n){var a=this,i=n.localDetailsStartupOptions,f=function(){n.errorCallback&&n.errorCallback()};if(n.location&&i&&i.sivImageContainer.length>0&&(o===null||o===void 0?void 0:o.isEnabled)){var s=i.sivImageContainer,r=n.localDetailsStartupOptions.routablePoint,u=c.cloneFrom(r||n.location),h=r&&n.location?et.getAngleBetweenTwoLocations(r,n.location):0,l=o.localTaskStreetsideImageUrl.replace("{latitude}",u.latitude+"").replace("{longitude}",u.longitude+"").replace("{heading}",h+"").replace("{credentials}",e.dynamicProperties.sessionKey),t=new Image;t.onload=function(){s.set_style({display:"block","z-index":0,"background-image":"url('"+l+"')","background-size":"100% 100%"});n.callback&&n.callback();s.add_event("click",function(n){n.preventDefault();a._activateStreetsideMode(u,h)});t.onerror=t.onload=null};t.onerror=function(){t.onerror=t.onload=null;f()};t.src=l}else f()},n.prototype._activateStreetsideMode=function(n,t){this._map.getStreetsideControl().then(function(i){i.activate({center:[n.longitude,n.latitude],heading:t})})},n.prototype._disposeResources=function(n){ft._clearDisposables(this._disposables[n.id])},n._streetsideCoverageBehaviorClassName="StreetsideCoverageBehavior",n}();r.register(o,"data-streetside","StreetsideDataHandler");g=function(){function n(n,t){this._container=n;this._taskManager=t}return n.prototype.processData=function(n,t,i){var o=this,r,u,f,e;if(t){r=!1;switch(t.action){default:case"activate":t.type&&(u=s._overrideTasktypeBasedOnCategory(t.type,t.state,i),f=u?u:t.type,this._container.instanceAsync(f,function(n){o._taskManager.activateTask(n,t.state,t.activateOptions)}),r=!0,sj_evt.fire("NewTaskActivate",t.state&&t.state.entryPoint));break;case"activateHidden":t.id&&(e=this._taskManager.getHiddenTaskById(t.id),this._taskManager.activateTask(e,t.state,t.activateOptions,!0),r=!0);break;case"focus":t.id&&(this._taskManager.focusTask(t.id,t.state),r=!0);break;case"remove":t.id&&(this._taskManager.removeTask(t.id),r=!0);break;case"removeTaskOrStackIfNotForeground":t.id&&(this._taskManager.removeTaskOrStackIfNotForeground(t.id),r=!0);break;case"removeStack":t.id&&(this._taskManager.removeTaskStack(t.id),r=!0);break;case"removeStackForTask":t.id&&(this._taskManager.removeStackForTask(t.id),r=!0);break;case"removeTaskAndReseatChild":t.id&&(this._taskManager.removeTaskAndReseatChild(t.id),r=!0);break;case"removeAllStacks":this._taskManager.removeAllStacks(t.clearHistoryState);this._taskManager.removeHiddenTasks();r=!0}if(!r)throw new Error("Invalid options passed");}else throw new Error("Options is not passed");},n}();r.register(null,"data-task","TaskActivator");nt=function(){function n(n,t){this._container=n;this._taskManager=t}return n.prototype.processData=function(n,t,i,r){var u=this;if(this._taskManager.isDeserializingTasks)this._taskManager.deserializationCompleted.addOne(function(){return u.processData(n,t,i,r)});else if(t&&t.type&&t.requestState)this.requestTaskProcess(t);else throw new Error("Invalid options passed");},n.prototype.requestTaskProcess=function(n){var e=this,t={requestorId:n.requestorId,requestorState:n.requestorState,requestState:n.requestState},i,r,f,o,u,s;if(n.taskId)this._processSpecificTask(n.taskId,t,n);else if(n.useActiveTasks)if(i=this._taskManager.getTaskByType(n.type),r=[],i&&i.length>0)for(f=0,o=function(u){var o=i[u];if(!o.process)throw new Error("Process is not implemented by task: "+n.type);o.process(t,function(u){u.processorId=o.id;r.push(u);f++;f===i.length&&e._invokeRequestorTask(n,t,r)})},u=0;u<i.length;u++)o(u);else this._invokeRequestorTask(n,t,r);else s=function(i){if(!i.process)throw new Error("Process is not implemented by task: "+n.type);i.process(t,function(i){e._invokeRequestorTask(n,t,[i])})},this._container.instanceAsync(n.type,s,null)},n.prototype._processSpecificTask=function(n,t,i){var u=this,r=this._taskManager.getTaskById(i.taskId);r&&r.process&&r.process(t,function(n){var f=[n];n.processorId=r.id;u._invokeRequestorTask(i,t,f)})},n.prototype._invokeRequestorTask=function(n,t,i){var r={processorType:n.type,inData:t,outData:i},u=n.requestorId&&this._taskManager.getTaskById(n.requestorId),f;!u&&i&&i.length&&i[0].originalProcessInputData&&(f=i[0].originalProcessInputData,u=f.requestorId&&this._taskManager.getTaskById(f.requestorId),u&&r.inData&&(r.inData.requestorId=f.requestorId,r.inData.requestorState=f.requestorState));u&&u.processCallback?u.processCallback(r):n.requestorType?this._container.instanceAsync(n.requestorType,function(n){n&&n.processCallback&&n.processCallback(r)}):n.processCallback&&n.processCallback(r)},n}();r.register(v,"data-process","TaskProcessDataHandler");tt=function(){function n(n){this._map=n;this.show=!1}return n.prototype.processData=function(n,t){var i=this,r=function(n){if(n&&(i._trafficLayer=n),t&&t.action){switch(t.action){case"toggleBoth":i.toggleBoth(t);break;case"toggleTrafficFlow":i.toggleTrafficFlow(t);break;case"toggleIncidentFlow":i.toggleIncidents(t);break;default:console.error("Invalid action")}t.callBack&&t.callBack(i.show)}};this._trafficLayer?r():this._map.getContainer().instanceAsync("TrafficLayerV2",r)},n.prototype.toggleBoth=function(){var n=this._trafficLayer.getIsShowing();e.trafficStyleMenu2&&(n=this._trafficLayer.getIsShowing()&&this._trafficLayer.getIncidentManager().isShowing());n?(this._trafficLayer.hideTrafficMapLayer(),this._trafficLayer.hidePrimitiveLayer(),this.show=!1):(this._trafficLayer.showTrafficMapLayer(),this._trafficLayer.showPrimitiveLayer(),this.show=!0)},n.prototype.toggleTrafficFlow=function(){this._trafficLayer.getIsShowing()?(this._trafficLayer.hideTrafficMapLayer(),this.show=!1):(this._trafficLayer.showTrafficMapLayer(),this.show=!0)},n.prototype.toggleIncidents=function(){this._trafficLayer.getIncidentManager().isShowing()?(this._trafficLayer.hidePrimitiveLayer(),this.show=!1):(this._trafficLayer.showPrimitiveLayer(),this.show=!0)},n}();r.register(null,"data-traffic","TrafficDataHandler");f=n.DataHandlers={};f.InstrumentationDataHandler=y;f.LayerManagerDataHandler=p;f.LayoutDataHandler=w;f.PrintDataHandler=b;f.ShareDataHandler=k;f.StreetsideDataHandler=d;f.TaskActivator=g;f.TaskProcessDataHandler=nt;f.TrafficDataHandler=tt}catch(it){if(i&&i.logger)i.logger.logCriticalError(it);else throw it;}}).call(window)