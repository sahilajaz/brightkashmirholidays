(function(){var ot,y,st;try{var r=Microsoft.Maps,n=r.Internal,gi=n.__assign,w=n.__extends,nr=n.__spreadArray,e=r.globalConfig,ht=n.coreConfig,t=e.features,tr=t.advertising,ir=t.autosuggest,rr=t.calendar,v=t.collections,d=t.directions,ur=t.feedback,fr=t.flyover,er=t.landmarks3D,or=t.map3D,sr=t.richMapsInfobox,hr=t.labels,cr=t.layerManager,lr=t.localGuide,h=t.localSearch,wt=t.mapDelay,ar=t.optIn,vr=t.print,i=t.sharing,it=t.streetside,yr=t.birdseye,pr=t.taskBar,ct=t.taskFramework,wr=t.trafficControl,rt=t.traffic,br=t.trafficExperiences,g=t.transit,ut=t.travel,kr=t.xsr,dr=atlas.math,gr=atlas.data,nu=atlas.layer,tu=atlas.Pixel,iu=atlas.data.BoundingBox,ru=n.AzureMapEvents,bt=n.AzureMapInteractions,uu=n.Binding,kt=n.BoundsAccumulator,fu=n.Debug,l=n.Gimme,u=n.AtlasHelper,a=n.EntityHelper,c=n.Helper,eu=n.LocationRectHelper,k=n.LocalStorageCache,dt=n.LruCache,ou=n.MapMath,lt=n.Network,nt=n.JSEvent,gt=n.ObjectWithId,su=n.Observable,hu=n.ObservableCollection,ft=n.ObservableObject,cu=n.Overlay,lu=n.PyramidTileSpatialIndex,y=n.TaskDataHandlerHelper,au=n.TileSystemHelper,vu=n.PerfV2Logger,yu=n.VectorMath,pu=n.TimeoutWrapper,wu=r.Anchor,bu=r.BingMapStyle,ku=r.Color,ni=r.globalContainer,du=n.InstrumentationBase,at=r.LatLonCrs,p=r.Location,gu=r.LatLonEncoder,nf=n.ObservableObjectChangedArgs,ti=r.Point,tf=r.Rectangle,ii=r.ResourceManager,ri=r.SimpleAreaPrimitive,rf=r.SimpleLinePrimitive,uf=r.SimplePointPrimitive,ff=r.Size,ef=n.Control,sf=n.ControlTemplate,ui=n.Geocoder,hf=n.GeolocationProvider,s=ii.MapDelay,tt=r.Delegates,cf=n.MapsInfobox;"use strict";var fi=function(){function n(n){var t=this;this._serializableComponents={};this._window=n;this._historyUrl=new URL(this._window.location.href);this._currentUrlPath=this._historyUrl.pathname;this._setDevParams();this._history=new ei(n);this._history.statechanged.add(function(n){return t._processStateChange(n)});u._isSmallMapShownOnSerp()||(this._pageLoadStateDictionary=this._history.getState());this._serializableObjectChanged=new nt;this._serializableObjectChanged.addThrottled(function(n){return t._processObjectChange(n)},300,function(n,t){var i=t;return i&&i.magnitude===2||(i=n),i})}return n.prototype.register=function(n,t){var u=this,i,r;if(!n||!t||this._serializableComponents[n])throw new Error("Invalid or Duplicate Key passed for registration: "+n);return this._serializableComponents[n]=t,t.serializableObjectChanged.add(function(n){return u._raiseSerializationChanged(n)}),i=this._pageLoadStateDictionary,i&&(r=i[n],r&&t.deserialize(r)),!0},n.prototype.unregister=function(n){if(!n||!this._serializableComponents[n])throw new Error("Invalid key passed for registration: "+n);delete this._serializableComponents[n]},n.prototype.getHistoryState=function(){return this._history.getState()},n.prototype.doesLocalStorageStateExist=function(){var n=this._history.getLocalStorageState()||{},t=Object.keys(n);return t.length>0},n.prototype.processLocalStorageState=function(){var n=this._history.getLocalStorageState();n&&this._processStateChange(n)},n.prototype.clearLocalStorageState=function(){this._history.clearLocalStorageState()},n.prototype._raiseSerializationChanged=function(n){this._ignoreSerializationEvents||this._serializableObjectChanged.invoke(n)},n.prototype.setIsCapturing=function(n){this._ignoreSerializationEvents=!n},n.prototype.nextHistoryPointReplace=function(){this._nextHistoryPointReplace=!0},n.prototype.updateAddressBar=function(n,t){this._currentUrlPath=n;this._historyUrl.pathname=n;t&&this._history.replaceState(this._history.getState(),this._historyUrl.href)},n.prototype._processStateChange=function(n){var u,t,i,r,f;for(this._ignoreSerializationEvents=!0,this._pageLoadStateDictionary=null,this._reloadPageToHandleUrlChange(),n=n||{},u=Object.keys(this._serializableComponents),t=0,i=u;t<i.length;t++)r=i[t],f=n[r]||{},this._serializableComponents[r].deserialize(f);this._ignoreSerializationEvents=!1},n.prototype._reloadPageToHandleUrlChange=function(){this._currentUrlPath===this._window.location.pathname||u._isMapsOverlay()||u._isSmallMapShownOnSerp()||this._window.location.reload()},n.prototype._processObjectChange=function(n){var t,s,i,r,f,o;if(!(u._isSmallMapShownOnSerp()||e.dynamicProperties.mapsOverlayClosing)||n&&n.clearHistory){for(this._pageLoadStateDictionary=null,t={},s=Object.keys(this._serializableComponents),i=0,r=s;i<r.length;i++)f=r[i],o=this._serializableComponents[f].serialize(),o&&(t[f]=o);this._updateUrlWithLiveParams();this._updateLocalStorage(n);n&&n.clearHistory?this._history.clearState():n&&n.magnitude===2?this._nextHistoryPointReplace?(this._nextHistoryPointReplace=!1,this._history.replaceState(t,this._historyUrl.href)):this._history.pushState(t,this._historyUrl.href):this._history.replaceState(t,this._historyUrl.href)}},n.prototype._updateLocalStorage=function(n){if(n&&n.cameraView){var t=n.cameraView.center,i=ht.locateMeViewExpirationDays,r=k;r.setItem("centerLatitude",t[1].toString(),i);r.setItem("centerLongitude",t[0].toString(),i)}},n.prototype._updateUrlWithLiveParams=function(){var r=this,f,e,n,i,o,t;if(!u._isMapsOverlay())for(f=Object.keys(this._serializableComponents),e=function(n){var e,t,f,i,u;if(n)for(e=Object.keys(n),t=0,f=e;t<f.length;t++)i=f[t],u=n[i],typeof u=="string"&&(u?r._historyUrl.searchParams.set(i,u):r._historyUrl.searchParams.delete(i))},n=0,i=f;n<i.length;n++)o=i[n],t=this._serializableComponents[o],t&&t.getLiveUrlParams&&e(t.getLiveUrlParams())},n.prototype._setDevParams=function(){var t=wt.devParamsList,n,i,r,f;if(this._devParams={},t&&t.length)for(n=0,i=t;n<i.length;n++)r=i[n],f=u._getUrlParam(window.location,r),f&&(this._devParams[r]=f)},n}(),f=function(){function n(t){n._container=t;n._references&&t.instanceAsyncAll(n._references,function(t){var r,u,i;if(n._references){for(r=0;r<n._references.length;r++){var f=n._references[r].name,e=n._mapping[f],o=t[f];for(u=0;u<e.length;u++)i=e[u],n._attrDataHandlerList[i]=o,n._invokeHandlerQueue[i]&&o.processData(i,n._invokeHandlerQueue[i])}n._references=null;n._mapping=null;n._invokeHandlerQueue=null}})}return n.registerDataHandler=function(t,i){if(!t||!i||n._attrDataHandlerList[t])return!1;if(typeof i=="string")if(n._container)n._container.instanceAsync(i,function(i){n._attrDataHandlerList[t]=i},null);else{var r=n._mapping[i];r?r.push(t):(r=n._mapping[i]=[t],n._references.push({name:i}))}else n._attrDataHandlerList[t]=i;return!0},n.prototype.registerGlobalClickEvent=function(t){var r=l(t.shellContainerElement),i="click",u;r.length!==0&&(u=function(n,t){n.target=t.target;n.type=t.type;n.preventDefault=function(){t.preventDefault()}},n._eventHandlers[i]||(n._eventHandlers[i]=c._defineJSEventForDomEvent(r,i,{argBuilder:u}).add(n._eventHandler)))},n.registerEventForDataAttribute=function(t,i){return!t||!i?!1:(n._eventAttributeList[t]||(n._eventAttributeList[t]=[]),n._eventAttributeList[t].push(i),!0)},n.invokeHandler=function(t,i){var r=n._attrDataHandlerList[t];r?r.processData(t,i):n._mapping?n._invokeHandlerQueue[t]=i:console.error("Invalid handler key : "+t)},n._processEvent=function(t,i,r){for(var f=!1,s=!1,e,u,o,h;t&&t.length&&!t.get_attr(n._topLevelTaskContainerAttributeName);){e=n._getAttributeListForEvent(t,i);for(u in e)if(o=n._attrDataHandlerList[u],o){try{h=JSON.parse(e[u]);o.processData(u,h,t,i);s=!0}catch(c){}f=!0}if(f||!r)return f&&s;t=t.parent()}return!1},n._eventHandler=function(t){if(t.target&&l(t.target.parentElement).has_class("ms-composite"))return undefined;var i=t.type,r=l(t.target),u=n._processEvent(r,i,!0);return u&&t.preventDefault&&t.preventDefault(),!1},n._getAttributeListForEvent=function(t,i){for(var u=n._eventAttributeList[i],e={},f,r=0,o=u.length;r<o;r++)f=t.get_attr(u[r]),f&&(e[u[r]]=f);return e},n._references=[],n._mapping={},n._attrDataHandlerList={},n._eventHandlers={},n._eventAttributeList={},n._invokeHandlerQueue={},n._topLevelTaskContainerAttributeName="data-global",n._container=null,n}(),ei=function(){function n(n){var t=this;this._window=n;this.statechanged=new nt;this._window.history&&this._window.history.pushState&&(this._history=this._window.history,l(this._window).add_event("popstate",function(){return t._invokeStateChanged()}));this._historyIndex=0}return n.prototype.getState=function(){try{var n=this._history&&this._history.state;return n&&n.state}catch(t){return Microsoft.Maps.logger&&Microsoft.Maps.logger.logCriticalError(t),null}},n.prototype.pushState=function(n,t){if(this._history&&(e.isMobile||!(u._isSmallMapShownOnSerp()||e.dynamicProperties.mapsOverlayClosing||u._isCommuteDashboardPage()))){if(this._historyIndex++,t){var i={state:n,index:this._historyIndex,url:t};this._history.pushState(i,null,t)}else this._history.pushState(n,null);this._setLocalStorageMapState(n)}},n.prototype.replaceState=function(n,t){if(this._history&&(e.isMobile||!(u._isSmallMapShownOnSerp()||e.dynamicProperties.mapsOverlayClosing||u._isCommuteDashboardPage()))){if(t){var i={state:n,index:this._historyIndex,url:t};this._history.replaceState(i,null,t)}else this._history.replaceState(n,null);this._setLocalStorageMapState(n)}},n.prototype.clearState=function(){this._history&&this._historyIndex>0&&(this._history.go(-1*this._historyIndex),this._historyIndex=0)},n.prototype.getLocalStorageState=function(){return k.isEnabled()?JSON.parse(k.getItem(n.historyLocalStorageKey)):null},n.prototype.clearLocalStorageState=function(){this._setLocalStorageMapState({})},n.prototype._setLocalStorageMapState=function(t){k.isEnabled()&&k.setItem(n.historyLocalStorageKey,JSON.stringify(t))},n.prototype._invokeStateChanged=function(){if(!e.dynamicProperties.mapsOverlayClosing&&!u._isCommuteDashboardPage()){try{var n=this._history.state;this._historyIndex=n?n.index:0}catch(t){Microsoft.Maps.logger&&Microsoft.Maps.logger.logCriticalError(t);this._historyIndex=0}this.statechanged.invoke(this.getState())}},n.historyLocalStorageKey="BingMapsState",n}(),oi=function(n){function t(t,i,r){var u=n.call(this)||this;return u.text=t,u._privates.defineProperty("cssClass"),u.setCssClass(i),u.handler=r,u.showSeparator=!1,u.mouseoverHandler=null,u}return w(t,n),t}(ft),vt=function(n){function t(t,i,r,u,f){var e=n.call(this)||this,o=e._privates;return o.defineProperty("title"),o.defineProperty("titleAction"),o.defineProperty("description"),o.defineProperty("actions"),o.defineProperty("address"),o.defineProperty("imageUrl"),o.defineProperty("nickname"),e.setTitle(t),e.setDescription(i),e.setAddress(f||""),r&&e.setTitleAction(r),u&&e.setActions(u),e}return w(t,n),t.prototype._createOverlayDataEntityAction=function(n,t,i,r){return r?new oi(n,t,i):{text:n,cssClass:t,handler:i,mouseoverHandler:null,showSeparator:!1,showSecText:!1,secText:null}},t.prototype.getMyPlacesAction=function(n,t,i,r){var u=s.L_OverlayEntity_SaveAsFavorite;return i&&(u=r?s.L_OverlayEntity_MoveTo:s.L_OverlayEntity_Save),this._createOverlayDataEntityAction(u,r?"savefavorite move":"savefavorite",t,n)},t.prototype.getDirectionsAction=function(n,t){return this._createOverlayDataEntityAction(s.L_OverlayEntity_Directions,"directions",t,n)},t.prototype.getGenericAction=function(n,t,i){return this._createOverlayDataEntityAction(n,t,i,!1)},t.prototype.getLocalListingAction=function(n,t){return this._createOverlayDataEntityAction(s.L_OverlayEntity_OpenCard,"opencard",t,n)},t.prototype.getLocalDetailsAction=function(n,t){return this._createOverlayDataEntityAction(s.L_OverlayEntity_OpenNewCard,"opennewcard",t,n)},t.prototype.getAddPushpinAction=function(n,t){return this._createOverlayDataEntityAction(s.L_OverlayEntity_AddAPushpin,"opencard",t,n)},t.prototype.getNearbyAction=function(n,t){return this._createOverlayDataEntityAction(s.L_OverlayEntity_Nearby,"nearby",t,n)},t.prototype.getStreetsideAction=function(n,t){return this._createOverlayDataEntityAction(s.L_OverlayEntity_Streetside,"streetside",t,n)},t.prototype.getBirdseyeAction=function(n,t){return this._createOverlayDataEntityAction(s.L_OverlayEntity_BirdseyeV2,"birdseyeV2",t,n)},t.prototype.getZoomAction=function(n,t){return this._createOverlayDataEntityAction(s.L_OverlayEntity_Zoom,"zoom",t,n)},t.prototype.getDirectionTaskOptions=function(n,t){var i=this.getDescription()||this.getTitle();return y.getDirectionTaskOptions(i,n,t,this.getTitle(),this.id)},t.prototype.getTravelTaskOptions=function(n){return y.getItineraryAddItemOptions(this.getTitle(),n,this.id,this.getImageUrl())},t.prototype.getMyPlacesTaskOptions=function(n){return y.getMyPlacesTaskOptions(this.getTitle(),n,this.getDescription(),this.getAddress(),this.getImageUrl())},t.prototype.getLocalDetailTaskOptions=function(n){var t={id:n};return{type:"LocalDetailsTask",state:t}},t}(ft),si=function(n){function t(t,i){var r=n.call(this)||this,u=r._privates;return u.defineProperty("cssScope"),u.defineProperty("htmlContent"),t&&r.setHtmlContent(t),i&&r.setCssScope(i),r}return w(t,n),t}(ft),hi=function(){function n(){}return n.prototype.createFromFeatureInfo=function(n){var t=n;return new b(t.name,"","ypid:"+t.ypid,p.createFrom(t.position),p.createFrom(t.position))},n}(),ci=function(){function n(n,t,i){var u=this,r;this._taskManager=t;this._map=i;r=n.getEventEmitter(tt.EventEmitterName.Label);this.disposables=[r.onClick.add(function(n){u.onClick(n)})]}return n.prototype.onClick=function(n){var r,u=(r=this._taskManager.getFocusedStack())===null||r===void 0?void 0:r.getForegroundTask(),s;if(n&&!(u&&u.disableFeatureClick())){var t=n.anchorPoint&&n.anchorPoint.coordinates?n.anchorPoint.coordinates:n.event.position,i=n.id,c=i&&i.startsWith("vdpid:")?i:"vdpid:".concat(i),e={entryPoint:"BasemapPrimitive",query:n.text,id:c,openingNewCard:!0,point:t&&t.length===2?[t[1],t[0]]:null},o=h.mapLabelFormCode;o&&(e.formCode=o);s={type:"PolygonEntityDetailsTask",state:e};f.invokeHandler("data-task",s)}},n.prototype.dispose=function(){this.isDisposed||(u._clearDisposables(this.disposables),u._nullifyClass(this),this.isDisposed=!0)},n}(),li=function(){function n(n,t,i){var u=this,r;this._taskManager=t;this._map=i;r=n.getEventEmitter(tt.EventEmitterName.Landmark);this.disposables=[r.onClick.add(function(n){u.onClick(n)})]}return n.prototype.onClick=function(n){var r,s=(r=this._taskManager.getFocusedStack())===null||r===void 0?void 0:r.getForegroundTask(),e,o,c,l,t,a,i;!n||s&&s.disableFeatureClick()||(n.type==="business"&&n.layerId.indexOf("lmk_3d")<0?(e={entryPoint:"Landmarks",id:"ypid:".concat(n.id),openingNewCard:!0,taskTitle:n.name,query:n.name},o=h&&h.landmarkFormCode,o&&(e.formCode=o),t={type:"LocalDetailsTask",requestState:e},f.invokeHandler("data-process",t),c={ID:"ypid:".concat(n.id),Z:this._map.getAzureMap().getCamera().zoom,L:location},i={logData:{feature:"L",action:"C",data:c}},f.invokeHandler("data-instrumentation",i),u.logMsnCfv("Landmarks")):n.type==="transit"&&g.isEnabled&&(l={id:n.id,title:n.name,location:p.createFrom(n.position||n.event.position),activationEntryPoint:1},t={type:"TransitStopTask",state:l},f.invokeHandler("data-task",t),a={Z:this._map.getAzureMap().getCamera().zoom,TM:n.bucket,L:location},i={logData:{feature:"TS",action:"MPC",data:a}},f.invokeHandler("data-instrumentation",i)))},n.prototype.dispose=function(){this.isDisposed||(u._clearDisposables(this.disposables),u._nullifyClass(this),this.isDisposed=!0)},n}(),ai=function(){function n(n,t){var r=new yt(n,null,null,h&&h.landmarkFormCode),u=new hi,i=new tt.BaseMapFeatureDelegate(n.getAzureMap()),f=i.getEventEmitter(tt.EventEmitterName.Landmark);f.setHelpers(r,u);this.disposables=[r,new li(i,t,n),new ci(i,t,n)]}return n.prototype.dispose=function(){this.isDisposed||(u._clearDisposables(this.disposables),u._nullifyClass(this),this.isDisposed=!0)},n}(),vi=function(){function n(n){var t=this;this._map=n;this._disposables=[];this._isRtl=u._isRtl();this._root=c._createElement("div").set_style({position:"absolute",width:"100%",height:"100%",pointerEvents:"none"});this._disposables.push(this._map.getOverlays().changed.add(function(n){return t._onOverlaysUpdated(n)}));this._onOverlaysUpdated({reset:!0})}return n.prototype._onOverlaysUpdated=function(n){var f,i,s,r,e,u,o,t;if(n.reset)for(f=this._map.getOverlays(),this._root.clear(),i=0,s=f.length;i<s;i++)t=f[i],this._addOverlay(t);else{if(n.added)for(r=0,e=n.added;r<e.length;r++)t=e[r],this._addOverlay(t);if(n.removed)for(u=0,o=n.removed;u<o.length;u++)t=o[u],this._removeOverlay(t)}},n.prototype._updateOverlay=function(n){var t=n.getAlignment();t instanceof p&&n.setOverlayElement(this._updateOverlayLocation(n.getOverlayElement(),t,n.getAnchor()))},n.prototype._updateOverlayLocation=function(n,t,i){var r=bt.tryLocationToPoint(this._map.getAzureMap(),t),f,u;return r&&(f=i?i.x:0,u={position:"absolute",top:r.y-(i?i.y:0)},this._isRtl?u.right=this._root.get_size().width-r.x-f:u.left=r.x-f,n.set_style(u)),n},n.prototype._addOverlay=function(t){var h=this,r=t.getOverlayElement(),u=t.getAlignment(),i=t.getAnchor(),o="auto",f="auto",e="auto",s="auto";if(i||(i=new ti(0,0)),r){if(u instanceof p)r=this._updateOverlayLocation(r,u,i);else if(typeof u=="number"){switch(u){case 1:o=-i.x+"px";e=-i.y+"px";break;case 0:o=-i.x+"px";f=-i.y+"px";break;case 3:s=-i.x+"px";e=-i.y+"px";break;case 2:s=-i.x+"px";f=-i.y+"px"}r.set_style({position:"absolute",left:this._isRtl?e:f,top:o,right:this._isRtl?f:e,bottom:s})}this._root.append(r);t[n._changedEventAttributeKey]=t.changed.add(function(){h._updateOverlay(t)})}},n.prototype._removeOverlay=function(t){var r=t.getOverlayElement(),i;r===null||r===void 0?void 0:r.removeFromParent();i=t[n._changedEventAttributeKey];i===null||i===void 0?void 0:i.dispose()},n.prototype.getRootElement=function(){return this._root[0]},n.prototype.dispose=function(){for(var n=this._disposables.length;n--;)this._disposables.pop().dispose();this._map=null;this._root&&this._root.clear();this._root=null},n._changedEventAttributeKey="om$changed",n}(),et;(function(n){function t(n){var t=function(t){n(t)};ni.instanceAsync("GeoDataAPIManager",t)}function i(n,i,r){var u=function(n){n.hasGeoPoliticalIssues?r("GeoPoliticalIssues"):n.results&&n.results.length>0&&n.results[0]?i(n):r("No result")},f=function(t){t.getEntityDetails(n,{lod:1,getEntityMetadata:!1,entityType:null},u,null,r)};t(f)}function r(n,i,r,f){if(r){var h=n.getCamera().zoom,c=u.convertZoom(ht.postCodeMinPushpinZoom,1),l=i.length,s=0,e=[],a=[],o=function(){if(s++,s>=l){var n=f||h>=c?e.concat(a):e;r(n)}},v=function(t){var r,i,u,f;t.results&&t.results.length>0&&t.results[0].Name?(r=t.results[0].Name.EntityName,r===t.location?(i=ri.fromGeoDataResult(t.results[0]),i&&e.push.apply(e,i),o()):(u=function(){o()},f=n.getCamera().bounds,(new ui).geocode(t.location,u,f,null,null,null))):o()},y=function(n){n.getBoundary(i,{entityType:"Postcode1",getAllPolygons:!0},v,null,o)};t(y)}}n.getCityPolygons=i;n.getZipCodePolygons=r})(et||(et={}));var yt=function(){function n(n,t,i,r){var f=this,u;this._buttonGroupViewModel=t;this._taskId=i;this._map=n;this._segmentClicked=!1;this._formCode=r;u=e.isInPrivateMode;this._buttonGroupViewModel=u?null:this._buttonGroupViewModel;this._cardLessMode=v.enableOneClickSave&&!this._buttonGroupViewModel;this._buttonGroupViewModel||this._cardLessMode||n.getContainer().instanceAsync("SaveDropdownControl",function(n){f._saveDropDown=n});this.disposables=[this.onSaveButtonClicked=new nt,this.onDirectionButtonClicked=new nt,this._saveDropDown]}return n.prototype.dispose=function(){this.isDisposed||(u._clearDisposables(this.disposables),u._nullifyClass(this),this.isDisposed=!0)},n.prototype.preProcessContent=function(n,t,i){var e=l(document.createElement("div")).set_html(n),u=e.select("div[data-answerinfo]"),f,r;return u&&u.length&&(f=u.get_attr("data-answerinfo"),f&&h.richInfoboxEnabledAnswerKeys.indexOf(f)>-1&&(r=this._moveButtons(e,t),r&&r.length>0&&i.getOptions().visible))?r[0].innerHTML:""},n.prototype.postProcessContent=function(n,t){t.infoboxClicked.reset();t.infoboxEnter.reset();t.infoboxLeave.reset();this._processResponse(n,t);this._createTaskClickHandler(n,t)},n.prototype._moveButtons=function(n,t){var i,f,e;if(n&&n.length&&(i=n.select(".overlay-container"),i&&i.length&&t)){var u=i.select(".b_entityTitle"),r=i.select(".b_mapbtns"),o=u.getParent(),h=s.SaveOnSerp_HoverTip,c=r.select("#newCollectAction");c.set_attr("title",h);c.set_attr("aria-label",h);f=r.select("#directionAction");e=s.L_OverlayEntity_Directions;f.set_attr("title",e);f.set_attr("aria-label",e);u.length&&r.length&&o.length&&(o.insertBefore(r,u),this._insertPrice(i,t))}return n},n.prototype._insertPrice=function(n,t){var i,r,u,e,o,s;if(t){var h=t.iconText,f=t.getSegmentTypes&&t.getSegmentTypes(),l=f&&f.length>0&&f[0]||t.getSearchCategory&&t.getSearchCategory()||t.getSelectedCategoryForIcon&&t.getSelectedCategoryForIcon();l&&!c._isHouseCategory(l)&&h&&(i=c._createElement("span"),i.add_class("lm_ritem"),r=c._createElement("div"),r.add_class("bm_lmrcon"),u=c._createElement("div"),u.add_class("lm_hpaprice"),u.appendText(h),u.appendTo(r),r.appendTo(i),e=n.select(".b_twoimages"),o=n.select(".b_mapbtns"),e.length>0?e[0].insertAdjacentElement("afterend",i[0]):o.length>0?o[0].insertAdjacentElement("beforeend",i[0]):(s=n.select(".b_entityTitle"),s.length>0&&s[0].insertAdjacentElement("beforebegin",i[0])))}},n.prototype._processResponse=function(n,t){var r=this,s=l(t.getRootNode()).select("div[data-itineraryfacts]").get_attr("data-itineraryfacts"),i=s&&JSON.parse(s),f,u,e,o;if(i&&n&&(i.Address&&(n.addressFields=i.Address),i.PhoneNumber&&(n.setPhone?n.setPhone(i.PhoneNumber):n.PhoneNumber=i.PhoneNumber),i.PriceInfo&&(n.fullPriceString=i.PriceInfo),i.AverageStay&&(n.averageStay=i.AverageStay),i.Categories&&(n.interests=i.Categories.join(", ")),i.Rating&&(n.rating=i.Rating),i.OpenHours&&(n.openHours=i.OpenHours),i.Action&&i.Action.ActionName&&i.Action.ActionUrl&&(n.actionName=i.Action.ActionName,n.actionUrl=i.Action.ActionUrl)),f=t.getRootNode(),f&&(u=l(f).select(".MapsInfoboxContainer.rich"),u.length>0&&n)){var h=u.select(".b_entityTitle"),c=u.select(".b_mapbtns"),a=h.getParent();h.length&&c.length&&a.length&&(e=c.select("a"),e.length&&e.for_each(function(i){i&&(i.setAttribute("target","_blank"),i.setAttribute("href","#"),i.setAttribute("role","button"),i.id&&(i.id.indexOf("newCollectAction")>-1?r._buttonGroupViewModel||v.enableOneClickSave&&r._cardLessMode?(r._buttonGroupViewModel||(r._buttonGroupViewModel=new Microsoft.Maps.ButtonGroupViewModel(r._map)),i.addEventListener("click",function(i){r.onSaveButtonClicked.invoke(n);r._saveClickHandler(i,n,u,t)}),i.addEventListener("keydown",function(i){var f=i;(f===null||f===void 0?void 0:f.keyCode)&&f.keyCode!==13||(r.onSaveButtonClicked.invoke(n),r._saveClickHandler(i,n,u,t))})):r._saveDropDown?r._setSaveDropDownControl(i,n,u,t):i.setAttribute("style","display: none"):i.id.indexOf("directionAction")>-1&&(i.addEventListener("click",function(t){r.onDirectionButtonClicked.invoke(n);r._directionClickHandler(t,n)}),i.addEventListener("keydown",function(t){var i=t;(i===null||i===void 0?void 0:i.keyCode)&&i.keyCode!==13||(r.onDirectionButtonClicked.invoke(n),r._directionClickHandler(t,n))}))))}));o=u.select(".b_sgmbtns a");o.length&&o.for_each(function(t){t.parentElement.tagName.toLowerCase().indexOf("li")>-1?(t.setAttribute("target","_blank"),t.addEventListener("click",function(n){return r._segmentClickHandler(n)}),t.addEventListener("keydown",function(n){return r._segmentClickHandler(n)})):(t.removeAttribute("target"),t.removeAttribute("href"),t.setAttribute("tabindex","0"),t.setAttribute("role","button"),t.addEventListener("click",function(t){r._buttonSegmentEventHandler(t,n)}),t.addEventListener("keydown",function(t){r._buttonSegmentEventHandler(t,n)}))})}},n.prototype._buttonSegmentEventHandler=function(n,t){var r=n,i,u,e;(r===null||r===void 0?void 0:r.keyCode)&&r.keyCode!==13||(i=this._createInfoTaskData(t),i&&(i.launchOverflowTaskOnTaskActivate=!0),u=c._overrideTasktypeBasedOnCategory("LocalDetailsTask",i),e={state:i,type:u,activateOptions:{parentId:this._taskId}},f.invokeHandler("data-task",e),this._segmentClickHandler(n))},n.prototype._createTaskClickHandler=function(n,t){var r=this,u=t.getRootNode(),i=l(u).select(".MapsInfoboxContainer.rich .infoBoxLink");n&&i.length>0&&(i.set_attr("aria-label",s.InfoboxListAriaLabel),t.infoboxClicked.addOne(function(){r._infoboxEventHandler(n)}),i.add_event("keydown",function(t){var i=t;(i===null||i===void 0?void 0:i.keyCode)&&i.keyCode!==13||r._infoboxEventHandler(n,t)}))},n.prototype._infoboxEventHandler=function(n,t){var i=this,r;if(this._segmentClicked){this._segmentClicked=!1;return}r=!0;this._map.getContainer().instanceAsync("TaskManager",function(t){var a=t===null||t===void 0?void 0:t.getStacks(),h,e,o,u,s,v,l,y,p;(a===null||a===void 0?void 0:a.length)&&(h=t.getFocusedStack().getForegroundTask(),h.id.toLowerCase().indexOf("details")>-1&&(e=h._getTaskState(),(e===null||e===void 0?void 0:e.id)&&(o=":YN",u=n===null||n===void 0?void 0:n.id,(u===null||u===void 0?void 0:u.indexOf(o))>-1&&(u=u.replace(o,":")),s=e.id,s.indexOf(o)>-1&&(s=s.replace(o,":")),s===u&&(v={action:"focus",id:h.id},f.invokeHandler("data-task",v),r=!1))));r&&(l=i._createInfoTaskData(n),l&&(y=c._overrideTasktypeBasedOnCategory("LocalDetailsTask",l),i._logClick(n),p={state:l,type:y,activateOptions:{parentId:i._taskId}},f.invokeHandler("data-task",p)))});u.logMsnCfv("Infobox");t&&(t.preventDefault(),t.stopImmediatePropagation())},n.prototype._createInfoTaskData=function(n){var t,u,i,r;return n?(t={entryPoint:"Infobox",id:n.id,selectedCategoryId:n.getSelectedCategoryForIcon&&n.getSelectedCategoryForIcon(),flippingCard:!0,taskTitle:a.getDisplayName(n),listingCategoryPath:n.getPrimaryCategoryPath&&n.getPrimaryCategoryPath(),asName:n.getTitle&&n.getTitle(),asFormattedAddress:n.getAddress&&n.getAddress(),localFilters:n.getLocalFilters()},this._formCode&&(t.formCode=this._formCode),u=n.id.indexOf("eventId")>-1,u&&(i=n.getLocation(),r=n.getCity(),i&&(t.latLongForEventRequery=i.latitude+","+i.longitude,t.locationForEventRequery=r?r:"undefined")),c._updateSearchTaskStateWithAdsData(t,n),t):null},n.prototype._segmentClickHandler=function(n){var t=n,i;(t===null||t===void 0?void 0:t.keyCode)&&t.keyCode!==13||(this._segmentClicked=!0,i={logData:{feature:"INF",action:"C",data:{AN:"Segment",EP:"Infobox"}},impressionGuid:this._getOwnerIG()},f.invokeHandler("data-instrumentation",i))},n.prototype._getOwnerIG=function(){for(var r,u,t=l(".taskCard.focus"),i=0;i<t.length;i++)if(r=t[i].getAttribute("data-subtaskid"),this._taskId&&r&&r.indexOf(this._taskId)>-1&&(u=t.select("div[data-ig]"),u.length>0))return u.get_attr("data-ig");return n._tabID},n.prototype._logClick=function(n){if(n){var i=a.isLandmarkEntity(n)?e.dynamicProperties.mapsIG:this._getOwnerIG(),t=this._getlogData(n,"C");t.impressionGuid=i;f.invokeHandler("data-instrumentation",t)}},n.prototype._getlogData=function(n,t){var i="",r,u;this._taskId&&(r=this._taskId.indexOf("$"),i=r>-1?this._taskId.substring(0,r):this._taskId);i=i||"Landmark";var f="",e="",o="";return n&&(f=a.getYpid(n),e=a.getDisplayName(n),o=this._getSearchCategoryFromEntity(n)),u={logData:{feature:"INF",action:t,data:{SRC:i,TYP:o,LBL:e,ID:f}}},t==="C"&&(u.logData.data.Q=a.getDisplayName(n)),u},n.prototype._getSearchCategoryFromEntity=function(n){var i,r,u,f,t;return a.isLandmarkEntity(n)?"Landmark":(t=n,t)?((i=t.getPrimaryCategoryName)===null||i===void 0?void 0:i.call(t))||((r=t.getSearchCategory)===null||r===void 0?void 0:r.call(t))||((u=t.getSelectedCategoryForIcon)===null||u===void 0?void 0:u.call(t))||((f=t.getPrimaryCategoryPath)===null||f===void 0?void 0:f.call(t))||"":""},n.prototype._saveClickHandler=function(n,t,i,u){var p=this,e,o,c,a,y;n&&(n.stopPropagation(),n.preventDefault());e=t;o=e&&e.getRoutableLocation&&e.getRoutableLocation();o||(o=u.getOptions().location);var s="Infobox",w=new r.SignInState,h={logData:{feature:"INF",action:"C",data:{AN:"CollectionsMenu",EP:s}},impressionGuid:this._getOwnerIG()};f.invokeHandler("data-instrumentation",h);(this._buttonGroupViewModel||v.enableOneClickSave&&this._cardLessMode)&&(c=this._buttonGroupViewModel.getSaveButton(),c&&c.length!==0||this._buttonGroupViewModel.setSaveButton(l(n.target)),v.enableOneClickSave&&this._cardLessMode?(t.imageUrl=this._getImageURL(e,i),a=function(n){p._processCallback(n,e,o)},this._buttonGroupViewModel.setEntityData(t,{processCallback:a},i)):this._buttonGroupViewModel.setEntityData(t,{requestorType:"LocalSearchTask",requestorId:this._taskId},i),v.enableOneClickSave&&i.length>0&&(y=i.select(".b_twoimages"),y.length>0&&i.add_class("bm_images")),w.getIsSignedIn()?this._buttonGroupViewModel.collectionMenuButtonClicked(n,o,h,s):this._buttonGroupViewModel.collectionButtonClicked(n,o,h,s))},n.prototype._processCallback=function(n,t,i){if(v.enableOneClickSave&&n&&n.inData&&n.processorType==="CollectionsTask"&&this._buttonGroupViewModel){var r=y.getMyPlacesTaskOptions(a.getDisplayName(t),i,t.dn);r.state.data.id=t.id;this._buttonGroupViewModel.processCollectionsData(n,r)}},n.prototype._setSaveDropDownControl=function(n,t,i,r){var o=this,f,u;if(n){if(f=n.parentElement,!f)return;f.removeChild(n);var e=this._saveDropDown.getControl(),s=e.select(".saveDropdown.popOutTop"),h=s.removeFromParent();i.append(h);f.appendChild(e[0]);u=e.select(".saveButton");u.has_class("saved")&&u.remove_class("saved");this._saveDropDown.setShowSaveButton(!0);this._buildSaveDropDownData(t,r);this._saveDropDown.setPreventDefaultClick(!1);u[0].addEventListener("click",function(n){o._saveDropDownEventHandler(n,u)});u[0].addEventListener("keydown",function(n){o._saveDropDownEventHandler(n,u)})}},n.prototype._saveDropDownEventHandler=function(n,t){var i=this;n.preventDefault();n.stopPropagation();this._saveDropDown.saveOnInfoboxClicked(n,function(n){if(n===CollectionResources.SavedOnInfobox){t.add_class("saved");var r={logData:{feature:"INF",action:"C",data:{AN:"CollectionsMenu",EP:"Infobox"}},impressionGuid:i._getOwnerIG()};f.invokeHandler("data-instrumentation",r)}},!1)},n.prototype._buildSaveDropDownData=function(n,t){var r=n,u=r&&r.getRoutableLocation?r.getRoutableLocation():null,f,e;u||(u=t.getOptions().location);var o=this._getSearchCategoryFromEntity(n),s=this._getImageURL(r,l(t.getRootNode())),h=r&&r.getAddress&&r.getAddress(),c=r&&r.addressFields,i=a.getYpid(n);i.indexOf("ypid:")>-1&&(i=i.split("ypid:")[1]);i&&i.toUpperCase().indexOf("YN")===-1&&(i="YN"+i);i=i||"";f={id:i,title:a.getDisplayName(n),location:u,categoryId:o,photoUrl:s,address:h,addressFields:c};e={action:18,data:f};this._saveDropDown.setEntityInformation(e)},n.prototype._getImageURL=function(n,t){var u=window.location.hostname,i,r,f,e;if(n instanceof b&&n.getImageUrl()){if(i=n.getImageUrl(),i)return i.indexOf(u)>-1?i:u.concat(i)}else if(r=t.select(".b_twoimages"),r&&r.length>0&&r[0].childElementCount>0&&(f=r.select(".cico img"),f.length>0&&(e=f.get_attr("href"),e)))return u.concat(e);return""},n.prototype._directionClickHandler=function(n,t){var i;n&&(n.stopPropagation(),n.preventDefault());i={logData:{feature:"INF",action:"C",data:{AN:"Directions",EP:"Infobox"}},impressionGuid:this._getOwnerIG()};f.invokeHandler("data-instrumentation",i);var u=t.getAddress?t.getAddress():null,e=t.getRoutableLocation?t.getRoutableLocation():null,o=a.getDisplayName(t);c.checkDirectionsControl(function(){var n=new r.DirectionsControl.Waypoint(u,e,o,!1,null,t.id,null,null,null,2,1,null),i={entryPoint:3,waypoints:[n]};f.invokeHandler("data-task",{type:"DirectionsTask",state:i})})},n._tabID=u._hasBingHeaders()&&_G.IG,n}(),yi=function(n){function t(t,i,r,u,f,e,o,s){var h=n.call(this)||this;return h.geometryType=2,h._index=i,h.crs=at.instance,h.geometryType=2,h._locations=t,h._updateLineGeometry(),h._mapType=r,h._taskState=1,h.subLegIndex=f,h.legIndex=u,h._routeMode=e,h._numberOfViaPoints=o,h._maneuverType=s,h.isHidden=!1,h}return w(t,n),t.prototype.getLocations=function(){return this._locations},t.prototype.getIndex=function(){return this._index},t.prototype.update=function(){this._changeTemplate(this.isHidden?null:this.createOptions(this._isRouteSelected,this._taskState,this._maneuverType,this._routeMode))},t.prototype.getMapType=function(){return this._mapType},t.prototype.getRouteMode=function(){return this._routeMode},t.prototype.getNumberOfViaPoints=function(){return this._numberOfViaPoints},t.prototype.getManeuverType=function(){return this._maneuverType},t.prototype.isTapEnabled=function(){return!0},t.prototype.isDragEnabled=function(){return this._isAddingViaAllowed()},t.prototype.isHoverEnabled=function(){return this._isAddingViaAllowed()||!this.isRouteSelected()},t.prototype.isRouteSelected=function(){return this._isRouteSelected},t.prototype.setVisibility=function(n){this.isHidden=!n;this.update()},t.prototype.changeRouteSelectionState=function(n){this._isRouteSelected=n},t.prototype.changeCardTaskState=function(n){this._taskState=n},t.prototype.changeMapType=function(n){this._mapType=n},t.prototype._changeTemplate=function(n){if(!n||!n.visible){this.bucket=null;return}this.bucket=n.bucket;this.stylesheetEntry=n.stylesheetEntry},t.prototype._isAddingViaAllowed=function(){return!1},t.prototype._updateLineGeometry=function(){for(var n=this.getLocations(),r=new Array(n.length),i=new Array(n.length),t=i.length;t--;)i[t]=n[t].longitude,r[t]=n[t].latitude;var u=new kt,f=u.accumulateLocations(n),e={generalizable:!0,x:i,y:r,bounds:f};this.geometry=e},t}(gt),pi=function(){function n(t,i,u,f,e,o,s,h,l,a,v){var y=this;this.geometryType=1;this.crs=at.instance;this.geometryType=1;this.geometry={x:0,y:0,bounds:null};this.id="Direction Pin"+n._index++;this.entity=new vt(h,null);this.entity.id=this.id;this.revision=0;this.pushpinIconType=i;this._isInteractive=f;this.setLocation(t);this._maneuverType=e;this.taskState=1;this.stopPointIndex=o;this.viaPointIndex=s;this.setVisibility(!a);this.routeMode=u;this.instructionViewModel=v;c.checkDirectionsControl(function(){y.bucket=r.DirectionsControl.RoutePinBucketMap[i]})}return n.prototype.setLocation=function(n){this._location=n;this._updatePointGeometry(this._location)},n.prototype.getLocation=function(){return this._location},n.prototype.getManeuverType=function(){return this._maneuverType},n.prototype.changeRouteSelectionState=function(n){this.isRouteSelected=n;this.setVisibility(n)},n.prototype.changeCardTaskState=function(n){this.taskState=n;this.setVisibility(n===1)},n.prototype.setVisibility=function(n){this.viewState=n?2:7;this.revision++;this.entity.changed.invoke()},n.prototype.update=function(){this.revision++;this.viewState=this.taskState===1&&this.isRouteSelected?2:7},n.prototype.isTapEnabled=function(){return!0},n.prototype.isHoverEnabled=function(){return this._isInteractive},n.prototype.isDragEnabled=function(){return(this.routeMode===2||d.enableMultiMode&&this.routeMode===5)&&this._isInteractive?this.pushpinIconType==="start"||this.pushpinIconType==="end"||this.pushpinIconType==="middle":this._isInteractive},n.prototype._updatePointGeometry=function(n){var t=n.latitude,i=n.longitude;this.geometry.x=i;this.geometry.y=t;this.geometry.bounds=[t,i,t,i]},n._templateCache=new dt(64),n._index=0,n}(),wi=function(){function n(t,r){var o,c,f,s,u,e;this._taskManager=r;this._taskBar=t;o=[];this._requestCompatibilityParams=!1;for(c in i.supportedSchemas)o=o.concat(i.supportedSchemas[c].supportedFeatures),o=o.filter(function(n,t){return o.indexOf(n)===t});for(this._referrerFormCodeRegex=/form=([^&]*)/ig,this._longLinkBase="",this._queryConstants="",f={},s=0;s<o.length;s++)f[o[s]]=!0;u=this._taskToFeatureMap={};e=this._featureToTaskMap={};e.taskFramework="taskFramework";u.taskFramework="taskFramework";e.shareImage="shareImage";u.shareImage="shareImage";(h===null||h===void 0?void 0:h.isEnabled)&&f.LocalListing&&(u.LocalListingTask="localListing");(g===null||g===void 0?void 0:g.isEnabled)&&(f.TransitStop&&(u.TransitStopTask="transitStop",e.transitStop="TransitStopTask"),f.NearbyTransit&&(u.NearbyTransitTask="nearbyTransit",e.nearbyTransit="NearbyTransitTask"),f.TransitLine&&(u.TransitLineTask="transitLine",e.transitLine="TransitLineTask"));(h===null||h===void 0?void 0:h.isEnabled)&&f.LocalDetails&&(u.LocalDetailsTask="localDetails");(v===null||v===void 0?void 0:v.isEnabled)&&f.Collections&&(u.CollectionsTask="collections",e.collections="CollectionsTask");ct.enableMyContributions&&f.MyContributions&&(u.MyContributionsV3Task="myContributions",e.myContributions="MyContributionsV3Task");ct.enableMyRewards&&f.MyContributions&&(u.MyContributionsAndRewardsTask="myContributionsAndRewards",e.myContributionsAndRewards="MyContributionsAndRewardsTask");(d===null||d===void 0?void 0:d.isEnabled)&&f.Directions&&(u.DirectionsTask="directions",e.directions="DirectionsTask");(rt===null||rt===void 0?void 0:rt.isEnabled)&&f.Traffic&&(u.TrafficTask="traffic",e.traffic="TrafficTask");(ut===null||ut===void 0?void 0:ut.isEnabled)&&f.ItineraryDetails&&(u.ItineraryDetailsTask="itineraryDetails",e.itineraryDetails="ItineraryDetailsTask");f.Feedback&&(u.FeedbackTask="feedback",e.feedback="FeedbackTask");n._buildStyleMappings(u,e)}return n.getShortenServiceUrl=function(n){return i.shorteningServiceUrl.replace("{path}",encodeURIComponent("~".concat("/",i.shellPath,"?",n))).replace("{hostname}",window.location.hostname)},n.prototype.getQueryParameters=function(t,r,u,f){for(var l,s,o,h,y,p,a=[],w=0,c=0,v=Object.keys(t);c<v.length;c++){if(l=v[c],s=l,!(s in this._featureToTaskMap)){if(!(s in this._taskToFeatureMap))continue;s=this._taskToFeatureMap[s]}a.push({id:(w++).toString(),featureType:s,data:JSON.stringify(t[l])})}o={};o.v=i.currentProtocolVersion.toString();o.sV=i.currentSchemaVersion.toString();this._referrerFormCodeRegex.lastIndex=0;h=this._referrerFormCodeRegex.exec(window.location.search);h&&h.length>1&&(o.form=h[1]);e.testHooksEnabled&&(o.testhooks="1");i.enableLandingPageChanges&&(o[i.landingPageChangeParameter]="1");e.isOnCorpnet&&e.isOnChina&&e.dynamicProperties.clientIP&&(o.clientip=e.dynamicProperties.clientIP);y={queryParameters:o,onSuccess:function(t){if(r){var i=JSON.parse(t),e=i&&i.permalink;f&&(f.PSR=e?"pass":"fail",f.PL=i.permalink,n.instLog("GPL",f));e?r&&r(i):u&&u()}},onError:function(){f&&(f.PSR="fail",n.instLog("GPL",f));u&&u()}};p="/"+i.serviceEndpoint;lt.doPost(p,JSON.stringify(a),y)},n.prototype.getGeneralPermalink=function(t,r,u,f,e){var l=this,o={},v=!1,h={EP:f?f:"",PSR:"",PL:""},w=n._getModeHelper(t,o,h),y=function(n,t,i,r){var u=function(n,i){l._onPermalinkCallSuccess(n,t,i)},f=function(n,t){l._onPermalinkCallFailure(i,n,t)};l.getQueryParameters(n,u,f,r)},s,p,a,c;this._taskManager&&(i.enableMultipleCardSharing?(s=void 0,i.currentSchemaVersion===1?(s=this._taskManager.serialize(!0,i.currentSchemaVersion,e),s.buildBackwardCompatibleUrl=this._requestCompatibilityParams,o.taskFramework=s):i.currentSchemaVersion===2&&(s=this._taskManager.serialize(!0,i.currentSchemaVersion,e),s.buildBackwardCompatibleUrl=this._requestCompatibilityParams,o.taskFramework={objectStoreId:this._permalinkEntities&&this._permalinkEntities[n.osidQueryParamName]?this._permalinkEntities[n.osidQueryParamName].partValue:"",data:JSON.stringify(s)}),h.FN=["TM"],v=!0,p=new ot(o[w],s),p.createShareImage(function(n){n&&(o.shareImage={data:n});y(o,r,u,h)})):(a=this._taskManager.getFocusedStack(),a&&(c=a.getForegroundTask(),o[c.type]=c.serialize(),h.FN=[this._getFeatureLoggingCode(c.type)])));v||y(o,r,u,h)},n.prototype._onPermalinkCallSuccess=function(t,r,u){function s(n,t){var i=n[t];return i||(i={isEnabled:!0},n[t]=i),i}var e,h,c,w,l,y,f,p,a,o,v,b;if(i.enableMultipleCardSharing&&(this._permalinkEntities={},this._queryConstants="",this._longLinkBase="",e=this._taskManager.getStacks(),h=t.permalink,h&&(c=h.split("?"),c.length===2))){for(this._longLinkBase=c[0]+"?",w=c[1].split("&"),l=0,y=w;l<y.length;l++)if(f=y[l],f)if(f.indexOf("tsts")===0){if(p=parseInt(f.slice(4,f.indexOf("="))),a=e[p],!a)continue;o=s(this._permalinkEntities,a.getForegroundTask().id);o.partValue=f}else if(f.indexOf("tstt")===0){var p=parseInt(f.slice(4,f.indexOf("="))),a=e[p],o=s(this._permalinkEntities,a.getForegroundTask().id);o.title=f}else f.indexOf(n.osidQueryParamName)===0?(o=s(this._permalinkEntities,n.osidQueryParamName),o.partValue=f.substring(f.indexOf("=")+1,f.length)):f.length>0&&(this._queryConstants+="&"+f);if(this._permalinkEntities[n.osidQueryParamName]){for(v=0,b=e.length;v<b;v++)s(this._permalinkEntities,e[v].getForegroundTask().id);this._currentLongLink=h;this._currentPermalinkEntitiesHash=this._getLinkEntitiesHash()}}r&&r(t,u)},n.prototype._onPermalinkCallFailure=function(n,t,i){this._permalinkEntities=null;this._currentPermalinkEntitiesHash=null;this._currentShortLink=null;n&&n(t,i)},n.prototype.shorten=function(t,i,r,u){var f=this,e,o;this._permalinkEntities||i&&i("initial permalink hasn't been requested yet.");!this._currentShortLink||this._currentShortlinkEntitiesHash!==this._getLinkEntitiesHash()||r||u?(e=this._constructCurrentQueryParams(r),u&&e.toLowerCase().indexOf("form=")!==-1&&(e=e.replace(/(form=).*?(&|$)/,"$1"+u+"$2")),o=n.getShortenServiceUrl(e),o.length>n.maxIeUrlLength&&(this._currentShortLink=null,this._currentShortlinkEntitiesHash=null,i()),lt.downloadJson(o,"permalink",function(n){r||u||(f._currentShortLink=n.d,f._currentShortlinkEntitiesHash=f._getLinkEntitiesHash());t&&t(n.d,f._longLinkBase+e)},function(){f._currentShortLink=null;f._currentShortlinkEntitiesHash=null;n.instLog("SEW",{SL:o,ERR:6});i&&i()}),n.instLog("GSL",{SL:o})):t&&t(this._currentShortLink)},n.prototype.isShorteningAvailable=function(){if(this._permalinkEntities!==null){var t=n.getShortenServiceUrl(this._constructCurrentQueryParams());if(t.length<=n.maxIeUrlLength)return!0}return!1},n.prototype.getPermalinkParts=function(){return this._permalinkEntities},n.prototype.getCurrentLink=function(t,r,u){var l=this,a,e,h,y,p,c,k,w,b,d;if(!this._permalinkEntities)throw new Error("initial permalink hasn't been requested yet.");if(i.currentSchemaVersion===2&&this._currentPermalinkEntitiesHash!==this._getLinkEntitiesHash()){e={};n._getModeHelper(t,e);var o=this._taskManager.getStacks(),f={focusedStackIndex:-1,stacks:[],isFocusedStackInCollapsedState:!1},g=this._taskManager.getFocusedStack(),s=void 0,v=o?o.length:0;for(v>1&&(h=o[v-1].getForegroundTask(),!h||h.type!=="CollectionsTask"||h.isPublicCollection&&h.isPublicCollection()||(y=o[v-2],y.displayState.isHidden=!1,p=y.getForegroundTask(),p.displayState.isHidden=!1,p.displayState.activationState=1)),c=0,k=o.length;c<k;c++)s=o[c],w=s.getForegroundTask().id,this._permalinkEntities[w]&&((a=this._permalinkEntities[w])===null||a===void 0?void 0:a.isEnabled)&&(f.stacks.push(s.serialize(!0,i.currentSchemaVersion)),s===g&&(f.focusedStackIndex=f.stacks.length-1));s&&(f.focusedStackIndex===-1&&(f.focusedStackIndex=f.stacks.length-1),e.taskFramework={objectStoreId:this._permalinkEntities&&this._permalinkEntities[n.osidQueryParamName]?this._permalinkEntities[n.osidQueryParamName].partValue:"",data:JSON.stringify(f)},b=t.viewChangeWatcher,b&&(d=new ot(b.getMapState(),f),d.createShareImage(function(n){n&&(e.shareImage={data:n});l.getQueryParameters(e,function(n){l._onUpdatePermalinkCallback(n,r)},function(){u&&u()})})));s||this.getQueryParameters(e,function(n){l._onUpdatePermalinkCallback(n,r)},function(){u&&u()})}else r(this._longLinkBase+this._constructCurrentQueryParams())},n.prototype._onUpdatePermalinkCallback=function(t,i){if(this._currentPermalinkEntitiesHash=this._getLinkEntitiesHash(),this._currentLongLink=t.permalink,this._permalinkEntities[n.osidQueryParamName]){var r=new URL(this._currentLongLink),u=r.searchParams.get(n.osidQueryParamName)||"";this._permalinkEntities[n.osidQueryParamName].partValue=u}i&&i(t.permalink)},n.prototype._getLinkEntitiesHash=function(){for(var r,t="",n=0,i=Object.keys(this._permalinkEntities);n<i.length;n++)r=this._permalinkEntities[i[n]],r.isEnabled&&(t+=(t===""?"":"_")+i[n]);return t},n.prototype.getPrintParameters=function(){},n.prototype.processSharedStates=function(t,r){var l,w,b,tt,h,v,k,a,d,y,it;if(t&&(!t||t.length!==0)){var g=[],nt=[],s=this._featureToTaskMap,o=this._taskToFeatureMap,p=!1;for(l=0,w=t;l<w.length;l++)if(a=w[l],b=a.featureType,b in s&&s[b]==="modestreetside"){p=!0;break}for(tt=function(n){var l=n.featureType,w=n.data,t=JSON.parse(w),it,y,b,a,k,v,d,tt;t&&(t.disableHistoryPointCreation=!0,!t.entryPointInstrumented&&t.mapsEntryPointState&&(it={logData:{feature:"TM",action:"EntryPointInst",data:t.mapsEntryPointState},impressionGuid:e.dynamicProperties.mapsIG},f.invokeHandler("data-instrumentation",it),t.entryPointInstrumented=!0));p||(l===o.LocalDetailsTask||l===o.LocalListingTask?(h._taskBar&&t&&t.query&&h._taskBar.setSearchTerm(t.query),y="LocalSearchTask",b=!1,t&&(t.entryPoint="Permalink",a="LocalSearchTask",l===o.LocalDetailsTask?a="LocalDetailsTask":l===o.LocalListingTask&&(a="LocalListingTask"),k=c._overrideTasktypeBasedOnCategory(a,t),k!==a&&(y=k,b=!0),t.mapBounds=u.convertMapBoundsOrder(t.mapBounds,1)),b?f.invokeHandler("data-task",{type:y,state:t}):f.invokeHandler("data-process",{type:y,requestState:t})):l in s&&(p||(l===o.taskFramework?(v=t,i.readSchemaVersion===2&&v.data&&(v=JSON.parse(v.data)),h._taskManager.deserialize(v)):(l===o.DirectionsTask?t.entryPoint=4:l===o.MyContributionsV3Task&&o.MyContributionsAndRewardsTask&&(l=o.MyContributionsAndRewardsTask),d=s[l],tt=function(){f.invokeHandler("data-task",{type:d,state:t})},d==="CollectionsTask"?r.getAzureMapFirstIdle().then(tt):tt()))));g.push(h._getFeatureLoggingCode(s[l]));nt.push(w?w:"")},h=this,v=0,k=t;v<k.length;v++)a=k[v],tt(a);d=i.formCode;this._referrerFormCodeRegex.lastIndex=0;y=this._referrerFormCodeRegex.exec(window.location.search);y&&y.length>1&&(d=y[1]);it={FN:g,PSD:nt,RF:d};n.instLog("PSS",it)}},n.instLog=function(n,t){var i={logData:{feature:"SH",action:n,data:t},isMapsAction:n!=="EC"};f.invokeHandler("data-instrumentation",i)},n.prototype._getFeatureLoggingCode=function(n){switch(n){case"CollectionsTask":return"CX";case"DirectionsTask":return"DD";case"LocalDetailsTask":case"LocalListingTask":case"LocalSearchTask":return"SR";default:return""}},n.prototype._constructCurrentQueryParams=function(t){var o="",a="",v="",s=null,h=Object.keys(this._permalinkEntities),f,e,c,u,i;if(this._permalinkEntities[n.osidQueryParamName])o+=(o.length?"&":"")+n.osidQueryParamName+"="+this._permalinkEntities[n.osidQueryParamName].partValue;else for(f=h.length-1;f>=0;f--)e=this._permalinkEntities[h[f]],e.isEnabled&&(o+="&"+e.partValue+(e.title?"&"+e.title:""),s||(s=h[f]));var y=this._taskManager.getFocusedStack(),p=y&&y.getForegroundTask(),l=p&&this._permalinkEntities[p.id],r=null;l&&l.isEnabled?r=l:s&&(r=this._permalinkEntities[s]);c=null;r&&r.partValue&&(u=r.partValue.split("="),u.length===2&&(c=/\d+/i.exec(u[0])[0],a=decodeURIComponent(decodeURIComponent(u[1]))),r.title&&(u=r.title.split("=")),u.length===2&&(v="&tt="+u[1]));c&&(this._queryConstants=this._queryConstants.replace(/ftst=\d+/i,"ftst="+c));i=a+v;h.length>0&&(i+=o);i+=this._queryConstants;switch(t){case 1:i=i.replace(/form=[a-z0-9]+/i,"form="+n.facebookFormCode);break;case 2:i=i.replace(/form=[a-z0-9]+/i,"form="+n.twitterFormCode)}return i},n._getModeHelper=function(n,t,i){var r=n.getStyle(),o=n.viewChangeWatcher,e,u,f;return r&&o&&(u=void 0,f=void 0,r==="streetside"?(u="SS",f=["SS"]):(r="road",u="CM",f=[]),e="mode"+r,t[e]=o.getMapState(),i&&(i.MM=u,i.FN=f)),e},n._buildStyleMappings=function(n,t){var r="moderoad",i;t.compositeMapMode=r;n[r]="compositeMapMode";(it===null||it===void 0?void 0:it.isEnabled)&&(i="modestreetside",t.streetside=i,n[i]="streetside")},n.maxIeUrlLength=2083,n.maxAllowedSharingLinkLength=n.maxIeUrlLength-128,n.osidQueryParamName="osid",n.facebookFormCode="LMLTFB",n.twitterFormCode="LMLTTW",n}(),o;(function(n){n[n.BusinessWith4Images=0]="BusinessWith4Images";n[n.BusinessWith2Images=1]="BusinessWith2Images";n[n.BusinessWith1Image=2]="BusinessWith1Image";n[n.AddressWith2Images=3]="AddressWith2Images";n[n.MapWith0Image=4]="MapWith0Image"})(o||(o={}));ot=function(){function n(n,t){var i,u,s,f;if(this._imageUrls=[],this._imageWidths=[],this._imageHeights=[],this._imageTopPositions=[],this._imageLeftPositions=[],this._pushpins=[],this._template=o.MapWith0Image,this._modeState=n,t&&t.stacks&&t.stacks.length){var h=t.focusedStackIndex?t.focusedStackIndex:0,e=t.stacks[h],r=e?e.tasks[e.tasks.length-1]:null;if(r&&(r.type==="LocalDetails"||r.type==="LocalListing"||r.type==="PolygonEntityDetails")&&r.state){i=r.state;i.imgUrls&&Array.prototype.push.apply(this._imageUrls,i.imgUrls);this._imageUrls=this._cleanImageUrls(this._imageUrls);switch(this._imageUrls.length){case 0:this._template=o.MapWith0Image;break;case 1:this._template=o.BusinessWith1Image;break;case 2:case 3:this._template=o.BusinessWith2Images;this._imageUrls=this._imageUrls.slice(0,2);break;default:this._template=o.BusinessWith4Images;this._imageUrls=this._imageUrls.slice(0,4)}if(i.primerPois)for(u=0;u<i.primerPois.length;u++)s=i.primerPois[u].entity,i.primerPois.length===1&&this._imageUrls.length===0&&(this._template=o.AddressWith2Images,this._query=s.subtitle),f=i.primerPois[u].geometry,f&&this._pushpins.push({location:new p(f.y,f.x)});else i.point&&r.type==="LocalDetails"&&(i.scenarioKey==="MA_ADDR"&&this._imageUrls.length===0&&(this._template=o.AddressWith2Images,this._query=i.taskTitle),this._pushpins.push({location:new p(i.point[0],i.point[1])}))}}}return n.prototype.createShareImage=function(n){var f=this,r,t,u,e;this._setTemplateSize(this._template);this._addMapImages(this._template);r=this._imageUrls=this._reformatImageSizes(this._imageUrls,this._imageWidths,this._imageHeights);r.length===0&&n();t=document.createElement("canvas");t.width=i.shareImgWidth;t.height=i.shareImgHeight;u=t.getContext("2d");u.fillStyle=i.shareImgMarginFill;u.fillRect(0,0,i.shareImgWidth,i.shareImgHeight);e=function(i){var e,o;if(i&&i.length===r.length)try{for(e=0;e<i.length;e++)o=i[e],u.drawImage(o,f._imageLeftPositions[e],f._imageTopPositions[e]);n(t.toDataURL("image/jpeg",.8))}catch(s){n()}else n()};this._loadImages(r,e)},n.prototype._setTemplateSize=function(n){var t=i.shareImgMargin;switch(n){case o.BusinessWith4Images:this._imageWidths=[250,110-t,240-t,175-t,175-t];this._imageHeights=[315,155,155,160-t,160-t];this._imageLeftPositions=[0,250+t,360+t,250+t,425+t];this._imageTopPositions=[0,0,0,155+t,155+t];break;case o.BusinessWith2Images:case o.AddressWith2Images:this._imageWidths=[420,180-t,180-t];this._imageHeights=[315,160-t,155];this._imageLeftPositions=[0,420+t,420+t];this._imageTopPositions=[0,0,160];break;case o.BusinessWith1Image:this._imageWidths=[600,180];this._imageHeights=[315,90];this._imageLeftPositions=[0,420];this._imageTopPositions=[0,225]}},n.prototype._addMapImages=function(n){var e=this,s,u,i,t,f,r;n!==o.MapWith0Image&&(u=0,i=this._modeState,i&&(s=i.centerPoint,u=i.level),t={width:this._imageWidths.length>0&&this._imageWidths[0],height:this._imageHeights.length>0&&this._imageHeights[0],centerPoint:s,zoomLevel:u,pushpins:this._pushpins},n!==o.AddressWith2Images?(f=this._createMapSnippetUrl(t),f&&this._imageUrls.splice(0,0,f)):this._imageHeights.length>2&&this._imageWidths.length>2&&(this._imageUrls=[],r=function(n){var t=e._createMapSnippetUrl(n);t&&e._imageUrls.push(t)},r(t),t.width=this._imageWidths[1],t.height=this._imageHeights[1],t.imagerySet="Aerial",r(t),t.width=this._imageWidths[2],t.height=this._imageHeights[2],t.imagerySet="StreetSide",t.query=this._query,r(t)))},n.prototype._createMapSnippetUrl=function(t){var u=!1,r=i.mapSnippetUrl,s,f,h,o;if(t.imagerySet==="Aerial")r=r.replace("Road","Aerial");else if(t.imagerySet==="StreetSide"&&t.query)r=r.replace("Road","StreetSide"),n._latlonRegex.test(t.query)?(s=t.query.replace(/ /g,""),r+="/"+s+"/"+s+"?"):r+="/"+encodeURIComponent(t.query)+"?",u=!0;else if(t.imagerySet&&t.imagerySet!=="Road")return null;if(!u&&t.route&&t.route.sourcePoint&&t.route.destinationPoint)r+="/Routes/"+t.route.mode?t.route.mode:"Driving",r+="?wp.0="+t.route.sourcePoint.latitude+","+t.route.sourcePoint.longitude+"&wp.1="+t.route.destinationPoint.latitude+","+t.route.destinationPoint.longitude,u=!0;else if(!u&&t.imagerySet!=="Aerial"&&t.pushpins&&t.pushpins.length&&t.pushpins[0].location){for(r+="?",f=void 0,h=t.pushpins.length===1&&i.shareImgDetailPushpinType||i.shareImgListPushpinType,o=0;o<t.pushpins.length;o++)f=t.pushpins[o],f.location&&(r+="&pushpin="+f.location.latitude+","+f.location.longitude+";"+(f.type||h));u=!0}else!u&&t.centerPoint&&t.zoomLevel&&(r+="/"+t.centerPoint.latitude+","+t.centerPoint.longitude+"/"+Math.floor(t.zoomLevel)+"?",u=!0);return u?(r+="&mapSize={mapWidth},{mapHeight}&key={credentials}",r=r.replace("{mapWidth}",t.width.toString()).replace("{mapHeight}",t.height.toString()).replace("{credentials}",e.dynamicProperties.sessionKey),t.imagerySet==="Aerial"&&(r+="&da=n"),r):null},n.prototype._cleanImageUrls=function(n){for(var i,f=[],e=[],t,r,u=0;u<n.length;u++)if(t=n[u],i=t.match(/[?&]id=([^&]*)/ig),i&&i.length){if(r=i[0].substr(4),f.indexOf(r)>=0)continue;f.push(r);t=t.replace(/http[s]?:\/\/([^/]*)/,"");e.push(t)}return e},n.prototype._loadImages=function(n,t){for(var r=[],u=n.length,f=0,i=0;i<u;i++)r.push(new Image),r[i].onload=function(){++f>=u&&t(r)},r[i].onerror=function(){t()},r[i].src=n[i]},n.prototype._reformatImageSizes=function(n,t,i){var u,f,r;if(n.length!==t.length)return[];for(u=/&w=[0-9]*/i,f=/&h=[0-9]*/i,r=0;r<n.length;r++)n[r]=n[r].replace(u,"&w="+t[r]).replace(f,"&h="+i[r]);return n},n._latlonRegex=/\d+\.\d*, ?-?\d+\.\d*$/,n}(),function(n){function t(n){return n==="LocalDetails"?1:n==="ContextMenu"?2:0}function i(n,i,u,f,e,o,s){var h=new r.DirectionsControl.Waypoint(n,i,f,!1,null,e),c,l,a,v;h.waypointType=o;h.waypointSource=t(u);s&&(c={dateTime:s,timeType:"arrival"});switch(u){case"LocalDetails":l=3;break;default:l=2}return a={waypoints:[h],entryPoint:l,options:c?c:null},v={type:"DirectionsTask",state:a},v}function u(n,t,i,r,u,f,e){var o={Name:n,Id:i,Lat:t.latitude,Lon:t.longitude,StayDuration:"",InterestTypes:[],Image:{Url:r},CategoryId:u};if(f&&(o.InterestTypes=f.split(",")),e){var s=0,h=/(\d*) hours?/g.exec(e),c=/(\d*) minutes?/g.exec(e);h&&h.length>=2&&(s+=parseInt(h[1])*60);c&&c.length>=2&&(s+=parseInt(c[1]));o.StayDurationInMinutes=s}return o}function f(t,i){var f,e,o,r,u;return t instanceof b?(u=t.getSelectedCategoryForIcon(),u||t.getPrimaryCategoryPath&&(u=t.getPrimaryCategoryPath()),r=n.getItineraryItem(t.getTitle(),i,t.id,t.getImageUrl(),u,t.interests,(f=t.averageStay)===null||f===void 0?void 0:f.toString()),r.Address=((e=t.addressFields)===null||e===void 0?void 0:e.formattedAddress)?t.addressFields.formattedAddress:t.getAddress(),t.getPhone()&&(r.PhoneNo=t.getPhone()),t.fullPriceString&&(r.PriceInfo=t.fullPriceString),t.rating&&(r.Rating=t.rating),t.openHours&&(r.OpenHoursData=t.openHours),t.averageStay&&(r.StayDurationInMinutes=t.averageStay),t.actionName&&t.actionUrl&&(r.ActionName=t.actionName,r.ActionUrl=t.actionUrl)):(r=n.getItineraryItem(a.getDisplayName(t),i,t.id,t.imageUrl,null,t.interests,t.stayDuration),r.Address=(o=t.addressFields)===null||o===void 0?void 0:o.formattedAddress,r.PhoneNo=t.PhoneNumber,r.PriceInfo=t.fullPriceString,r.Rating=t.rating,r.OpenHoursData=t.openHours,r.StayDurationInMinutes=t.averageStay,t.actionName&&t.actionUrl&&(r.ActionName=t.actionName,r.ActionUrl=t.actionUrl)),r}function e(t,i,r,u,f,e,o,s){var h=n.getItineraryItem(t,i,r,u,e,o,s),c={action:5,itineraryItem:h,itineraryCollectionId:f};return{type:"ItineraryDetailsTask",requestState:c}}function o(t,i,r,u,f,e,o,s){var h=n.getItineraryItem(t,i,r,u,e,o,s),c={action:1,itineraryItem:h};return{type:"ItineraryDetailsTask",requestState:c,taskId:f}}function s(t,i,r,u,f,e,o,s,h,c,l,a){var y=n.getItineraryItem(t,i,r,u,e,o,s),p,v;y.Destination=l&&(l.city||l.stateMunicipality||l.country);y.CategoryName=c;h&&h.length&&(y.EntityTypes=h);p={itineraryItem:y};v="";switch(a){case"TransientLens":v="ContextMenu";break;case"LocalDetailsTask":v="LocalDetails";break;case"LocalListingTask":v="LocalListing";break;default:v=a}return p.entryPoint=v,{type:"ItineraryDetailsTask",state:p}}function h(n,t,i){var r={action:3,travelEntity:n,day:i};return{taskId:t,type:"ItineraryDetailsTask",requestState:r}}function c(n,t,i,r,u,f,e,o,s,h){i===void 0&&(i="");r===void 0&&(r="");var c={title:n,location:t,address:r,description:i,photoUrl:u,categoryId:f,id:e,addressFields:o,metadataString:s,segmentType:h},l={action:1,data:c};return{type:"CollectionsTask",state:l}}function l(n,t,i,r,u,f,e,o){u===void 0&&(u="");f===void 0&&(f="");var s={title:n,location:t,address:f,description:u,photoUrl:e,categoryId:o,id:r},h={action:1,data:s,collectionId:i};return{type:"CollectionsTask",requestState:h}}n.getDirectionTaskOptions=i;n.getItineraryItem=u;n.getItineraryItemFromSearchEntity=f;n.getItineraryAddItemFromSaveOptions=e;n.getItineraryAddItemOptions=o;n.createNewItineraryOption=s;n.getItineraryDayOptions=h;n.getMyPlacesTaskOptions=c;n.getSaveToCollectionOptions=l}(y||(y={}));var b=function(){function n(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w){this._title=n;this._description=t;this._address=t;this.id=i;this._location=r;this._routableLocation=u;this._menuUrl=f;this._imageUrl=e;this._primaryCategoryPath=o||"";this._primaryCategoryName=s||"";this._vdpId=h;this._locationType=c;this._dateTime=l;this._endDateTime=a;this._utcOffset=v;this._isAllDayEvent=y;this._segmentTypes=p;this.isApproximateLocation=w;this.isPaginationReducedPoi=!1}return n.prototype.getLocation=function(){return this._location},n.prototype.getRoutableLocation=function(){return this._routableLocation},n.prototype.getBoundingBox=function(){return this._boundingBox},n.prototype.setBoundingBox=function(n){this._boundingBox=n},n.prototype.getTitle=function(){return this._title},n.prototype.setTitle=function(n){this._title=n},n.prototype.getDescription=function(){return this._description},n.prototype.setDescription=function(n){this._description=n},n.prototype.getMenuUrl=function(){return this._menuUrl},n.prototype.setMenuUrl=function(n){this._menuUrl=n},n.prototype.getImageUrl=function(){return this._imageUrl},n.prototype.setImageUrl=function(n){this._imageUrl=n},n.prototype.getPrimaryCategoryPath=function(n){return n&&(!this._primaryCategoryPath||this._primaryCategoryPath==="")?this._segmentTypes&&this._segmentTypes.length&&this._segmentTypes[0]||"":this._primaryCategoryPath},n.prototype.setPrimaryCategoryPath=function(n){this._primaryCategoryPath=n},n.prototype.getPrimaryCategoryName=function(){return this._primaryCategoryName},n.prototype.setPrimaryCategoryName=function(n){this._primaryCategoryName=n},n.prototype.getSelectedCategoryForIcon=function(){return this._selectedCategoryForIcon},n.prototype.setSelectedCategoryForIcon=function(n){this._selectedCategoryForIcon=n},n.prototype.getSearchCategory=function(){return this._searchCategory},n.prototype.setSearchCategory=function(n){this._searchCategory=n},n.prototype.getAddress=function(){return this._address},n.prototype.setVdpId=function(n){this._vdpId=n},n.prototype.getVdpId=function(){return this._vdpId},n.prototype.setLocationType=function(n){this._locationType=n},n.prototype.getLocationType=function(){return this._locationType},n.prototype.setSegmentTypes=function(n){this._segmentTypes=n},n.prototype.getSegmentTypes=function(){return this._segmentTypes},n.prototype.getDateTime=function(){return this._dateTime},n.prototype.setDateTime=function(n){this._dateTime=n},n.prototype.getEndDateTime=function(){return this._endDateTime},n.prototype.setEndDateTime=function(n){this._endDateTime=n},n.prototype.getUtcOffset=function(){return this._utcOffset},n.prototype.setUtcOffset=function(n){this._utcOffset=n},n.prototype.getIsAllDayEvent=function(){return this._isAllDayEvent},n.prototype.setIsAllDayEvent=function(n){this._isAllDayEvent=n},n.prototype.setPhone=function(n){this._phone=n},n.prototype.getPhone=function(){return this._phone},n.prototype.setWebsite=function(n){this._website=n},n.prototype.getWebsite=function(){return this._website},n.prototype.setChainId=function(n){this._chainId=n},n.prototype.getChainId=function(){return this._chainId},n.prototype.getCity=function(){return this._city},n.prototype.setCity=function(n){this._city=n},n.prototype.getLocalFilters=function(){return this._localFilters},n.prototype.setLocalFilters=function(n){this._localFilters=n},n.prototype.clone=function(){return n.cloneFrom(this)},n.cloneFrom=function(t){var i=new n(t._title,t._address,t.id,t._location,t._routableLocation,t._menuUrl,t._imageUrl,t._primaryCategoryPath,t._primaryCategoryName,t._vdpId,t._locationType,t._dateTime,t._endDateTime,t._utcOffset,t._isAllDayEvent,t._segmentTypes,t.isApproximateLocation);return i.setDescription(t._description),i.setBoundingBox(t._boundingBox),i.setSelectedCategoryForIcon(t._selectedCategoryForIcon),i.setPhone(t._phone),i.setWebsite(t._website),i.setChainId(t._chainId),i.htmlElement=t.htmlElement,i.representsTransitStop=t.representsTransitStop,i.isUpHierarchy=t.isUpHierarchy,i.isPermanentlyClosed=t.isPermanentlyClosed,i.poiType=t.poiType,i},n}(),bi=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return w(t,n),t.prototype.setRouteRequestState=function(n){this._routeRequestState=n},t.prototype.getRouteRequestOptions=function(){return this._routeRequestState&&this._routeRequestState.requestOptions},t.prototype.getIsHome=function(){return this._routeRequestState&&this._routeRequestState.isHome},t.prototype.hasRouteRequestState=function(){return this._routeRequestState!==undefined},t.prototype.getIndependentHotRegions=function(){return this.hasRouteRequestState()},t}(b),ki=function(){function n(n,t){this.id=n;this._title=t}return n.prototype.getTitle=function(){return this._title},n.prototype.setTitle=function(n){this._title=n},n.prototype.getDescription=function(){return null},n.prototype.getMenuUrl=function(){return null},n.prototype.getAddress=function(){return null},n.prototype.getSelectedCategoryForIcon=function(){return this._selectedCategoryForIcon},n.prototype.setSelectedCategoryForIcon=function(n){this._selectedCategoryForIcon=n},n.prototype.getSearchCategory=function(){return this._searchCategory},n.prototype.setSearchCategory=function(n){this._searchCategory=n},n}(),di=function(n){function t(t,i,r,u){return n.call(this,t,i,r,u,u)||this}return w(t,n),t}(b);r.GlobalDataEventHandler=f;r.HomeOrWorkEnabledLocalSearchEntity=bi;n.BrowserHistoryManager=fi;n.LocalSearchEntity=b;n.MapFeatureHandling=ai;n.OverlayEntity=vt;n.OverlayManager=vi;n.Permalink=wi;n.PrintContent=si;n.RoutePolyline=yi;n.RoutePushpin=pi;n.SDSData=et;n.TaskDataHandlerHelper=y;n.RichEntityInfoboxContentProcessor=yt;st=n.TaskData={};st.RecommendationEntity=ki;st.TravelAttractionEntity=di}catch(pt){if(r&&r.logger)r.logger.logCriticalError(pt);else throw pt;}}).call(window)