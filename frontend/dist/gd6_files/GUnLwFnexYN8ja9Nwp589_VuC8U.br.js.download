var GlobalActionMenu;(function(n){function ot(n){var i=n.querySelector(".actionmenuexp"),r=n.querySelector("."+o),t=n.querySelector(".actionmenucontent"),u=n.querySelector("."+l);t&&(ct(u,i,r,t,n),ht(u,i,r,t,n))}function t(n,t,i,e,o,s){var g,y,p,l,w,h;if(!Lib.CssClass.contains(e,f)){lt(n,t,i);var b=Lib.CssClass.contains(e,r),d=Lib.CssClass.contains(e,u),nt=!b&&!d;for(Lib.CssClass.add(e,f),Lib.CssClass.add(e,a),Lib.CssClass.remove(e,u),Lib.CssClass.remove(o,v),Lib.CssClass.remove(e,r),g=o.firstElementChild,y=g.getElementsByTagName("a"),h=0;h<y.length;h++)y[h].setAttribute("aria-expanded","false");if(sb_st(function(){return sj_evt.fire("GlobalActionMenu:Closed")},1e3),p=function(n){s?s.focus():n&&n.focus()},b||k(!1,e),d){if(l=c(),w=!1,l)for(h=0;h<l.length;h++)l[h].parentElement==i.parentElement&&(l[h].focus(),w=!0);w||p(i)}nt&&p(t)}}function st(n,t){var e=Lib.CssClass.contains(n,r),u,i;for(Lib.CssClass.add(t,v),Lib.CssClass.remove(n,a),Lib.CssClass.remove(n,f),u=n.getElementsByClassName(y),i=0;i<u.length;i++)Lib.CssClass.remove(u[i],y);sb_st(function(){return sj_evt.fire("GlobalActionMenu:Opened")},1e3);e||k(!0,n)}function ht(n,i,u,f,e){var c,o,h;if(sj_evt.bind(s,function(){return t(n,i,u,f,e)}),c=function(n){for(var t=n&&n.target;t;t=t.parentElement)if(t==f||t==i)return;sj_evt.fire(s)},sj_be(_d,"touchstart",c),sj_be(_d,"mousedown",c),sj_be(f,"touchstart",function(n){return n.stopPropagation()}),Lib.CssClass.contains(f,r)||sj_be(f,"click",function(){return t(n,i,u,f,e)}),sj_be(f,"touchmove",function(){return t(n,i,u,f,e)}),sj_be(_d,"focus",function(r){var o;i&&i.contains(r.target)&&(o=i);u&&u.contains(r.target)&&(o=u);f.contains(r.target)||t(n,i,u,f,e,o)},!0),AccessibilityHelpers.activateButtonByKey(f,[13,32],function(){return t(n,i,u,f,e)}),e&&(o=e.querySelectorAll("a"),o))for(h=0;h<o.length;h++)sj_be(o[h],"keydown",function(r){r.keyCode==27&&t(n,i,u,f,e)});i&&(sj_be(i,"touchstart",function(n){return n.stopPropagation()}),sj_be(i,"touchmove",function(){return t(n,i,u,f,e)}),sj_be(i,"keydown",function(r){r.keyCode==27&&t(n,i,u,f,e)}));u&&(sj_be(u,"touchstart",function(n){return n.stopPropagation()}),sj_be(u,"mousedown",function(n){return n.stopPropagation()}),sj_be(u,"touchmove",function(){return t(n,i,u,f,e)}),sj_be(u,"keydown",function(r){r.keyCode==27&&t(n,i,u,f,e)}));n&&(sj_be(n,"touchstart",function(n){return n.stopPropagation()}),sj_be(n,"mousedown",function(n){return n.stopPropagation()}),sj_be(n,"touchmove",function(){return t(n,i,u,f,e)}),sj_be(n,"keydown",function(r){r.keyCode==27&&t(n,i,u,f,e)}))}function ct(n,t,h,a,v){var g=Lib.CssClass.contains(v,tt),ot=Lib.CssClass.contains(v,it),nt=g&&!ot,ht=a.offsetWidth,d,y,k,b,ft,et;Lib.CssClass.add(a,u);d=a.offsetWidth;Lib.CssClass.remove(a,u);g&&(ht=p,d=p);y=function(h,y){if(a.innerHTML!==""){h.setAttribute("aria-expanded","true");var rt=function(n,t){st(a,v);g&&sb_st(function(){return sj_evt.fire("renderSharingScreenshot",v,a)},0);n?(Lib.CssClass.add(a,u),w(v,h,a,d)):t?Lib.CssClass.add(a,r):w(v,h,a,d)},p=Lib.CssClass.contains(h,o),tt=Lib.CssClass.contains(h,l),b=Lib.CssClass.contains(a,f),ft=!b&&Lib.CssClass.contains(a,u),et=!b&&Lib.CssClass.contains(a,r),it=b||ft!=p||et!=tt,k=c(),ot=y&&!it||nt&&p;ot||sj_evt.fire(s);it?(p?(i(n,-1),i(t,-1),e(k,-1)):(i(n,0),i(t,0),e(k,0)),sb_st(function(){return rt(p,tt)},y?0:ut)):(i(n,0),i(t,0),e(k,0))}};t&&(sj_be(t,"click",function(){return y(t,!1)}),AccessibilityHelpers.activateButtonByKey(t,[13,32],function(){return y(t,!1)}));h&&(sj_be(h,"click",function(){return y(h,!1)}),AccessibilityHelpers.activateButtonByKey(h,[13,32],function(){return y(h,!1)}));n&&(sj_be(n,"click",function(){return y(n,!1)}),AccessibilityHelpers.activateButtonByKey(n,[13,32],function(){return y(n,!1)}));nt&&(k=_d.getElementById(v.getAttribute(rt))||h,k&&(ft=function(){b&&sb_ct(b);b=sb_st(function(){return y(k,!0)},500)},et=function(){b&&(sb_ct(b),b=null)},sj_be(k,"mouseenter",ft),sj_be(k,"mouseleave",et)))}function lt(n,t,r){e(c(),0);i(n,0);i(t,0);i(r,0)}function i(n,t){n&&(n.tabIndex=t)}function e(n,t){if(n)for(var r=0;r<n.length;r++)i(n[r],t)}function w(n,t,i,r){if(n&&t&&i){var a=t.getBoundingClientRect(),e=t.offsetWidth?t.offsetWidth:0,o=t.offsetHeight?t.offsetHeight:0,f=a.left,s=_w.innerWidth-f-e,h=a.top,v=_w.innerHeight-h-o;i.style.position="fixed";f>s?f+e<r?(i.style.left="0",i.style.right=""):(i.style.left="",i.style.right=s+"px"):s+e<r?(i.style.left="",i.style.right="0"):(i.style.left=f+"px",i.style.right="");h>v?(i.style.top="",i.style.bottom=v+o+"px"):(i.style.top=h+o+"px",i.style.bottom="");var y=n.getBoundingClientRect(),u=i.getBoundingClientRect(),c=u.left-y.left,p=u.left,l=u.top-y.top,w=u.top;i.style.position="absolute";i.style.left=c+"px";i.style.top=l+"px";i.style.right="";i.style.bottom="";u=i.getBoundingClientRect();c+=p-u.left;l+=w-u.top;i.style.left=c+"px";i.style.top=l+"px"}}function b(n,t){var r=n.querySelectorAll(t),i,u,f;if(r)for(i=0;i<r.length;i++)u=r[i],f=u.getAttribute("data-medium"),Sharing.logEvent(f,Sharing.ShareStage.Visible,"GlobalAction sharing",n)}function k(n,t){_w.Log2?Log2.LogEvent("ClientInst",{FID:"GlobalAction.Expansion",AppNS:d(t),K:g(t),Category:"CommonControls"},n?"Open":"Close",null,null,null,null,null):Log.Log(n?"Open":"Close","GlobalAction.Expansion","ClientInst",!1,"AppNS",d(t),"K",g(t),"Category","CommonControls");n&&b(t,"[data-type='shareMedium']")}function h(){var t=_d.querySelectorAll(et),n,i;if(t)for(n=0;n<t.length;n++)i=t[n],at(i)}function at(n){var t="data-initialized";n.getAttribute(t)!=="1"&&(ot(n),b(n,".topactions [data-type='shareMedium']"),n.setAttribute(t,"1"))}function c(){return typeof PrintAction!="undefined"?PrintAction.getPrintActions():null}function vt(){h();typeof ShareAction!="undefined"&&ShareAction.initShareActions();typeof PrintAction!="undefined"&&PrintAction.initPrintActions();typeof FeedbackAction!="undefined"&&FeedbackAction.initFeedbackActions();typeof CustomAction!="undefined"&&CustomAction.initCustomActions()}function yt(n,t){var i=n&&_qs(".".concat(o),n);pt(i,t)}function pt(t,i){t&&(n.promoteActionImpl?n.promoteActionImpl(t,i):wt(function(){n.promoteActionImpl&&n.promoteActionImpl(t,i)}))}function wt(n){var t="".concat(ft,"?IG=").concat(_G.IG),i={callback:function(t,i){t&&(i.appendTo(sj_b),n())}};sj_ajax(t,i)}function d(n){return nt(n,"appns")}function g(n){return nt(n,"k")}function nt(n,t,i){if(i===void 0&&(i=null),!n)return null;var r="data-"+t;return i===null?n.getAttribute(r):(n.setAttribute(r,i),i)}var l="cortanaactionexp",r="cortanamenu",f="hiddenmenu",tt="actionmenularge",it="actionmenumobile",a="nonemenu",v="openmenu",o="shareactionexp",u="sharemenu",rt="data-hoverid",y="ga_cpy_label_copied",ut=200,ft="/shared/gamp/",et=".actionmenu:not(.actionmenulargeV2)",p=430,s="menuDismiss";n.bindGlobalActionMenuEvents=vt;n.promoteShareAction=yt;sj_be(_w,"load",function(){return h()});sj_evt.bind("ajax.load",function(){return h()})})(GlobalActionMenu||(GlobalActionMenu={}))